function sanitizeURL(a){if(!a||a=="")return a;var b="http",c="https",d=a.indexOf(":");if(d!=-1){var e=a.substr(0,d);e!=b&&e!=c&&e!="ftp"&&e!="mailto"&&(a=b+"://"+a)}else a=b+"://"+a;return a}function sanitize(a){return a==null||a==""?a:(a=a.replace(/<!--(.|\n)*?-->/mg,""),a=a.replace(/<(title|script|style|meta|link)\b((.|\n)*?)<\/\1\b(.*?)>/gmi,""),a=a.replace(/<(title|script|style|meta|link)\b((.|\n)*?)>/gmi,""),a=a.replace(/<\/?(html|head|(x?meta)|title|script|style|link|noembed|bgsound|frame|frameset|noframes)((.|\n)*?)>\n*?/gmi,""),a=a.replace(/<\/?([a-z].*)\b[^>]*>/gmi,function(a){return a=a.replace(/\\0/gmi,""),a=a.replace(/<\/?body/gmi,function(a){return a.toLowerCase()=="<body"?a="<div":a="</div",a}),a=a.replace(/\/\*[^*]+\*\//gmi,""),a=a.replace(/\Won[A-Z]*(\\s)*?=(\\s)*?(\'|\"|`)(.|\n)*?(\3)/gmi,""),a=a.replace(/\Wclass(\\s)*?=(\\s)*?(\'|\"|`)(.|\n)*?(\3)/gmi,""),a=a.replace(/\Wid(\\s)*?=(\\s)*?(\'|\"|`)(.|\n)*?(\3)/gmi,""),a=a.replace(/\Wdocument\.cookie/gmi,""),a=a.replace(/\.cookie/gmi,""),a=a.replace(/\Wwindow\.location/gmi,""),a=a.replace(/\.location/gmi,""),a=a.replace(/\Wjavascript(\\s|\n)*?:/gmi,""),a=a.replace(/(href|src)(\\s|\n)*?=(\\s|\n)*?(\'|\"|`)((.|\n)*?)[^\\](\4)/gmi,function(a){var b=a.substr(0,3).toLowerCase(),c=null;return b=="hre"?c=new RegExp("('|\"|`)((https?|ftp)|(mailto)):","gmi"):b=="src"&&(c=new RegExp("('|\"|`)(https?):|(^/GetImage?imageName=)","gmi")),a=a.replace(/(\'|\"|`)((.|\n)*?)[^\\](\1)/gmi,function(a){return c.test(a)||(a='""'),a}),a}),a=a.replace(/style(\\s|\n)*?=(\\s|\n)*?(\'|\"|`)((.|\n)*?)[^\\](\3)/gmi,function(a){return a=a.replace(/url\((.|\n)*?\)/gmi,""),a=a.replace(/expression\((.|\n)*?\)/gmi,""),a}),a}),a=a.replace(/<[a-z][a-z0-9]*\s?:\s?[a-z][a-z0-9]*[^>]*>/gmi,""),a=a.replace(/\s*?\n$/gmi,""),a.length>4e4&&(alert(i18n["zohodiscussions.general.textExceedMaximumSizeMessage"]),a=a.substring(0,4e4)),a)}function discussionsValidate(a){var b=$(":input",a),c=!0,d={};d.integer_pattern=/^[\-|\+]?\d+$/,d.integer_message="Please enter a valid integer number",d.float_pattern=/^[\-|\+]?(?:\d*\.?\d+|\d+\.)$/,d.float_message="Please enter a valid number",d.email_pattern="^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+.[a-zA-Z]{2,6}$",d.email_message="Please enter a valid email",d.multipleemail_pattern=/^(?:[a-zA-Z0-9]([\w\-\.\+]*)@([\w\-\.]*)(\.[a-zA-Z]{2,4}(\.[a-zA-Z]{2}){0,2}),?\s*)+$/i,d.multipleemail_message="Please enter a valid email ids",d.id_pattern=/^([\w-]+(?:[\w-]+)*)$/i,d.id_message="Please enter a valid id. Spaces are not allowed",d.url_pattern=/^(?:(?:\w|\d)+\.)+[a-zA-Z0-9]{2,6}$/,d.url_message="Please enter a valid URL",d.pattern_message="Sorry. The entered value does not match the required pattern",d.color_pattern=/^[A-Fa-f0-9]*$/;var e=a.attr("isTipper")=="true";return b.filter('[trim="true"]').each(function(a,b){$(b).val($(b).val().replace(/^\s+/,"").replace(/\s+$/,""))}).end().filter('[mandatory="true"]').each(function(a,b){var d=$(b);d.val()==""&&(message=getCustomMessage(d,d.attr("title")+" cannot be left blank! Please provide a value"),showError(d,message,e),c=!1)}).end().filter("[dataType]").each(function(a,b){var f=$(b),g=f.val();if(g&&g!=""){var h=f.attr("dataType");try{h=h.toLowerCase();var i=d[h+"_pattern"],j=d[h+"_message"];typeof j=="undefined"&&(j=f.attr("message")),g.match(i)==null&&(showError(f,getCustomMessage(f,j),e),c=!1)}catch(k){return}}}),c}function getCustomMessage(a,b){try{customMessage=a.attr("message");if(!customMessage||customMessage=="")customMessage=b;return customMessage}catch(c){return b}}function showError(a,b,c){if(c)return showTipper(b,"failure"),!1;var d=a.attr("name")+"_Error";return $("#"+d).html(b).show(),!1}function doAjaxAction(a,b,c,d){typeof discussionsZaid!="undefined"?b.portalzaid=discussionsZaid:b.portalzaid="-1",typeof isSupportPortalCall!="undefined"&&isSupportPortalCall==1?b.supportPortal="portal/":b.supportPortal="",typeof discussionsZaaid!="undefined"?b.portalzaaid=discussionsZaaid:b.portalzaaid="-1",$.ajax({url:context+a,type:"POST",data:b,error:isROMode==1?roFailureMessage:d,success:c})}function roFailureMessage(a){var b=$.parseJSON(a.responseText);showTipper(i18n[b.message],"failure",3e3)}function showLoadingImage(a){return}function hideLoadingImage(){$("#loadingImg:visible").hide(),$("#ajaxLoaderSmall").remove()}function showSmallLoadingImage(a,b,c){return}function showSmallLoadingImageForCont(a,b,c){b=b!=undefined?b:0,b=a.offset().top+b,c=c!=undefined?c:0,c=a.offset().left+c;var d={};d.top=b,d.left=c;var e=$("#ajaxLoaderSmallTemp").clone();e.attr("popoutPurpose","ajaxLoaderSmall"),e.attr("id","ajaxLoaderSmall"),e.css(d).show(),e.appendTo("body"),e.siblings('div[popoutPurpose="ajaxLoaderSmall"]').remove()}function goToTop(a){return a&&a==1?$("html,body").animate({scrollTop:0},1e3):$(window).scrollTop(0),!1}function setFocusToContainer(a,b,c,d){var e=a.offset().top,f=50;return d!=undefined&&(f=d),b&&b==1?(c=c||1e3,$("html,body").animate({scrollTop:e-f},c)):(c=c!=undefined?c:300,setTimeout(function(){IS_EMBEDDED&&isEmbedAllowedService()?setZDIFrameTop(e-f):$(window).scrollTop(e-f)},c)),!1}function showDiscussionMessage(a,b){return showNewTopicMessage(a,b),!1}function showMessage(a,b,c){return b=b||"info",$("#messageContentCont").html(a),typeof c=="undefined"&&(c="20%"),$("#messageContainer").find("div.borderBox").css("width",c),$("#messageContainer").attr("class",b).fadeIn(100,function(){setTimeout(function(){$("#messageContainer:visible").fadeOut(500)},6e3)}),$("#messageContainerClose").show(),!1}function showNewTopicMessage(a,b,c){return b=b||"info",$("#messageContentCont").html(a),typeof c=="undefined"&&(c="20%"),$("#messageContainer").find("div.borderBox").css("width",c),$("#messageContainer").attr("class",b).fadeIn(100,function(){setTimeout(function(){$("#messageContainer:visible").fadeOut(500)},6e3)}),$("#messageContainerClose").show(),!1}function hideMessage(){$("#messageContainer").fadeOut(100)}function showTipper(a,b,c){b=b||"info",c=c||4e3,$("#messageContentCont").html(a),$("#messageContainerClose").hide(),$("#messageContainer").attr("class",b).fadeIn(500,function(){setTimeout(function(){$("#messageContainer").fadeOut(500)},c)})}function setToHotkeys(){if(isEmbedService())return!1;isMac==0&&$("#topicListMainContainer").is(":visible")&&setupKbdShortcuts()}function setHotkeysToSinglePost(){if(isEmbedService())return!1;$("#SinglePostContainer").is(":visible")&&setupKbdShortcutsToSinglePost()}function removeHotkeys(){$.hotkeys.remove("o"),$.hotkeys.remove("esc"),$.hotkeys.remove("j"),$.hotkeys.remove("return"),$.hotkeys.remove("space"),$.hotkeys.remove("k"),$.hotkeys.remove("shift+space"),$.hotkeys.remove("n"),$.hotkeys.remove("p"),$.hotkeys.remove("v")}function findCurrentSinglePost(){var a=$("#topicList");a.length<1&&(a=$("#topicsList")),$currentSelected=a.data("currentFocusPost");if(!$currentSelected||$currentSelected.length<1)$currentSelected=a.data("currentSelectedPost");if(!$currentSelected||$currentSelected.length<1)$currentSelected=a.find("div.singleTopicCont:first");return $currentSelected}function setupKbdShortcuts(){$.hotkeys.add("",{disableInInput:!0}),$.hotkeys.add("o",function(){var a=findCurrentSinglePost(),b=a.attr("forumTopicId");handleTopicClick($("quickView_"+b),b,"topicList")}),$.hotkeys.add("v",function(){showLoadingImage();if(isTopicQuickView!="false"){var a=findCurrentSinglePost(),b=a.attr("forumTopicId");processHash("Topic/"+b)}}),$.hotkeys.add("esc",function(){var a=findCurrentSinglePost(),b=a.attr("forumTopicId");$("#lastResponse_"+b).is(":visible")&&handleTopicClick($("quickView_"+b),b,"topicList")}),$.hotkeys.add("return",function(){var a=findCurrentSinglePost(),b=a.attr("forumTopicId");window.open(serverURL+"?ftid="+b)}),$.hotkeys.add("space",function(){var a=findCurrentSinglePost();if(a.is("div.singleTopicContSel")){var b=$(window).height(),c=$(window).scrollTop(),d=a.height(),e=a.next().offset().top,f=b+c>e;if(f){a=a.next();if(a.is(".singleTopicCont")){var g=a.attr("forumTopicId");handleTopicClick($("quickView_"+g),g,"topicList")}}else $(window).scrollTop(c+b-50)}else if(a.is(".singleTopicCont")){var g=a.attr("forumTopicId");handleTopicClick($("quickView_"+g),g,"topicList")}}),$.hotkeys.add("shift+space",function(){var a=findCurrentSinglePost();if(a.is("div.singleTopicContSel")){var b=$(window).height(),c=$(window).scrollTop(),d=a.prev().offset().top,e=c-b<d-50;if(e){a=a.prev();if(a.is(".singleTopicCont")){var f=a.attr("forumTopicId");handleTopicClick($("quickView_"+f),f,"topicList")}}else $(window).scrollTop(c-b+50)}else if(a.is(".singleTopicCont")){var f=a.attr("forumTopicId");handleTopicClick($("quickView_"+f),f,"topicList")}}),$.hotkeys.add("j",function(){var a=findCurrentSinglePost();a.is("div.singleTopicContSel")&&(a=a.next());if(a.is("div.singleTopicCont")){var b=a.attr("forumTopicId");handleTopicClick($("quickView_"+b),b,"topicList")}}),$.hotkeys.add("k",function(){var a=findCurrentSinglePost();a.is("div.singleTopicContSel")&&(a=a.prev());if(a.is("div.singleTopicCont")){var b=a.attr("forumTopicId");handleTopicClick($("quickView_"+b),b,"topicList")}}),$.hotkeys.add("n",function(){var a=findCurrentSinglePost(),b=a.next();if(b.is("div.singleTopicCont")||b.is("div.singleTopicContSel"))a.removeClass("hotKeyTopicCont"),b.addClass("hotKeyTopicCont"),$("#topicList").data("currentFocusPost",b),toSetFocusOnCurrPost(b,"next")}),$.hotkeys.add("p",function(){var a=findCurrentSinglePost(),b=a.prev();if(b.is("div.singleTopicCont")||b.is("div.singleTopicContSel"))a.removeClass("hotKeyTopicCont"),b.addClass("hotKeyTopicCont"),$("#topicList").data("currentFocusPost",b),toSetFocusOnCurrPost(b,"prev")})}function toSetFocusOnCurrPost(a,b){var c=a.offset().top,d=$(window).height(),e=$(window).scrollTop();b=="next"?c-e>d-50&&$(window).scrollTop(c-d+80):e>c&&$(window).scrollTop(c)}function setupKbdShortcutsToSinglePost(){$.hotkeys.add("",{disableInInput:!0}),$.hotkeys.add("o",function(){return!1}),$.hotkeys.add("v",function(){return!1}),$.hotkeys.add("esc",function(){return!1}),$.hotkeys.add("return",function(){var a=$("#SinglePostContainer").attr("forumTopicId");window.open(serverURL+"?ftid="+a)}),$.hotkeys.add("space",function(){var a=$(window).height(),b=$(window).scrollTop();$(window).scrollTop(b+a)}),$.hotkeys.add("shift+space",function(){var a=$(window).height(),b=$(window).scrollTop();$(window).scrollTop(b-a)}),$.hotkeys.add("j",function(){$currentSelected=findCurrentSingleResponse();var a=0,b=$currentSelected.attr("currkey");b!=undefined&&(a=b),a++,toSetFocusOnCurrResponse($currentSelected,a)}),$.hotkeys.add("k",function(){$currentSelected=findCurrentSingleResponse();var a=0,b=$currentSelected.attr("currkey");if(b==undefined)return!1;a=b,a--,toSetFocusOnCurrResponse($currentSelected,a)}),$.hotkeys.add("n",function(){$currentSelected=findCurrentSingleResponse();var a=0,b=$currentSelected.attr("currkey");b!=undefined&&(a=b),a++,toSetFocusOnCurrResponse($currentSelected,a)}),$.hotkeys.add("p",function(){$currentSelected=findCurrentSingleResponse();var a=0,b=$currentSelected.attr("currkey");if(b==undefined)return!1;a=b,a--,toSetFocusOnCurrResponse($currentSelected,a)})}function findCurrentSingleResponse(){$currentSelected=$("#SinglePostContainer").data("currentFocusResponse");if(!$currentSelected||$currentSelected.length<1){var a=$("#SinglePostContainer").attr("forumTopicId");$currentSelected=$("#SinglePostContainer_"+a).find("div.postContainer")}return $currentSelected}function toSetFocusOnCurrResponse(a,b){var c=$("#SinglePostContainer").attr("forumTopicId"),d="";if(b=="0")d=$("#SinglePostContainer_"+c).find("div.postContainer"),a.removeClass("HotKeysingleReplyContainer");else{d=$("#SinglePostContainer_"+c).find("span.hotKey_"+b);if(d.length==0)return!1;a.removeClass("HotKeysingleReplyContainer"),d.addClass("HotKeysingleReplyContainer")}var e=d.offset().top;$("html,body").animate({scrollTop:e-10},500),$("#SinglePostContainer").data("currentFocusResponse",d)}function resizeZDIFRAME(a){IS_EMBEDDED==1&&isEmbedAllowedService()&&(a=a?a:$("#mainContent").height(),a&&(DOC_HT=a,document.cookie="zdHt="+a+";path=/",SendMessageToParent("zdframeht:"+parseInt(a+12))))}function setZDIFrameTop(a){a=a?a:0,SendMessageToParent("zdframetop:"+a)}function uploadShowMessage(a){forHidingSmallLoadingImg(),hideLoadingImage(),showMessage(i18n[a],"failure");if($("#publishResponse").attr("disabled")||$("#publishTopic").attr("disabled"))$("#publishResponse,#previewResponse").attr("disabled",!1),$("#publishTopic,#saveDraft").attr("disabled",!1),loadUploadAttachmentsCont()}function countString(a){var b=a!="0"?" ("+(a-1)+")":"";return b}function slideUpActionInModeration(a,b,c){showLoadingImage();var d=c.parents("div.moderateSinglePost"),e=c.attr("itemType");d.slideUp(300,function(){d.hide()});var f=$("#moderationTabCont").find('li[itemType="All"]').find("span"),g=f.attr("totalCount");countHTML=countString(g),f.html(countHTML).attr("totalCount",g-1);var h=$("#moderationTabCont").find("li[itemType="+e+"]").find("span"),i=h.attr("totalCount");countHTML=countString(i),h.html(countHTML).attr("totalCount",i-1),hideLoadingImage(),doAjaxAction(a,b,function(a){if(a=="SUCCESS"){var b=$("#awaitingCountCont").attr("totalCount"),c=countString(b);$("#awaitingCountCont").html(c).attr("totalCount",b-1),d.remove();if(g==1||b==1||h==1){var e=$("#moderationTabCont").find("li.selected").attr("tabPurpose");refreshingPage(e)}}else{var e=$("#moderationTabCont").find("li.selected").attr("tabPurpose");refreshingPage(e),showTipper(i18n["zohodiscussions.moderationAction.errormessage"],"failure",2e3)}},function(a){var b=$("#awaitingCountCont").attr("totalCount"),c=countString(b);$("#awaitingCountCont").html(c).attr("totalCount",b+1);var d=$("#moderationTabCont").find("li.selected").attr("tabPurpose");refreshingPage(d),showTipper(i18n["zohodiscussions.moderationAction.errormessage"],"failure",2e3)})}function isEmbedCallfromIntranet(){if(IS_EMBEDDED){var a=$("#mainContent").height();clearTimeout(b);var b=setTimeout(function(){var c=$("#mainContent").height();a&&a!=c&&(a=c,clearTimeout(b))},300)}}function isHistoryNotAllowedService(a,b){return isZIntranet||isZSupport?!1:(a&&(parseInt(b)>1?$.history.add(a+"/"+b):$.history.add(a)),!0)}function isEmbedAllowedService(){return isZIntranet||isZSupport?!1:!0}function isEmbedService(){return isZIntranet||isZSupport?!0:!1}function isFromSupportService(){return isZSupport?!0:!1}function isCancelButtonClicked(a){return isZIntranet||isZSupport?forumClickAction(-1):processHash(a),!1}function toEvaluateData(a){a=$.trim(a);if(a.substring(0,2)==="({"&&a.substring(a.length-2)==="})"){var b=a.substring(1,a.length-1),c=b.replace(/'/g,'"');return c=$.trim(c),$.parseJSON(c)}return a}function getValidLocationHash(a){var b=["home","chome","alltags","allforums","stats","search","normalsearch","myarea","moderation","settings","topic","forum","filter","user","tag","newtopic","newdiscussion","newquestion","newidea","newproblem","tpw","users","gettingstarted","resourcesearch","comments"],c=a===undefined?location.hash:a;if(c!=undefined&&c.trim()!=""){var d=c.indexOf("#");d=d===-1?0:d+1;var e=c.indexOf("/");e=e===-1?c.length:e,c=c.substring(d,e)}return c!=undefined&&c!=""&&isNaN(c)&&b.indexOf(c.trim().toLowerCase())===-1&&(location.hash="home",a="home"),a}function encodeHTML(a){return a?$("<div></div>").text(a).html():""}function decodeHTML(a){return a?$("<div></div>").html(a).text():""}function setCookie(a,b,c,d,e,f,g,h){var i=a+"="+escape(b);if(c){var j=new Date(c,d,e);i+="; expires="+j.toGMTString()}f&&(i+="; path="+escape(f)),g&&(i+="; domain="+escape(g)),h&&(i+="; secure"),document.cookie=i}function getCookie(a){var b=document.cookie.match(a+"=(.*?)(;|$)");return b?unescape(b[1]):null}function deleteCookie(a){var b=new Date;b.setTime(b.getTime()-1),document.cookie=a+="=; expires="+b.toGMTString()}function showAnnouncementDiv(a){var b=getCookie(a);b==null&&$("#ZDBanner").show()}function hideAnnouncementDiv(a){var b=getCookie(a);if(b==null){var c=new Date,d=c.getFullYear(),e=c.getMonth()+1,f=c.getDate();f>30&&(e==2?f=28:f=30),$("#ZDBanner").hide(),setCookie(a,!0,d,e,f)}}function newOpenEditor(a,b,c,d,e,f,g){var h=a.show(),i=h.next(),j=$('<textArea name = "'+b+'" id = "'+c+'" style = "display:none;"></textarea>'),k="",l=!0;e=="Edit"||b=="privateMsgContent"?l=!1:$("#writeNewTopic").attr("isDraft")=="true"&&(l=!1),h.is(":input")?k=h.val():k=h.html(),k=" "+k;var m=document.createElement("div");m.innerHTML=k,$(m).find("div.__zd_findAndReplace").remove(),$(m).find("div.__zd_findAndReplaceParent").remove(),k=m.innerHTML,l==1&&(k+=userSignature),j.val($.trim(k));var n,o="",p,q="",r=!1;if(d){$("#editorHolder").remove(),n=$('<form id = "editorHolder"></form>'),$replyLinkLocation=$("#"+d),o=$replyLinkLocation.attr("forumTopicId"),o=o||$replyLinkLocation.parents('div[parentCont="actualParent"]').attr("forumTopicId");var s=$replyLinkLocation.attr("responseId"),t=$replyLinkLocation.attr("isPrivate"),u=$replyLinkLocation.attr("isThread"),v=$replyLinkLocation.attr("forumId"),w=$replyLinkLocation.attr("categoryId"),x=$replyLinkLocation.attr("responseAuthorId"),y=!1;$("#SinglePostContainer").attr("sortThread")!=undefined&&(y=$("#SinglePostContainer").attr("sortThread"));var z="";if(e=="TweetPost"){var A=$replyLinkLocation.attr("tweetBy");q=$replyLinkLocation.attr("statusId");var B=$("#twitterCont_"+q).text(),C=$("#twitterImg_"+q).attr("src");p=$('<div style="clear:both;" class="replyContainer" id="replyTweetContainer_'+q+'"></div>');var D=$('<div class="content"></div>');D.append(n),p.append('<div class="boldText header">Reply to @'+A+"</div>"),p.append(D);var E=$('<div class="ndSelectionCont"</div>');E.html($("#twitterForumsOptions").html()),n.append(E),n.append('<input type = "hidden" name = "twitterAuthorId" value = "'+A+'">').append('<input type = "hidden" name = "twitterAuthImg" value = "'+C+'">').append('<input type = "hidden" name = "statusTwitterId" value = "'+q+'">').append('<input type = "hidden" name = "tweetContent" value = "'+B+'">').append('<input type = "hidden" name = "twitterResponseContent" value = "">').append('<input type = "hidden" name = "topicStatus" value = "0">'),v!=-1&&(n.append('<input type = "hidden" name = "forumId" value = "'+v+'">'),r="true"),w!=-1&&n.append('<input type = "hidden" name = "categoryId" value = "'+w+'">')}else z=$replyLinkLocation.attr("postTitle"),n.append('<input type = "hidden" name = "forumId" value = "'+v+'">').append('<input type = "hidden" name = "categoryId" value = "'+w+'">');n.append('<input value="'+z+'" name = "forumPostTitle" class="normalText zdtxtboxbro" type="text"/>').append('<input type = "hidden" name = "forumTopicId" value = "'+o+'">').append('<input type = "hidden" name = "responseId" value = "'+s+'">').append('<input type = "hidden" name = "forumGroupId" value = "'+forumGroupId+'">').append('<input type = "hidden" name = "isPrivate" value = "'+t+'">').append('<input type = "hidden" name = "isThread" value = "'+u+'">').append('<input type = "hidden" name = "'+csrfParamName+'" value = "'+csrfToken+'">').append('<input type = "hidden" name = "portalzaid" value = "'+discussionsZaid+'">').append('<input type = "hidden" name = "detectSpamPresence" value = "1">').append('<input type = "hidden" name = "isFollowTopic" value = "false">').append('<input type = "hidden" name = "sortThreads" value = "'+(y||!1)+'">'),e&&e=="Edit"&&x==ZUID&&n.append('<input type = "hidden" name = "responseowner" value = "true">')}else n=$('<div id = "editorHolder"></div>');n.append(j),e!="TweetPost"?n.insertAfter(h.hide()).show():p.insertAfter(h.hide()).show(),createEditor();if(e){$replyLinkLocation=$("#"+d);var o=$replyLinkLocation.attr("forumTopicId"),s=$replyLinkLocation.attr("responseId"),F=e=="Write"||e=="TweetPost"?i18n["zohodiscussions.general.publish"]:i18n["zohodiscussions.general.update"],G=$('<button id="publishResponse" class="ashBtn normalText boldText">'+F+"</button>"),H=$('<button id="previewResponse" class="ashBtn normalText boldText">'+i18n["zohodiscussions.writePost.preview"]+"</button>"),I=$("<button id='cancelResponse' class='ashBtn normalText boldText'>"+i18n["zohodiscussions.general.cancel"]+"</button>"),J="false";G.click(function(){addForumResponse(o,e,s,q)}),I.click(function(){$("#editorHolder").remove(),$("#responseAttachmentContActual").remove(),$("#SinglePostContainer_"+o).find('div[purpose="editorActionUtilCont"]').remove(),$("#postTextContent_"+s).find('div[purpose="editorActionUtilCont"]').remove(),$("#eachTopicReplyCont_"+o).find('div[purpose="editorActionUtilCont"]').remove(),$("#responsePreviewButtonInTopicList").length>0&&$("#responsePreviewButtonInTopicList").remove(),h.show(),e=="TweetPost"&&$("#replyTweetContainer_"+q).remove(),$("#topicList").is(":visible")&&$("#topicList").data("inEditMode",!1),$("#"+f).data("inEditMode",!1);var a="";$("#newThreadResponseCont_"+s).is(":visible")?a="#newThreadResponseCont_"+s:$("#newResponseCont_"+o).is(":visible")?a="#newResponseCont_"+o:$("#eachTopicReplyCont_"+o).is(":visible")&&(a="#eachTopicReplyCont_"+o),a!=""&&$(""+a+"").hide();if(f=="privateMsgInboxContainer")$("#privateMsgCont_"+o).hide();else if(f=="privateMsgSentContainer")$("#privateMsgCont_"+o).hide(),$("#topicContent_"+o).parent().find("div.bigMinusIcon").length>0&&$("#topicContent_"+o).show();else if(f=="editorContainer_PM")processHash("user/"+$("#UserPM").attr("authorName"));else if(f=="eachTopic_"+s){var b=$("#paginationContainer");b.data("inEditMode",!1),$("#singlePostActions_"+s).show(),$("#linkedTopic_"+s).show(),$("#recent_ResPonse_"+s).find("div.navigationCont").show()}else f=="topicContainer_"+o&&($("#postTypeActions_"+s).show(),$("#linkTopicCont_"+o).show(),$("#zdstatusContainer").show());i.is(".Attachments")&&i.show(),$("#responsePreviewContainer").is(":visible")&&($("#responsePreviewContainer").length>0||$singleThreadPreviewCont.length>0)&&($("#responsePreviewContainer").remove(),$("#fullThreadResponseContainer").remove());if($("#responseContentContainer_"+s).is(":visible")==1){$("#fullResponseContainer_"+s).find("div.postTypeActions").show();var c=$("#responsePreviewButton"),d=$("#fullResponseContainer_"+s),g=$("#responseContentContainer_"+s);CancelPreview(c,d,g)}if($("#recentResponseContent_"+s).is(":visible")==1){$("#postTextContent_"+s).find("ul.singlePostActions").show(),$("#resposeVoteLink_"+s).show(),$("#chooseBestResponse_"+s).show();var c=$("#responsePreviewButtonInTopicList"),d=$("#postTextContent_"+s),j=$("#recentResponseContent_"+s);CancelPreview(c,d,j)}});if(e=="TweetPost"){var K=E.find("#forum_Twitter_SelectForum");E.find("#forum_Twitter_SelectSubForum").attr("id","forum_Twitter_SelectSubForum_"+q),r!="true"&&loadTweetCategories(K.val(),"twitter_SubForumList","forum_Twitter_SelectSubForum_"+q),K.change(function(){var a=$(this).val();loadTweetCategories(a,"twitter_SubForumList","forum_Twitter_SelectSubForum_"+q)})}var L=$("#responseAttachmentContTemplate").clone();L.attr("id","responseAttachmentContActual");var M=L.find("div.whiteAttachmentBox").show();L.find('div[attachmentPurpose="browseBox"]').attr("id","attachBrowseCont");var N=M.find('ul[purpose="responseAtatchmentsListCont"]').attr("id","attachmentsListCont");if(e=="Edit"){if(i.is(".Attachments")){J="true";var O=i.find('div[purpose="attachmenUtilCont"]'),P=O.attr("attachmentIds"),Q=O.attr("attachmentNames"),R=O.attr("attachmentSizes"),S=P.split(","),T=Q.split(","),U=R.split(",");for(index=0;index<S.length;index++){var V=$("#fullResponseContainer_"+s).attr("authorId");V==undefined&&(V=$("#eachTopic_"+o).attr("responseAuthorId"));var W=S[index],X=T[index],Y=U[index],Z=W+","+X+","+Y;$currentAttachment=$("#responseEachAttachmentTemplate").clone(),$currentAttachment.attr("id","newAttachment_"+W).attr("attachmentDetails",Z).show(),$currentAttachment.find('[attachmentPurpose="attachmentName"]').text(X),$currentAttachment.find('[attachmentPurpose="attachmentSize"]').text(Y),$currentAttachment.find("div.imgAshDelete").attr("thisAttachmentId",W).attr("thisAttachmentName",X).attr("authorId",V),$currentAttachment.find("div.imgAshDelete").click(function(a){if(confirm(i18n["zohodiscussions.generalmessage.deleteAttachmentConfirmMsg"])){showSmallLoadingImage(a),$this=$(this);var b=$this.attr("thisAttachmentId"),c={};c.forumGroupId=forumGroupId,c.forumTopicId=o,c.fileName=$this.attr("thisAttachmentName"),c.fileId=b,c[csrfParamName]=csrfToken,$this.attr("authorId")==ZUID&&(c.access="author",c.responseId=s),doAjaxAction("/deleteAttachment.do",c,function(a){hideLoadingImage(),a=="SUCCESS"&&($("#newAttachment_"+b).remove(),$("#eachAttachmentForPreview_"+b).remove(),$("#fullResponseContainer_"+s).find('li[attachmentId="'+b+'" ]').remove(),showTipper(i18n["zohodiscussions.general.Deleted"],"info"),loadUploadAttachmentsCont())})}}),N.append($currentAttachment)}i.hide()}$("#postTypeActions_"+s).hide()}if((maxAttachmentsPerPost>0||J=="true")&&g!="true"){var _=$('<div class="flRight btnContainer" purpose="editorActionUtilCont" style="margin-right:10px;"></div>');L.insertAfter($("#editorHolder")).css("margin-top",4).show()}else{var _=$('<div class="flRight btnContainer" purpose="editorActionUtilCont" style="margin-top:25px;margin-right:10px;"></div>');L.insertAfter($("#editorHolder")).css("margin-top",4)}_.append(G),f!="paginationContainer"&&e!="TweetPost"&&_.append(H),L.find("div.whiteAttachmentBox").css("border-width",1),_.append(I).insertAfter(L),loadUploadAttachmentsCont(),H.click(function(){var a=$(this),b=a.attr("location"),c=$("#editorHolder").find("input[name=forumPostTitle]").val(),e=c.replace(/^<+|<+$/g,"&lt;").replace(/<+/g,"&lt;").replace(/^>+|>+$/g,"&gt;").replace(/>+/g,"&gt;"),f=a.attr("forumTopicId"),g=a.attr("responseId"),h=editor.getContent();h=h.replace(/^\s+/g,"").replace(/\s+$/g,""),editor.mode==="plaintext"&&(h=encodeHTML(h),h=h.replace(/\n/g,"<br/>"));if(b=="editResponse"||b=="editTopic"){var g=a.attr("responseId"),i=$('<div class=" approveButton flRight"> This is preview! </div>');if(b=="editTopic"){var j=$("#DocumentTitle");j.css("width","74%"),i.insertAfter(j.parent())}else $("#fullResponseContainer_"+g).find("div.sppostHeader").append(i);$("#responsePreviewButton").length==0?($responsePreviewButton=$("#previewButtonTemplate").clone(),$responsePreviewButton.attr("id","responsePreviewButton")):$responsePreviewButton=$("#responsePreviewButton"),b=="editTopic"&&($("#fullResponseContainer_"+g).find("div.postTypeActions").hide(),$responsePreviewButton.insertAfter($("#fullResponseContainer_"+g).find("div.postTypeActions")).show());var k=$("#fullResponseContainer_"+g);newEditorLocationHide(f,k),k.find("div.replyOutHeader").append('<div class="flRight statusMessage"><span class="boldText moderation">This is preview!</span></div>'),k.find("h3.header").html(e);if(b=="editTopic"){$("#DocumentTitle").hide();var l=$("#DocumentTitle").clone();l.attr("id","postTitlePreviewContainer"),l.insertAfter($("#DocumentTitle")),l.html(e).show()}else{var m=$("#fullResponseContainer_"+g).find("div.sppostHeader h4");m.hide();var n=m.clone();n.attr("id","responseTitlePreviewContainer"),n.insertAfter(m),n.html(e).show()}editAndPreviewPost($responsePreviewButton,$("#postTypeActions_"+g),k,b),q=$("#fullResponseContainer_"+g).find("div.attachmentListCont").hide();var o=$("#fullResponseContainer_"+g).find('div[purpose ="attachmentListContForPreview"]'),p=$("#responseContentContainer_"+g);attachmentPreview(p,q,k,a),$("#cancelResponse").attr("disabled")==1&&$("#responsePreviewButton").find('button[purpose="cancelPreviewResponse"]').attr("disabled",!0),o.show(),previewContentContainer($("#responseContentContainer_"+g),h.trim()),previewActions($("#fullResponseContainer_"+g),f,g,I,G,J)}else if(b=="topicListEditResponse"){$("#responsePreviewButtonInTopicList").length==0?($responsePreviewButton=$("#previewButtonTemplate").clone(),$responsePreviewButton.attr("id","responsePreviewButtonInTopicList")):$responsePreviewButton=$("#responsePreviewButtonInTopicList");var k=$("#postTextContent_"+g);newEditorLocationHide(f,k);var p=$("#recentResponseContent_"+g),q=$("#postTextContent_"+g).find("div.attachmentListCont").hide(),o=$("#postTextContent_"+g).find('div[purpose ="attachmentListContForPreview"]');o.show(),$("#cancelResponse").attr("disabled")==1&&$("#responsePreviewButtonInTopicList").find('button[purpose="cancelPreviewResponse"]').attr("disabled",!0),attachmentPreview(p,q,k,a),previewContentContainer($("#recentResponseContent_"+g),h),editAndPreviewPost($responsePreviewButton,$("#postTextContent_"+g),k,b),previewActions($("#responsePreviewButtonInTopicList"),f,g,I,G,J)}else{$("#responsePreviewContainer").length==0?($responsePreviewContainer=$("#responsePreviewContainerTemplate").clone(),$responsePreviewContainer.attr("id","responsePreviewContainer")):$responsePreviewContainer=$("#responsePreviewContainer");if(d=="newThreadReply_"+g)if($("#fullThreadResponseContainer").length==0)var r=$("");else var r=$("#topicContainer_"+f).find('div[purpose="threadResponseContainer"]');$responsePreviewContainer.find('[purpose="previewResponseAttachment"]').attr("id","attachmentForResponsePreview"),d=="newThreadReply_"+g?($responsePreviewContainer.insertAfter("#newThreadResponseCont_"+g).show(),$responsePreviewContainer.addClass("thread"),$responsePreviewContainer.find('button[purpose="backToEditorResponse"]').attr("location","threadResponse"),$("#replyToTopicBtn_"+f).attr("location","threadResponse")):($responsePreviewContainer.insertAfter("#newResponseCont_"+f),$responsePreviewContainer.find('button[purpose="backToEditorResponse"]').attr("location","topicResponse"),$("#replyToTopicBtn_"+f).attr("location","topicResponse")),$responsePreviewContainer.find('[purpose="topicTitleOfResponse"]').html(e),$responsePreviewContainer.find('div[purpose="responseContPreviewContainer"]').html(h),d=="newThreadReply_"+g?($("#newThreadResponseCont_"+g).hide(),r.show(),r.find("div.singleReplyContainer").show()):($responsePreviewContainer.show(),$("#newResponseCont_"+f).hide());var s=a.find('input[name="attachmentId"]');$.each(s,function(a,b){var c=$(b).attr("attachmentDetails").split(","),d=$('<li id="eachAttachmentForPreview_'+c[0]+'" ><div class="flLeft"><b class="flLeft imgfile"></b><a>'+encodeHTML(c[1])+'</a><div class="spattachmentConent"><span>Size : '+c[2]+" </span>&nbsp;&nbsp;</div></div></li>");$("#attachmentForResponsePreview").append(d)}),$("#attachmentForResponsePreview > li").length>0?$responsePreviewContainer.find('[purpose="attachmentResponsePreviewCont"]').show():$responsePreviewContainer.find('[purpose="attachmentResponsePreviewCont"]').hide(),previewActions($responsePreviewContainer,f,g,I,G,J)}})}$("#editorHolder iframe").attr("id","editorframecont")}function toggleSections(a,b){a.find("div[purpose]").hide().end().find('div[purpose="'+b+'"]').show().end().find("li[purpose]").removeClass("selectedMenu").end().find('li[purpose="'+b+'"]').addClass("selectedMenu")}function uploadError(a){var b=$("#imageDialog");b.find("#image_error").hide().html(a).css("background","#FFF1A8").fadeIn()}function previewActions(a,b,c,d,e,f){a.find('button[purpose="backToEditorResponse"]').unbind("click").click(function(){var d=$(this),e=d.attr("location");e=="topicResponse"?(a.hide(),$("#newResponseCont_"+b).show()):e=="editEachResponse"?($("#resposeVoteLink_"+c).show(),$("#chooseBestResponse_"+c).show(),backtoEditorWhilePreviewing($("#fullResponseContainer_"+c),$("#responseContentContainer_"+c),$("#responsePreviewButton"),b,f)):e=="topicListEditResponse"?backtoEditorWhilePreviewing($("#postTextContent_"+c),$("#recentResponseContent_"+c),$("#responsePreviewButtonInTopicList"),b,f):($("#newThreadResponseCont_"+c).show(),$("#fullThreadResponseContainer").hide(),a.remove()),$("#attachmentForResponsePreview").html(" ")}),a.find('button[purpose="publishPreviewResponse"]').unbind("click").click(function(){e.trigger("click")}),a.find('button[purpose="cancelPreviewResponse"]').unbind("click").click(function(){var a=$(this),b=a.attr("location");if(b!="topicResponse")if(b=="editEachResponse"){var e=$("#fullResponseContainer_"+c).find('div[purpose ="attachmentListContForPreview"] > ul');e.html(" "),$("#fullResponseContainer_"+c).find("div.replyOutHeader > div.statusMessage").remove()}else if(b=="topicListEditResponse"){var e=$("#postTextContent_"+c).find('div[purpose ="attachmentListContForPreview"] > ul');e.html(" "),$("#postTextContent_"+c).find("div.statusMessage").remove()}$("#fullResponseContainer_"+c).find("div.approveButton").remove(),d.trigger("click")})}function editAndPreviewPost(a,b,c,d){var d=d=="editResponse"||d=="editTopic"?"editEachResponse":"topicListEditResponse";a.insertAfter(b).show(),c.find('div[purpose="editorMainParentCont"]').hide(),c.find('div[purpose="editorActionUtilCont"]').hide(),a.find('button[purpose="publishPreviewResponse"]').html(i18n["zohodiscussions.general.update"]),a.find('button[purpose="backToEditorResponse"]').attr("location",d),a.find('button[purpose="publishPreviewResponse"]').attr("location",d),a.find('button[purpose="cancelPreviewResponse"]').attr("location",d)}function CancelPreview(a,b,c){a.remove(),b.find("div.Attachments").show(),b.find("div.attachmentListCont").show(),b.find('div[purpose ="attachmentListContForPreview"]').hide(),c.show(),$("#previewContentContainer").remove(),$("#newAttachmentForPreview").remove(),$("#DocumentTitle").show(),$("#postTitlePreviewContainer").remove(),b.find("div.sppostHeader h4").show(),$("#responseTitlePreviewContainer").remove()}function previewContentContainer(a,b){a.hide();if($("#previewContentContainer").length==0)var c=$('<div id="previewContentContainer" class="postContent"> </div>');else c=$("#previewContentContainer");c.insertAfter(a),c.html(b).show()}function backtoEditorWhilePreviewing(a,b,c,d,e){newEditorLocationShow(d,a,e),b.hide(),a.find("div.Attachments").hide(),$("#previewContentContainer").hide();var f=a.find('div[purpose ="attachmentListContForPreview"] > ul');f.html(" ");var g=$("#newAttachmentForPreview").find('ul[purpose="previewResponseAttachment"]');g.html(" "),a.find("div.replyOutHeader > div.statusMessage").remove(),c.hide(),$("#responsePreviewContainer").remove(),$("#SinglePostContainer_"+d).find("div.approveButton").remove(),$("#DocumentTitle").show(),$("#postTitlePreviewContainer").remove(),a.find("div.sppostHeader h4").show(),$("#responseTitlePreviewContainer").remove()}function attachmentListPreview(a,b){$.each(b,function(b,c){var d=$(c).attr("attachmentDetails").split(","),e=$('<li id="eachAttachmentForPreview_'+d[0]+'" ><div class="flLeft"><b class="flLeft imgfile"></b><a>'+encodeHTML(d[1])+'</a><div class="spattachmentConent"><span>Size : '+d[2]+" </span>&nbsp;&nbsp;</div></div></li>");a.append(e).show()})}function attachmentPreview(a,b,c,d){var e=c.find('div[purpose ="attachmentListContForPreview"]');if(e.length==0&&$("#newAttachmentForPreview").length==0){var f=$('<div class="Attachments attachments"><div class="attachmentListCont spattachmentList" purpose ="attachmentListContForPreview"><h3><span class="imgAttach flLeft"></span> Attachments </h3> <ul class="ulNoStyle"> </ul></div>');f.insertAfter(b)}$("#newAttachmentForPreview").length==0&&$("#attachmentsListCont").find('li[purpose="attachmentDetails"]').length>0&&b.length==0&&($newAttachmentForPreview=$("#responsePreviewContainerTemplate").find('div[purpose ="attachmentResponsePreviewCont"]').clone(),$newAttachmentForPreview.attr("id","newAttachmentForPreview"),$newAttachmentForPreview.insertAfter(a),$newAttachmentForPreview.find("div.attachmentListCont").show());if($("#newAttachmentForPreview").length>0){$("#newAttachmentForPreview").show();var g=d.find('input[name="attachmentId"]'),h=$("#newAttachmentForPreview").find('ul[purpose="previewResponseAttachment"]');attachmentListPreview(h,g),$newAttachmentForPreview.find("div.attachmentListCont").show()}else{var g=$("#attachmentsListCont").find('li[purpose="attachmentDetails"]'),h=c.find('div[purpose ="attachmentListContForPreview"] > ul');attachmentListPreview(h,g)}c.find('div[purpose ="attachmentListContForPreview"] > ul > li').length>0||$("#newAttachmentForPreview").find('ul[purpose ="previewResponseAttachment"] > li').length>0?c.find("div.Attachments").show():c.find("div.Attachments").hide()}function imageUploaded(a,b,c,d){$("#imagePreview").attr({src:a,width:"100",height:"100"});var e=$("#imageDialog");e.find("#image_error").html(""),e.find(':input[name="linkTo"]').val(d),e.find(':button[action="insertImage"]').attr("disabled","").end().find(':input[name="uploadedImageUrl"]').val(a)}function imageAdded(a,b){var c=$("#imageDialog"),d={};d.title=c.find('[name="title"]').val(),d.altText=c.find('[name="altText"]').val(),d.linkTo=c.find('[name="linkTo"]').val(),d.imgSize=c.find('[name="imgSize"]').filter(":checked").val(),$("#"+b).data("editor").addImage(a,d),$("#imageDialog").hide()}function toggleSections(a,b){a.find("div[purpose]").hide().end().find('div[purpose="'+b+'"]').show().end().find("span[purpose]").removeClass("select").addClass("default").end().find('span[purpose="'+b+'"]').removeClass("default").addClass("select")}function fillImageUrl(){var a=$("#imageDialog");if(a.find("#urldiv").is(":visible")){var b=a.find(':input[name="url"]').val();b&&$.trim(b)!=""&&($.trim(b)!=""&&isValidUrl(b)?a.find(':input[name="linkTo"]').val(b).end().find("#imagePreview").attr({src:b,width:"100",height:"100"}).end().find(':button[action="insertImage"]').attr("disabled",""):(alert(i18n["zohodiscussions.settings.PleaseEnteraValidurl"]),a.find(':input[name="url"]').focus()))}else{var b=a.find(':input[name="uploadedImageUrl"]').val();a.find(':input[name="linkTo"]').val(b)}}function isValidUrl(a){return a&&$.trim(a)!=""?(url_pattern="^https?://[A-Za-z0-9-_]+(?:\\.[A-Za-z0-9-_%&?/.=]+)*$",a.match(url_pattern)!=null?!0:!1):!1}function uploadImage(){var a=$("#imageDialog");if($.trim(a.find("[name='imageFileName']").val())!=""){var b=a.find("form");a.find("#image_error").html("<em>Uploading .. <img src = '/images/progressbarsmall.gif' /></em>").end().find(':button[action="insertImage"]').attr("disabled","true"),b.find(':hidden[name="responseId"]').val($('#editorHolder :hidden[name="responseId"]').val()),b.attr("action","/uploadImage.do"),b.attr("enctype","multipart/form-data").attr("encoding","multipart/form-data"),b.get(0).submit()}}function toggleImageSelection(a){if($(a).attr("id")=="uploadSection")$(a).addClass("select"),$("#urlSection").removeClass("select"),$("#uploaddiv").show(),$("#urldiv").hide();else{$(a).addClass("select"),$("#uploadSection").removeClass("select"),$("#uploaddiv").hide();var b=$("#urldiv");b.show(),b.find(':inpur[name="url"]').focus()}}function newEditorLocationHide(a,b){$("#editorHolder").hide(),b.find('div[purpose="editorActionUtilCont"]').hide(),$("#responseAttachmentContActual").hide()}function newEditorLocationShow(a,b,c){$("#editorHolder").show(),(maxAttachmentsPerPost>0||c=="true")&&$("#responseAttachmentContActual").show(),b.find('div[purpose="editorActionUtilCont"]').show()}function initTabContClick(){$("#homeTab,#allforumsTab,#myareaTab,#SettingsTab,#NewTopicTab,#Search,#twitterMainTab,#Users").click(function(){var a=$(this),b=a.attr("hashPurpose");return processHash(b,"",a),!1}),$("#searchComboDownArrow").parent().click(function(){displaySearchOption()}),$("#searchTab input").focus(function(){$("#searchTab").addClass("searchBoxFocus")}).focusout(function(){$("#searchTab").removeClass("searchBoxFocus")})}function updateAwaitingApprovalCount(){if(!isEmbedService()){var a={};a.forumGroupId=forumGroupId,doAjaxAction("/getAwaitingApprovalCount.do",a,function(a){var b=a!="0"?" ("+a+")":"";$("#awaitingCountCont").html(b).attr("totalCount",a)})}}function processHash(a,b,c){if(isEmbedService())return!1;if(isTopicQuickView=="false"&&b!="withHash"){if(a.toLowerCase()=="home")a="recent";else{if(a.toLowerCase()==="search"||a.toLowerCase()==="normalsearch"){var d=$("#searchSelectedImage").attr("purpose"),e=$("#searchInputBox"),f="",g=e.val(),h=$("#forumComboCont"),i=$("#categoryComboCont"),j=h.attr("forNiceUrl"),k=i.attr("forNiceUrl");typeof k!="undefined"&&k!=""?f=k:f=j;if(typeof f=="undefined"||f=="")f="";a.toLowerCase()=="normalsearch"&&(g=$("#normalSearchInputBox").val()),g=$.trim(g),g=encodeURIComponent(g),g=g.replace(/\*/g,"%2A").replace(/\~/g,"%7E").replace(/\!/g,"%21").replace(/\'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29");if(g==""){showMessage(i18n["zohodiscussions.searchList.noSearchString"],"failure");return}var l="";return typeof d=="undefined"?l="":d!="all"&&(l=d+"/"),location.href=serverURL+f+"/search/"+l+g,!1}if(typeof c!="undefined"&&c.attr("id")=="NewTopicTab"){if(a=="")return!1;var m=a.split("/"),n=m[0],o=n.toLowerCase(),p=m[1],q=m[2];return discussionsFunctions.newtopic(o,p,q),!1}}return location.href=serverURL+"/"+a.toLowerCase(),!1}if(shouldReload==1&&a!="Search"&&a!=="resourceSearch")return window.location.href=serverURL+"#"+a,!1;showLoadingImage();if(a=="")return isTopicQuickView=="false"?(window.location.href=serverURL+"/recent",!1):(discussionsFunctions.home("home",1),!1);var m=a.split("/"),n=m[0],o=n.toLowerCase();selectTab(o);switch(o){case"home":case"chome":var r=1;parseInt(m[1])>1&&(r=m[1]),discussionsFunctions[o](n,r);break;case"alltags":discussionsFunctions[o](n);break;case"allforums":discussionsFunctions[o](n);break;case"stats":window.location.href=serverURL+"/stats";break;case"search":g=m[1],discussionsFunctions[o](n,g,!1);break;case"resourcesearch":typeof c!="undefined"&&c.attr("id")==="normalSearchInputBox"&&(g=c.val()),discussionsFunctions.search(n,g,!0);break;case"normalsearch":g=$("#normalSearchInputBox").val(),g||(g=m[1]),discussionsFunctions.search(n,g,!1);break;case"myarea":var s=m[1],t="";s&&(s=s.toLowerCase()),s=="watchlist"?(t=m[2],t&&(t=t.toLowerCase())):s=="friends"&&(t=m[2],t&&(t=t.toLowerCase())),discussionsFunctions[o](n,s,t);break;case"moderation":window.location.href=serverURL+"/moderation";break;case"settings":discussionsFunctions[o](n);break;case"topic":var u=m[1],v=m[2];discussionsFunctions[o](n,u,v);break;case"forum":var w=m[1],r=1;if(m[2]){var x="",y=parseInt(2);if(m[y]!="filter"&&m[y].toLowerCase()!="all"){var z=parseInt(m[y]);z>0?(r=z,y+=1):(x=m[y],y+=1)}if(m[y])if(m[y]=="filter"){y+=1;var A=m[y],B="";A=A.toLowerCase();if(A=="twitter"){var p=$("#searchTwitterTab").attr("forumId");getTwitterSearchList(p,1,w);return}A!="discussions"&&A!="questions"&&A!="ideas"&&A!="problems"&&A!="announcement"&&A!="sticky"&&A!="unrepliedposts"&&A!="postssincelastvisit"?(A="all",isOneTopicType!="true"&&(y+=1)):(y+=1,m[y]&&(B=m[y])),isOneTopicType=="true"&&A=="all"&&(B=m[y]),m[y]&&parseInt(m[y])>0&&(r=m[y]),getMoreTopics(w,x,r,A,"",B,"reload")}else m[y]&&parseInt(m[y])>0&&(r=m[y]),discussionsFunctions[o](n,w,x,r);else discussionsFunctions[o](n,w,x,r)}else discussionsFunctions[o](n,w,"",r);break;case"filter":var A=m[1];A=A.toLowerCase();var B="",r=1;if(A=="twitter"){getTwitterSearchList(-1,1);return}A!="discussions"&&A!="questions"&&A!="ideas"&&A!="problems"&&A!="announcement"&&A!="sticky"&&A!="unrepliedposts"&&A!="postssincelastvisit"?(A="all",parseInt(m[2])>0&&(r=m[2])):m[3]?(B=m[2],parseInt(m[3])>0&&(r=m[3])):parseInt(m[2])>0?r=m[2]:B=m[2],isOneTopicType=="true"&&A=="all"&&(B=m[1]),getMoreTopics("","",r,A,"",B,"reload");break;case"user":var C=m[1];discussionsFunctions[o](n,C);break;case"tag":var D=m[1];discussionsFunctions[o](n,D);break;case"newtopic":var p=m[1],q=m[2];discussionsFunctions[o](n,p,q);break;case"newdiscussion":var p=m[1],q=m[2];discussionsFunctions.newtopic(n,p,q);break;case"tpw":var p=m[1],q=m[2],E=m[3],F=m[4],G=m[5],H=m[6],I=m[7],J=m[8],K=m[9],L=m[10],M=m[11];discussionsFunctions.tphome(n,p,q,E,F,G,H,I,J,K,L,M);break;case"users":var r=1,N=m[2];parseInt(m[1])>1&&(r=m[1]),discussionsFunctions[o](n,r,N);break;case"gettingstarted":if(currentForumGroupURL==="manageengine"){var O=1,P=!0,Q=!1,R=m[1];gettingstarted(O,P,Q,forumGroupId,R)}else location.hash="home";break;default:hideLoadingImage()}return!1}function loadTagRelatedPost(a){var b={};b.forumGroupId=forumGroupId,b.tagName=a,b.fetchPage=1,doAjaxAction("/getTagRelatedPosts.do",b,function(a){return hideLoadingImage(),$("#mainContent").html(a),goToTop(),bindTopicClicks($("#topicList")),bindTopicClicks($("#topicsList")),bindTopicListHeaderClicks($("#topicListHeader")),bindWidgetsContClick($("#topicListWidgetsCont")),!1},function(a){hideLoadingImage();var b=a.responseText;$("#mainContent").html(b)})}function allForumsBindActions(){lightBox("#chartWidget"),bindAllForumsClick($("#allForums_MainContentCont")),bindWidgetsContClick($("#topicListWidgetsCont")),goToTop();var a=$("#listof_FC_Counts");$("#countOfForum").html(a.attr("forumCount")),$("#countOfCategory").html(a.attr("categoryCount")),$("#countOfPosts").html(a.attr("postCount")),$("#countOfResponses").html(a.attr("responseCount"));if(typeof WmsContacts!="undefined"&&ch=="true"){var b=WmsContacts.getZohoContacts();setPresenceInTopicList(b)}}function ModerationLoadingPage(a){var b="";portalPlanIndex>0?b="/getModerationPanel.do":b="/getReportedSpam.do",doAjaxAction(b,a,function(a){return hideLoadingImage(),$("#mainContent").get(0).innerHTML=a,$.history.add("Moderation"),getModerationPanelBindAction(),!1},function(a){hideLoadingImage();var b=a.responseText;$("#mainContent").get(0).innerHTML=b})}function getModerationPanelBindAction(){goToTop(),bindModerationTabClick(),portalPlanIndex>0?bindModerationActionClick("AllAwaiting"):bindModerationActionClick("AllReportedSpam"),ModerationAction($("#moderationRightCont")),initModerationPanel($("#moderationPanel"))}function getMyAreaBindActions(a,b,c,d){bindMyAreaClicks($("#myAreaContent")),$("#authorPopout_"+ZUID).hide(),showAuthorPopout($("#myAreaInnerMainContent"));if(a!="dashboard"){a=="myposts"&&(a="myjournals"),d!=undefined&&d!="topic"&&d!="user"&&d!="forum"&&d!="subforum"&&d!="following"&&d!="follower"&&(d="topic");if(c!="niceurl")$("#"+a+"View").length>0?getMyAreaAction($("#"+a+"View"),d):getMyAreaAction($("#dashboardView"));else{var e=$("#"+a+"View").attr("purpose");bindMyareaTabsActions(e,d)}}else{c!="niceurl"&&$.history.add(b+"/"+a);if(typeof WmsContacts!="undefined"&&ch=="true"){var f=WmsContacts.getZohoContacts();setPresence(f,"followingUserDetails"),setPresence(f,"followersUserDetails"),setPresenceInMyArea(f,"current_recentActivity_List")}(a=="dashboard"||a=="undefined")&&initialiseUserActivityChart()}}function ModerationAction(a){a.unbind("click",bindModerationAction).click(bindModerationAction),showAuthorPopout(a)}function getTopicsReport(a,b,c,d){document.title=forumGroupNameDecode(forumGroupName);var e={};e.forumGroupId=forumGroupId,e.forumId=a,e.categoryId=b,e.fetchPage=c,e[csrfParamName]=csrfToken,doAjaxAction("/Reports.do",e,function(a){hideLoadingImage(),d&&$.history.add(d),$("#mainContent").get(0).innerHTML=a,lightBox("#chartWidget"),bindReportsClicks($("#reportsLeftPanel"))})}function getForumTopics(a,b,c,d,e,f,g,h,i,j,k,l,m){document.title=forumGroupNameDecode(forumGroupName);var n=$("#topicListMainContainer");if(n.length>0&&n.is('[shouldReload="false"]')&&c<2)$.history.add(d),setTimeout(function(){n.show().attr("shouldReload","true").siblings().remove()},200),hideLoadingImage(),setToHotkeys();else{var o={};o.forumGroupId=forumGroupId,o.forumId=a,o.categoryId=b,o.fetchPage=c,o.givenkey=d,d=="tpw"&&(o.limit=e,o.style=f,o.ph=g,o.tps=h,o.widget=i,o.aj=j,o.stat=k,o.querystring=l,o.tgt=m),doAjaxAction("/getSingleForumTopics.do",o,function(e){hideLoadingImage(),isHistoryNotAllowedService(d,c),$("#mainContent").get(0).innerHTML=e;var f=$("#iamLoginBox").find("iframe"),g=f.attr("src");f.attr("src",g),lightBox("#chartWidget"),lightBox("#topicList"),bindTopicClicks($("#topicList")),bindTopicClicks($("#topicsList")),bindTopicListHeaderClicks($("#topicListHeader")),bindWidgetsContClick($("#topicListWidgetsCont"));var h="NewTopic/"+a+"/"+b;$("#NewTopicTab").attr("hashPurpose",h),$("#allForumWidget").length>0&&$("#allForumWidget").find('li[purpose="forumList"]').length<9&&$("#moreForumView").hide();if(typeof WmsContacts!="undefined"&&ch=="true"){var i=WmsContacts.getZohoContacts();setPresenceInTopicList(i)}return setToHotkeys(),!1},function(a){hideLoadingImage();var b=a.responseText;$("#mainContent").get(0).innerHTML=b})}}function getWritePostCallBack(a,b){var c=a,d={};b!="true"&&$.history.add(a),$("#tabListCont li.selected").removeClass("selected"),goToTop();var e=$("#SelectForum > option");e.length==1&&e.attr("selected",!0);var f=$("#SelectCategory > option");f.length==1&&f.attr("selected",!0),initWritePost(),a=a.toLowerCase();if(a!="newtopic"){a=="newproblem"?a="error":a=="newquestion"?a="question":a=="newidea"?a="idea":a=="newdiscussion"&&(a="discuss");var g=$("#writepostTabsCont").find('li[topiciconclass="'+a+'"]');g.length>0?selectTopicType(g):selectTopicType(g,a)}hideLoadingImage();var h="";$("#topicTitle").keydown(function(a){var b=$("#listOfTitleAutoSugg"),c=$(this).val();c=c.replace(/^\s+|\s+$/g,"").replace(/\s+/g," ");if(c==""||a.keyCode==27){b.hide();return}storedTitle=d[c];if(storedTitle!=undefined){if(storedTitle==""){b.hide();return}b.html(storedTitle).show();return}if(a.keyCode!=32)return;if(h!=""&&c.indexOf(h)==0)return;h="";var e={};e.searchFor=c,e.forumGroupId=forumGroupId,e[csrfParamName]=csrfToken,doAjaxAction("/getTopicTitleSearch.do",e,function(a){b.get(0).innerHTML=a;var e=$("<div></div>");e.get(0).innerHTML=a;if(e.find("li").length<1){d[c]="",h=c,b.hide();return}var f=$("#topicTitle").width();b.width(f-5),b.show(),d[c]=b.html()},function(a){})});var i=$("#writepostCont");i.unbind("click",manageTopicTitle).click(manageTopicTitle)}function manageTopicTitle(a){var b=$(a.target),c=b.parent();if($("#listOfTitleAutoSugg").is(":visible")){if(b.parents("li").attr("eachTopic")=="autosugg"){if(!b.is("a")){var d=b.parents("li").find("a").attr("href");isEmbedAllowedService()&&window.open(d)}return}if(!b.is("#moreSearchTopicList")){$("#listOfTitleAutoSugg").hide();return}$("#listOfTitleAutoSugg").find("ul li").show(),b.hide()}return}function getWritePost(a,b,c,d){var e={};e.forumGroupId=forumGroupId,e.forumId=a,e.categoryId=b,isTopicQuickView!="false"&&showLoadingImage(),doAjaxAction("/writePost.do",e,function(a){return document.title=i18n["zohodiscussions.writePost.documentTitle"]+" - "+forumGroupNameDecode(forumGroupName),$(".ui-autocomplete").length===2&&$(".ui-autocomplete").remove(),$("#mainContent").get(0).innerHTML=a,getWritePostCallBack(c,d),!1},function(a){hideLoadingImage();var b=a.responseText;$("#mainContent").get(0).innerHTML=b})}function selectTab(a){if(a=="user"){$("#newtopicCont").siblings("li.selected").removeClass("selected");return}if(a=="newtopic"||a=="search"){searchFor=$("#searchInputBox").val(),searchFor=$.trim(searchFor);if(a=="search"&&searchFor=="")return;$("#"+a+"Tab").siblings("li.selected").removeClass("selected");return}if(a=="forum"||a=="topic"||a=="chome")a="home";$("#"+a+"Tab").addClass("selected").siblings("li.selected").removeClass("selected")}function bindTopicListHeaderClicks(a){a.unbind("click",processTopicListHeaderClick).click(processTopicListHeaderClick)}function bindTopicListHeaderForumsMenu(a){a.unbind("click",processTopicListHeaderForums).click(processTopicListHeaderForums)}function bindTopicClicks(a){a.unbind("click",processTopicListClick).click(processTopicListClick)}function showAuthorPopout(a){var b=a.attr("authorPopout");if(IS_EMBEDDED)return!1;if(!(typeof isTopicQuickView!="undefined"&&isTopicQuickView!="false"||typeof b!="undefined"&&b=="true"))return!1;a.find('a[purpose="authorProfile"],img[purpose="authorProfile"]').hover(function(){var a=$(this);if(!(typeof isTopicQuickView!="undefined"&&isTopicQuickView!="false"||!a.is('img[purpose="authorProfile"]')||b!="true"||a.attr("authorPopout")=="true"))return;var c=a.attr("authorId");if(c==-1)return;var d=a.attr("authorName"),e=a.attr("forumId"),f=setTimeout(function(){var b=a.position(),f=$("#mainContent").position(),g=f.left;b.left=b.left+parseInt(g);if($("#SinglePostContainer").length>0){var h=f.top;b.top=b.top+parseInt(h)+20}b.left>800&&(b.left=b.left-300),$authorPopup=$("#authorPopout_"+c);if($authorPopup.length>0)$authorPopup.css(b).show(),authorPopupHover($authorPopup);else{$authorPopup=$("#authorPopoutTemplate").clone(),$authorPopup.attr("popoutPurpose","authorDetailsPopout"),$authorPopup.attr("id","authorPopout_"+c);var i={};i.forumGroupId=forumGroupId,i.authorId=c,i.forumId=e,i.ch=ch,i[csrfParamName]=csrfToken,doAjaxAction("/getAuthorPopup.do",i,function(a){$thisAuthPopup=$("<div>"+a+"</div>"),authorPopUpAction($thisAuthPopup,c,d,$authorPopup)}),$authorPopup.css(b).show(),$authorPopup.appendTo("body"),authorPopupHover($authorPopup)}},700);a.data("destroyHandleAuthPopout",f)},function(){var a=$(this),b=a.attr("authorId"),c=a.data("destroyHandleAuthPopout");c&&clearTimeout(c);var d=$("#authorPopout_"+b);d.attr("hideAuhPopout","true"),setTimeout(function(){var a=d.attr("hideAuhPopout");a=="true"&&d.hide()},500)})}function mouseOutAuthor(a){var b=a,c=b.attr("authorId"),d=b.data("destroyHandleAuthPopout");d&&clearTimeout(d);var e=$("#authorPopout_"+c);e.attr("hideAuhPopout","true"),setTimeout(function(){var a=e.attr("hideAuhPopout");a=="true"&&e.hide()},500)}function mouseOverAuthor(a){if(isTopicQuickView=="false"||isZIntranet)return!1;var b=a,c,d=b.attr("authorId");if(d==-1)return;var e=b.attr("authorName"),f=b.parents('li[parentCont="actualParent"]').attr("forumId");typeof f=="undefined"&&(f=b.attr("forumId"));var g=setTimeout(function(){var a=b.position();c=$("#authorPopout_"+d);if(c.length>0)c.css(a).show(),authorPopupHover(c);else{c=$("#authorPopoutTemplate").clone(),c.attr("popoutPurpose","authorDetailsPopout"),c.attr("id","authorPopout_"+d);var g={};g.forumGroupId=forumGroupId,g.authorId=d,g.forumId=f,g.ch=ch,g[csrfParamName]=csrfToken,doAjaxAction("/getAuthorPopup.do",g,function(a){$thisAuthPopup=$("<div>"+a+"</div>"),authorPopUpAction($thisAuthPopup,d,e,c)}),c.css(a).show(),c.appendTo("body"),authorPopupHover(c)}},700);b.data("destroyHandleAuthPopout",g)}function authorPopUpAction(a,b,c,d){a.find('li[purpose="watchUser"]').click(function(){$thisWatchCont=$(this);var a={};a.forumGroupId=forumGroupId,a.watchItemId=b,a.watchItemType=3,a[csrfParamName]=csrfToken;var d=$thisWatchCont.attr("watchAction"),e=d=="watch"?"/watchUser.do":"/unwatchUser.do";doAjaxAction(e,a,function(a){if(a=="SUCCESS"){$thisWatchCont.attr("watchAction",d=="watch"?"unwatch":"watch");var b=(d=="watch"?i18n["zohodiscussions.general.Unwatch"]:i18n["zohodiscussions.general.watch"])+" "+c;$thisWatchCont.find('a[purpose="watchuserNameCont"]').html(b),d=="watch"?showTipper(i18n["zohodiscussions.generalmessage.userAddedToWatchlist"],"success"):showTipper(i18n["zohodiscussions.generalmessage.userRemovedFromWatchlist"])}})}),a.find('li[purpose="addAsFriend"]').click(function(){$addFriendCont=$(this);var a=$addFriendCont.attr("successMsg"),c={};c.forumGroupId=forumGroupId,c.userId=b,c[csrfParamName]=csrfToken,doAjaxAction("/addAsFriend.do",c,function(b){hideLoadingImage(),b=="SUCCESS"&&($addFriendCont.attr("purpose","friendWaitingApproval"),$addFriendCont.find('a[linkpurpose="addAsFriend"]').attr("style","cursor:default;text-decoration:none;").html(i18n["zohodiscussions.friends.awaitingApproval"]),$addFriendCont.find("div.imgAddFriend").removeClass("imgAddFriend").addClass("imgWaitingFriend"),showTipper(a,"success"))})}),a.find('li[purpose="authorProfile"]').click(function(){c==screenName||c==encodedScreenName?processHash("MyArea"):processHash("User/"+c)}),d.html("").append(a);if(typeof WmsContacts!="undefined"&&ch=="true"){var e=WmsContacts.status(b);e===!1&&(e=9),manageUserChatStatus("authorPopup_"+b,e)}}function authorPopupHover(a){a.hover(function(){a.attr("hideAuhPopout","false");var b=a.data("destroyHandle");b&&clearTimeout(b)},function(){var b=setTimeout(function(){a.hide(),a.unbind("mouseenter").unbind("mouseleave")},700);a.data("destroyHandle",b)})}function displaySearchOption(){var a=$("#listOfSearchOptions");a.show(),a.find("li").unbind("click").click(function(){var b=$(this),c=b.find("div"),d=c.attr("class"),e=c.attr("purpose");if(!c.is(".imgAdvanceSearch"))c.is(".imgSearchBlack")&&(d="imgSearchWhite flLeft"),$("#searchSelectedImage").attr("class",d).attr("purpose",e),$("#searchInputBox").focus();else{if($("#advanceSearchContainerForm").is(":visible")){$("#listOfSearchOptions").hide();return}if($("#searchMainContainer").is(":visible")){$("#normalSearchInSearchList").hide(),$("#advanceSearchContainerForm").show(),$("#advanceSearchInpurBox").focus();return}showLoadingImage();var f=a.attr("isResourceSearch")?a.attr("isResourceSearch"):!1,g={};g.forumGroupId=forumGroupId,g.isResourceSearch=f,doAjaxAction("/AdvanceSearchContainer.do",g,function(a){hideLoadingImage();var b=$("#mainContent > div:first"),c=$("<div></div>");c.get(0).innerHTML=a,c.insertBefore(b),c.find("#advanceSearchContainerForm").show(),c.find("#advanceSearchInpurBox").focus(),$("#normalSearchInSearchList").is(":visible")&&$("#normalSearchContainer").hide(),bindSearchContentClick(c)},function(a){hideLoadingImage();var b=a.responseText;$("#mainContent").get(0).innerHTML=b})}a.hide()});var b=a.parent("div");b.hover(function(){var a=b.data("destroyHandle");a&&clearTimeout(a)},function(){var c=setTimeout(function(){a.hide(),b.unbind("mouseenter").unbind("mouseleave")},500);b.data("destroyHandle",c)})}function bindSearchContentClick(a){a.unbind("click",processSearchContClick).click(processSearchContClick),$("#SearchforumCategoryVice").change(function(){searchForumCatSelect($(this))})}function searchForumCatSelect(a){var b=a.val(),c=$("#searchCategoryList").val().split("$$");$.each(c,function(a,c){if(c.indexOf(b+":")>-1)return $("#SearchCategoryVice").html('<option selected value="-1">'+i18n["zohodiscussions.myArea.all"]+"</option>"+c.split(":")[1]).show(),$("#SelectCategory option:first").attr("selected","true"),!1;b==-1?$("#SearchCategoryVice").html('<option selected value="-1">'+i18n["zohodiscussions.myArea.all"]+"</option>").show():$("#SearchCategoryVice").html('<option selected value="-1">Uncategorised</option>').show()}),$("#SearchCategoryVice option:first").attr("selected","true")}function bindWidgetsContClick(a){a.unbind("click",processWidgetsContClick).click(processWidgetsContClick),lightBox("#chartWidget"),showAuthorPopout(a),bindSubscribeAction();var b=$('#followAnnouncement a[purpose="watchAnnouncement"]');b.click(function(a){watchThisItem(b,"announcement",a)})}function bindAllForumsClick(a){a.unbind("click",processAllForumsClick).click(processAllForumsClick),showAuthorPopout(a)}function processTopicListHeaderForums(a){var b=$(a.target),c=b.parent();if(b.is("#forumsFilter span, #categoriesFilter span, #forumsFilter li, #categoriesFilter li,#currentCategoryContext,#currentForumContext"))return b.is("#forumsFilter span,#categoriesFilter span")&&(b=c),hashPurpose=b.attr("hashPurpose"),processHash(hashPurpose),!1}function processTopicListHeaderClick(a){var b=$(a.target),c=b.parent();if(b.is("#forumsFilter span, #categoriesFilter span, #forumsFilter li, #categoriesFilter li,#currentCategoryContext,#currentForumContext"))return b.is("#forumsFilter span,#categoriesFilter span")&&(b=c),hashPurpose=b.attr("hashPurpose"),processHash(hashPurpose),!1;if(b.is('div[purpose="linkForDropDown"]')){var d=b,e=d.attr("dropDownContLocation"),f=$(d.attr("parentCont"));f.is(".newCombo")?f.addClass("newComboSelected").removeClass("newCombo"):f.addClass("newCombo").removeClass("newComboSelected");var g=$("#"+e);g.toggle()}if(b.is('#topicListFilter li[purpose="filterLink"]')){var h=b.attr("topicFilter");$topicFilterParent=$("#topicListFilter");var i=$topicFilterParent.attr("forumURL"),j=$topicFilterParent.attr("subForumURL"),k="";return $topicFilterParent.attr("isTypeURL")=="yes"?(getMoreTopics(i,j,fetchPage,h,"",k),$("#currentFilterContext").html(b.text())):manageFilterHash(i,j,h,k),!1}b.is("#showAllTags")&&b.attr("isNiceURL")!="Yes"?processHash("AllTags"):b.attr("purpose")=="filterTab"||b.is("#innerTabFilter span")&&c.parent().attr("purpose")=="filterTab"?(b.attr("purpose")!="filterTab"&&(b=c),manageFilterTabList(b)):b.is('#innerTabFilter li[purpose="filterTabMenu"]')||c.attr("purpose")=="filterTabMenu"?(c.attr("purpose")=="filterTabMenu"&&(b=c),manageFilterMenuList(b.attr("filterParent"),b)):c.attr("id")=="searchTwitterTab"&&manageFilterTabList(c);var l=$("#typeFilterOptions")}function getTwitterSearchList(a,b,c,d){if(isTwitterPortal!="true")return;var e=$("#tweetContainer"),f=e.attr("status_Id"),g={};g.forumGroupId=forumGroupId,typeof a!="undefined"&&(g.forumId=a),typeof c!="undefined"&&(g.forumURL=c),g[csrfParamName]=csrfToken,g.fetchPage=b;var h=parseInt(b)+1;typeof d!="undefined"?g.sinceId=d:b>1?g.maxId=f:showLoadingImage();var i="/getMoreTwitterSearchList.do";isCommentBoxDomain=="true"&&(a==-1||typeof a=="undefined")&&(b==1||typeof b=="undefined")&&(d==-1||typeof d=="undefined")&&(i="/getTwitterSearchList.do"),$("#currentFilterContext").is(":visible")&&(i="/getTwitterSearchList.do"),i!="/getMoreTwitterSearchList.do"&&selectTab("twitterMain"),doAjaxAction(i,g,function(f){var g=$("#topicList");if(b>1){$("#searchMoreTweetsLoading").remove();var j=$('<div class="tFootCount" id="searchMoreTweets" forumId="'+a+'" fetchPage="'+h+'" loadCompleted="false">Older Tweets</div>');$("#searchMoreTweetsParents").html(j);var k=$("<div></div>");k.html(f);var l=k.find("#tweetContainer li");l.each(function(){$(this).hide(),e.append($(this))}),k.unbind("click",bindTwittReplyContent).click(bindTwittReplyContent)}else{if(typeof d!="undefined"){var m=e.find('li[isrecenttweets = "true"]').length;m>1&&(m=parseInt(m)-1);var k=$("<div></div>");k.html(f);var n=k.find("li");n.hide();var o=n.length;if(o>0){var p=k.find("#tweetContainer").attr("status_Id");e.attr("status_Id",p),$("#searchRecentTweet").remove(),n.insertBefore(e.find("li:first")),o=parseInt(o)+m;var q=$('<li isrecenttweets="true" id="searchRecentTweet"><div id="searchRecentTweetsLink" class="tCount">You have '+o+" new tweets</div></li>");q.insertBefore(e.find("li:first")),$("#searchRecentTweetsLink").unbind("click").click(function(){e.find('li[isrecenttweets = "true"]').attr("isrecenttweets","false").show(),$(this).parents("li").remove()})}manageRecentTweets()}else{var r=$("#topicListMainContainer");r.length>0&&r.is('[shouldReload="false"]')&&r.show().attr("shouldReload","true"),i=="/getTwitterSearchList.do"?($("#mainContent").get(0).innerHTML=f,bindTopicListHeaderForumsMenu($("#mainContent")),g=$("#mainContent")):$("#topicList").get(0).innerHTML=f,hideLoadingImage();if(a==-1){var s=-1;$("#forum_Twitter_Default").length>0?s=$("#forum_Twitter_Default").attr("forumId"):s=$("#forum_Twitter_SelectForum").val(),loadTweetCategories(s,"twitter_SubForumList","forum_Twitter_SelectSubForum")}}g.unbind("click",bindTwittReplyContent).click(bindTwittReplyContent)}if(b==1&&typeof d=="undefined"){manageRecentTweets();var t="filter/twitter";typeof c!="undefined"&&(t="forum/"+c+"/"+t),$.history.add(t),getTwitterSearchList(a,2)}},function(a){var b=toEvaluateData(a.responseText),c=b.reason;b.errorcode=="REMOTE_IP_LOCKED"&&showMessage(i18n["zohodiscussions.generalmessage.tryagainaftersometime"],"failure")})}function initTwitterPageActions(a){var b=$("#topicList");b.unbind("click",bindTwittReplyContent).click(bindTwittReplyContent),bindTopicListHeaderClicks($("#topicListHeader")),bindWidgetsContClick($("#topicListWidgetsCont"));if(typeof a=="undefined"||a=="null")a=-1;getTwitterSearchList(a,2),manageRecentTweets()}function manageRecentTweets(){var a=$("#tweetContainer");a.is(":visible")&&setTimeout(function(){if(a.is(":visible")){var b=a.attr("forumId"),c=a.attr("forumUrl"),d=a.attr("status_Id");getTwitterSearchList(b,1,c,d)}},6e4)}function bindTwittReplyContent(a){var b=$(a.target),c=b.parent();c.is(".ndTwitterBtnCont")&&c.attr("purpose")=="replyTweet"?addNewTweetPost(b):b.is("#searchMoreTweets")&&manageMoreTweets(b)}function manageMoreTweets(a){var b=a.attr("forumId"),c=a.attr("fetchPage");a.parents("li").remove();var d=$("#tweetContainer");d.find('li[isrecenttweets = "false"]').show(),c=parseInt(c)+1,getTwitterSearchList(b,c)}function addNewTweetPost(a){var b=$("#tweetContainer");if(b.data("inEditMode")==1){var c=b.data("currStatusId");$("#tweetReply_"+c).focus(),showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info");return}var d=a.attr("statusId"),e=$("#eachTwittId_"+d),f=$("#twitterCont_"+d),g=$("#twitterImg_"+d),h={};h.forumGroupId=forumGroupId,h.statusId=d,h.tweetBy=e.attr("tweetBy"),h.tweetDate=e.attr("tweetDate"),h.tweetAuthImg=g.attr("src"),h.tweetCont=f.html(),h[csrfParamName]=csrfToken,newOpenEditor($("#tweetReplyContainer_"+d),"responseContent","postContentTA","tweetReply_"+d,"TweetPost","tweetContainer"),b.data("inEditMode",!0),b.data("currStatusId",d)}function loadTweetCategories(a,b,c){var d=$("#"+b).val().split("$$"),e=$("#"+c);e.hide(),e.html(""),$.each(d,function(b,c){if(c.indexOf(a+":")>-1)return e.html(c.split(":")[1]).show(),!1;a!=-1?e.html('<option selected value="-1">Uncategorised</option>').show():e.html('<option selected value="-1">choose Subforum</option>').show()})}function manageFilterTabList(a){var b=$("#innerTabFilter");b.find("li.selectedTab").removeClass("selectedTab"),a.attr("purpose")=="filterTab"?a.addClass("selectedTab"):a.parents("li").addClass("selectedTab");var c=b.attr("forumURL"),d=b.attr("subForumURL"),e=1,f=a.attr("filterBy")||a.find("a").attr("filterBy"),g="",h=b.attr("topicFilterType"),i=b.attr("postSinceLastVisitTime");h!="All"&&(g=a.attr("filterLabelId")||a.find("a").attr("filterLabelId"),g&&(g=f,f=h)),b.attr("isTypeURL")=="yes"?getMoreTopics(c,d,e,f,i,g):manageFilterHash(c,d,f,g)}function manageFilterHash(a,b,c,d){var e="forum/";if(isTopicQuickView=="false"||a=="")e="";a!=""&&typeof a!="undefined"&&(e=e+a+"/"),b!=""&&typeof b!="undefined"&&(e=e+b+"/"),d!=""&&(d="/"+d);var f="filter/"+c+d+"/1";typeof c!="undefined"&&c.toLowerCase()=="all"&&(""!=a?f="1":isTopicQuickView=="false"?f="recent":f=""),processHash(e+f)}function manageFilterMenuList(a,b){var c=$("#"+a);$("#innerTabFilter div.forumOptions").is(":visible")&&$(this).hide();if(b.attr("purpose")=="filterTabMenu"){var d=$("#innerTabFilter"),e=d.attr("forumURL"),f=d.attr("subForumURL"),g=b.attr("labelName"),h=b.parent().attr("filterType"),i=1;d.find("li.selectedTab").removeClass("selectedTab"),$("#"+h+"FilterMenuList").addClass("selectedTab");var j=b.attr("filterBy");j&&(h=j),d.attr("isTypeURL")=="yes"?getMoreTopics(e,f,i,h,"",g):manageFilterHash(e,f,h,g)}}function bindTagsContClick(a){a.find('li[purpose ="getTagPosts"]').click(function(){$this=$(this);var a=$this.attr("hashPurpose");processHash(a)})}function processTopicListClick(a){var b=$(a.target),c=b.parent(),d=$("#topicList"),e="topicList",f=b.parents('li[parentCont="actualParent"]').attr("forumTopicId");if(b.is('span[defaultTopicView="true"]')||b.is('a[purpose="postTitleQuickView"]')){f=f||c.parents('li[parentCont="actualParent"]').attr("forumTopicId");if(b.is("span.nddownArrow")){var g=d.data("currentUpArrow");typeof g!="undefined"&&g.removeClass("ndupArrow").addClass("nddownArrow"),b.removeClass("nddownArrow").addClass("ndupArrow"),d.data("currentUpArrow",b)}else b.is("span.ndupArrow")&&b.removeClass("ndupArrow").addClass("nddownArrow");return handleTopicClick(a,f,e),!1}if(b.is('a[purpose="postTitle"]')||b.is("a.orangeLink")||b.is('span[defaultTopicView="false"]')){showLoadingImage();if(isTopicQuickView!="false"){var h=b.parents('li[parentCont="actualParent"]').attr("recentResponseId"),i=b.attr("isResponse");return h!=undefined&&i=="true"?processHash("Topic/"+f+"/"+h):processHash("Topic/"+f),!1}if(isEmbedService())return!1}else if(c.is('li[purpose="moreAction"]'))manageMoreAction(c);else if(b.is('a[purpose="moreAction"]')){var j=b.parents("li");manageMoreAction(j)}else if(b.is('a[purpose="linkedTopicTitle"]')){showLoadingImage();if(isTopicQuickView!="false"){var k=b.attr("linkToTopicId");return processHash("Topic/"+k),!1}}else{if(b.is('li[linkPurpose="replyToTopic"]')||c.is('li[linkPurpose="replyToTopic"]')){f=f||c.parents('li[parentCont="actualParent"]').attr("forumTopicId");if(d.data("inEditMode")==1){showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info");var l=d.data("editorContLocation"),m=d.data("eachTopicContainerId"),n=d.data("forumTopicId");return n!=f&&handleTopicClick(a,n,"editTopicList"),setFocusToContainer($(l)),!1}return $("#eachTopicReplyCont_"+f).show(),newOpenEditor($("#eachTopicReply_"+f),"responseContent","postContentTA","replyToTopic_"+f,"Write","paginationContainer"),setFocusToContainer($("#eachTopicReplyCont_"+f)),d.data("inEditMode",!0),d.data("editorContLocation","#eachTopicReplyCont_"+f),d.data("eachTopicContainerId","#eachTopic_"+f),d.data("forumTopicId",f),!1}if((b.is("#olderPostsLink")||b.is("#newerPostsLink"))&&b.is(".navBtnEnabled")){var o=b.attr("forumURL"),p=b.attr("categoryURL"),q=b.attr("fetchPage"),r=b.attr("topicFilter"),s=b.attr("getPostFor"),t=b.attr("topicStatus"),u=b.attr("postSinceLastVisitTime");if(typeof s=="undefined")getMoreTopics(o,p,q,r,u,t,"true");else{var v=b.attr("tag_Name");getMoreTagRelatedPost(q,v,s)}}else{if(b.is('a[purpose="forumPostsFilter"]'))return hashPurpose=b.attr("hashPurpose"),processHash(hashPurpose),!1;if(b.is('a[purpose="authorProfile"]')||b.is('img[purpose="authorProfile"]')){var w=b.attr("authorName");w==screenName||w==encodedScreenName?processHash("MyArea"):processHash("User/"+w);return}if(b.is("div.imgSmallWatchSel")||b.is("div.imgSmallWatch")){watchThisItem(b,"singleTopicWatch",a);return}if((b.is("li.ndtopicNavPrev")||b.is("li.ndtopicNavNext"))&&!c.is(".navLoading")){checkPrevNextResponse(b);return}if((b.is("li.ndtopicNavFirst")||b.is("li.ndtopicNavLast"))&&!c.is(".navLoading")){firstOrLastResponse(b);return}if(c.is('li[purpose="watchAction"]')){e=c.is('li[purpose="watchAction"]')?e:"",watchThisItem(c,e,a);return}if(b.is('input[purpose="watchAction"]')){var f=b.attr("forumTopicId"),x=$("#eachTopicReplyCont_"+f).find('input[name="isFollowTopic"]');b.attr("checked")==1?x.attr("value","true"):x.attr("value","false");return}if(c.is('li[purpose="emailThisTopic"]')){openEmailTopicDialog(c);var j=c.parents('li[purpose="moreAction"]');manageMoreAction(j);return}if(c.is('li[purpose="moderateThisTopic"]')){moderateAction(c,e,a);return}if(c.is('li[actionPurpose="delete"]')){singlePostDeleteAction(c,e);return}if(c.is("#removeTopicLink")||c.is('li[purpose="removeTopicLink"]'))deletelinkedTopic(c);else{if(c.is('li[actionPurpose="edit"]')){var y=c.attr("responseId"),z=c.parents('li[parentCont="actualParent"]').attr("forumTopicId"),A="#eachTopic_"+z;if(d.data("inEditMode")){showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info"),l=d.data("editorContLocation");var n=d.data("forumTopicId");return z!=n&&handleTopicClick(a,n,e),setFocusToContainer($(l)),!1}return newOpenEditor($("#recentResponseContent_"+y),"responseContent","postContentTA","editPostContent_"+y,"Edit","eachTopic_"+y),setFocusToContainer($(A)),d.data("inEditMode",!0),d.data("editorContLocation",A),d.data("forumTopicId",z),$("#postTextContent_"+y).find("ul.singlePostActions").hide(),$("#linkedTopic_"+y).hide(),$("#singlePostActions_"+y).hide(),$("#recent_ResPonse_"+y).find("div.listOfResponseLink").hide(),$("#previewResponse").attr("location","topicListEditResponse"),$("#previewResponse").attr("responseId",y),$("#previewResponse").attr("forumTopicId",z),!1}if(b.is('li[deletepurpose="deleteAttachment"]')){deletePublishedAttachment(b,a);return}if(c.is('span[deletepurpose="deleteAttachment"]')){deletePublishedAttachment(c,a);return}if(c.is("li[bestResponse]")){var B=c,y=B.attr("responseId"),f=B.parents('li[parentCont="actualParent"]').attr("forumTopicId"),C=B.attr("topicAuthorId"),D=B.attr("bestResponse"),E={};E.forumGroupId=forumGroupId,D=="choose"&&(E.responseId=y),E.forumTopicId=f,C==ZUID&&(E.topicowner="true"),E[csrfParamName]=csrfToken;var F=D=="choose"?"/bestResponse.do":"/removeBestResponse.do";showSmallLoadingImage(a),doAjaxAction(F,E,function(a){if(a=="SUCCESS"){var b=D=="choose"?i18n["zohodiscussions.singlepost.bestResponseSuccessMsg"]:i18n["zohodiscussions.singlePost.removeBestResponseMsg"],c=D=="choose"?"success":"info";showTipper(b,c),refreshSingleTopic(f)}else hideLoadingImage(),showMessage(i18n["zohodiscussions.generalmessage.noPermission"])})}else if(b.is("input[followItem]")){var G=b.attr("followItem"),H=b.attr("responseId");G=="true"&&watchItem(b),$("#followTopicList_"+H).hide()}}}}}function manageMoreAction(a){if(a.is(".newComboSelectedNm")){a.removeClass("newComboSelectedNm").addClass("newCombo"),a.find("div.forumOptins").hide();return}a.removeClass("newCombo").addClass("newComboSelectedNm");var b=a.find("div.forumOptins");b.show(),a.hover(function(){a.attr("hideAuhPopout","false");var b=a.data("destroyHandle");b&&clearTimeout(b)},function(){var c=setTimeout(function(){a.removeClass("newComboSelectedNm").addClass("newCombo"),b.hide(),a.unbind("mouseenter").unbind("mouseleave")},500);a.data("destroyHandle",c)})}function refreshResponseVoteContainer(a){var b={};b.forumGroupId=forumGroupId,b.responseId=a,doAjaxAction("/refreshSingleResponse.do",b,function(b){var c=$(b).find('div[contPurpose="voteContainer"]');$("#postTextContent_"+a+' div[contPurpose="voteContainer"]').html(c.html()),hideLoadingImage()})}function backtoEditor(){$("#addForumPostForm").show(),$("#writeNewTopic").show(),$("#publishPreviewedTopic").hide(),$("#backToEditor").hide(),$("#preview_Posts").hide(),$("#writePostButtons").show(),$("#writepostCont").show(),$("#forumTagsPreview").html(" ")}function publishPreviewedTopic(){$("#publishTopic").trigger("click")}function writePostPreview(a,b,c,d){var e=$("#topicTitle").val(),f=e.replace(/^<+|<+$/g,"&lt;").replace(/<+/g,"&lt;").replace(/^>+|>+$/g,"&gt;").replace(/>+/g,"&gt;");f=f.replace(/^\s+|\s+$/g,"").replace(/\s+/g," ");if(f==""){hideLoadingImage(),setFocusToContainer($("#topicTitle").focus()),enablePostButtons(),showDiscussionMessage(i18n["zohodiscussions.writePost.TopicTitleCannotbeEmptymessage"],"failure");return}if(f.length>200){hideLoadingImage(),showDiscussionMessage(i18n["zohodiscussions.writePost.TopicTitleLengthMsg"],"failure"),enablePostButtons();return}var g=editor.doc.body.textContent.trim();editor.mode==="plaintext"&&(g=editor.getContent().trim());if(g==""){hideLoadingImage(),showDiscussionMessage(i18n["zohodiscussions.writePost.noContentInPost"],"failure"),enablePostButtons();return}var h=$("#SelectForum").val(),i=$("#SelectCategory").val();if(h==null){hideLoadingImage(),$("#selectForumMessage").show(),setFocusToContainer($("#SelectForum")),enablePostButtons(),isZSupport?showDiscussionMessage(i18n["zohodiscussions.writePost.selectAnyCategoryForZSupport"],"failure"):showDiscussionMessage(i18n["zohodiscussions.writePost.selectAnyForum"],"failure");return}if(i=="0"){hideLoadingImage(),$("#selectForumMessage").show(),setFocusToContainer($("#SelectCategory")),enablePostButtons(),isZSupport?showDiscussionMessage(i18n["zohodiscussions.writePost.selectAnyForumForZSupport"],"failure"):showDiscussionMessage(i18n["zohodiscussions.writePost.selectAnyCategory"],"failure");return}$("#selectForumMessage").hide();var j=$("#forumTags").val();if(j!=""){j=j.replace(/^\s+|\s+$/g," ").replace(/\s+/g," ");if(j.match(/^[^\^\"'()~`!@#$%&:;\/\\?|<>{}[\]*-+=]+$/)==null){hideLoadingImage(),showDiscussionMessage(i18n["zohodiscussions.singlepost.specialCharacterNotAllowedMsg"],"failure"),enablePostButtons();return}}if(d){$("#previewAttachment >li").html("");var k=$("#attachmentsListCont").find("div[attachmentDetails]"),l=$("#attachmentsListCont").find("div[attachmentDetails]").length;if(l>0){var m=$("#previewAttachment");attachmentListPreview(m,k),$("#AttachmentPreviewCont").show()}else $("#AttachmentPreviewCont").hide()}$("#addForumPostForm").hide(),$("#writeNewTopic").hide(),$("#publishPreviewedTopic").show(),$("#backToEditor").show(),$("#writepostCont").show();var n=$("#preview_Posts").show();$("#writePostButtons").hide();var o=$("#TopicContentHolder").attr("imgAttrClass"),p=$("#previewTopicTypeImg").attr("class"),q=p.split(" ");$("#previewTopicTypeImg").removeClass(q[1]).addClass(o);if(n.is(":visible")){var r=$("#preview_breadCrumb,#preview_postHeader");r.find('a[purpose="authorProfile"]').html(a),$("#previewDocumentTitle").html(f),r.find('a[purpose="forum_Topic"]').html($("#SelectForum option:selected").text());var s=$("#SelectCategory option:selected").text(),t=$("#SelectCategory option:selected").val();t>0?(r.find('span[purpose="cateArrow"]').show(),r.find('a[purpose="category_Topic"]').html(s)):(r.find('span[purpose="cateArrow"]').hide(),r.find('a[purpose="category_Topic"]').html("")),j=j.replace(/^\s+|\s+$/g," ").replace(/\s+/g," "),j==""&&$("#forumTagsPreview").html(i18n["zohodiscussions.singlepost.noTagsMsg"]);var u=j.split(",");for(var v=0;v<u.length;v++)jQuery.trim(u[v])!=""&&$("#forumTagsPreview").append("<li><a>"+u[v]+"</a></li>");var g=editor.getContent();g=g.replace(/^\s+/g,"").replace(/\s+$/g,"");var w=editor.doc.body.textContent.trim();editor.mode==="plaintext"&&(w=g.trim(),g=encodeHTML(g),g=g.replace(/\n/g,"<br/>"));if(w==""){hideLoadingImage(),showDiscussionMessage(i18n["zohodiscussions.writePost.noContentInPost"],"failure");return}n.find("#responsePreviewContentContainer").html(g.trim())}}function forHidingSmallLoadingImg(){var a="",b="";$("#newPostRightCont").length>0?a=$("#newPostRightCont"):$("#attachBrowseCont").length>0&&(a=$("#attachBrowseCont")),a.find("[purpose='attachLoadingCont']").hide()}function processSearchContClick(a){var b=$(a.target),c=b.parent();if($("#loadingImg").is(":visible"))return;if(c.is('div[purpose="advanceSearch"]'))$("#advanceSearchContainerForm").show(),$("#normalSearchInSearchList").hide();else if(b.is('button[purpose="advanceSearchCancel"]')||b.is('div[purpose="advanceSearchCancel"]'))$("#advancedSearchForm").is(":visible")?$("#advancedSearchForm").remove():($("#advanceSearchContainerForm").hide(),$("#normalSearchContainer").show(),$("#normalSearchInSearchList").show());else if(b.is('button[purpose="normalSearch"]')){var d=$("#normalSearchInputBox").val();processHash("normalsearch")}else if(b.is('button[purpose="getAdvanceSearch"]'))getDiscussionsAdvanceSearchResult();else{if(b.is('a[purpose="postTitle"]')){var e=b.attr("forumTopicId"),d=b.attr("searchFor");openSinglePost(e,"topic",d);return}if(c.is('a[purpose="postTitle"]')){var e=c.attr("forumTopicId"),d=c.attr("searchFor");openSinglePost(e,"topic",d);return}if(b.is('a[purpose="forumAction"]')||b.is('a[purpose="categoryAction"]')){var f=b.attr("hashPurpose");processHash(f)}else{if(b.is('a[purpose="authorProfile"]')||c.is('a[purpose="authorProfile"]')){var g=b.attr("authorName");g||(g=c.attr("authorName"));var h=b.attr("singleClickflag");h||(h=c.attr("singleClickflag")),h=="0"&&(g==screenName||g==encodedScreenName?(processHash("MyArea"),b.attr("singleClickflag","1")):(processHash("User/"+g),b.attr("singleClickflag","1")));return}if(b.is("li.navBtnEnabled")&&b.is('[navType="searchNav"]')){var i=b.attr("purpose");searchNavigation(c,i);return}if(b.is('a[purpose="relativeLinkSearch"]'))searchNavigation(b,"relativeLinkSearch");else if(b.is('a[purpose="sortbyrelevance"]')&&!b.is(".boldText"))searchNavigation($("#breadCrumbForSearch span:last a"),"breadCrumbForSearch","relevance");else if(b.is('a[purpose="sortbydate"]')&&!b.is(".boldText"))searchNavigation($("#breadCrumbForSearch span:last a"),"breadCrumbForSearch","date");else if(b.is('a[purpose="breadCrumbForSearch"]'))searchNavigation(b,"breadCrumbForSearch");else if(b.is('a[purpose="expandForumList"]')){var j=b.attr("status");if(j=="off")b.attr("status","on").html("&laquo; less"),b.parents("ul").find("li").show();else{b.attr("status","off").html("more &raquo;");var k=0;b.parents("ul").children("li").each(function(){k>4&&$(this).hide(),k++})}}}}}function searchNavigation(a,b,c){showLoadingImage();var d=parseInt(a.attr("fetchPage")),e=a.attr("fieldType"),f=a.attr("categId"),g=a.attr("pathTraverse"),h=$("#breadCrumbForSearch"),i=a.attr("forumId"),j=a.attr("searchLevel"),k=a.attr("isResourceSearch");if(k===undefined||k==="undefined")k=!1;b=="next"?d+=1:b=="prev"?d-=1:d=1,i=="undefined"&&(i=-1);if(j=="forums"||j=="all"){f="",g="";var l=$("#SearchforumCategoryVice"),m=$("#SearchCategoryVice");m.find('option[value="-1"]').attr("selected","true"),j=="all"&&l.find('option[value="-1"]').attr("selected","true")}var n=c;n!="relevance"&&n!="date"&&(n=$("#currSearchSortBy").attr("currSortBy"));if($("#searchListContainer").is(":visible"))doAjaxAction("/getMoreSearchResult.do?fetchPage="+d+"&searchSortBy="+n+"&category_id="+f+"&category_pathTraverse="+g+"",$("#advanceSearchForm").serialize(),function(a){hideLoadingImage(),reloadeSearchContainer(a,b,e,i,f,g,n)});else{var o={};o.fetchPage=d,o.searchSortBy=n,b=="breadCrumbForSearch"?o.searchFor=h.attr("searchFor"):o.searchFor=a.attr("searchFor"),o.category_pathTraverse=g,o.category_id=f,o.forumGroupId=forumGroupId,o.forumId=i,o.isResourceSearch=k,o.normalSearchType=$("#searchSelectedImage").attr("purpose"),doAjaxAction("/getMoreSearchResult.do",o,function(a){hideLoadingImage(),reloadeSearchContainer(a,b,e,i,f,g,n)})}}function reloadeSearchContainer(a,b,c,d,e,f,g){var h=$("#breadCrumbForSearch"),i=$("<div></div>");i.get(0).innerHTML=a;var j=i.find("#searchListContainer").html();$("#searchListContainer").html(j);var k=i.find("#searchResultViewRange").html();$("#searchResultViewRange").html(k);var l=i.find("#searchFilterArea").html();$("#searchFilterArea").html(l);var m=i.find("#currSearchSortBy").html();$("#currSearchSortBy").html(m).attr("currSortBy",g);if(b=="relativeLinkSearch"){var n=$("<span> &raquo; <a class=underline href=javaScript:; purpose=breadCrumbForSearch fieldType="+c+" forumId="+d+" categId="+e+" pathTraverse="+f+">"+c+"</a></span>");n.insertAfter($("#breadCrumbForSearch").find("span:last"))}else if(b=="breadCrumbForSearch"){var o=0;h.children().each(function(){var a=$(this),b=a.find("a").attr("fieldType");o==1&&a.remove(),b==c&&(o=1)})}}function getDiscussionsAdvanceSearchResult(){showLoadingImage();var a=$("#advanceSearchInpurBox").val();a=$.trim(a);if(a==""){showMessage(i18n["zohodiscussions.searchList.noSearchString"],"failure"),hideLoadingImage();return}var b=$("#SearchforumCategoryVice"),c="forumId",d={};doAjaxAction("/getAdvanceSearchResult.do",$("#advanceSearchForm").serialize(),function(a){hideLoadingImage();var b=$("<div></div>");b.get(0).innerHTML=a;var c=$("#searchContainer");if($("#searchListContainer").is(":visible")){var d=b.find("#searchResultFullContainer").html();$("#searchResultFullContainer").html(d)}else $("#mainContent").get(0).innerHTML=a,bindSearchContentClick($("#mainContent")),$("#advanceSearchContainerForm").show(),$("#normalSearchInSearchList").hide()},function(a){hideLoadingImage();var b=toEvaluateData(a.responseText);b.errorcode=="REMOTE_IP_LOCKED"&&showMessage(i18n["zohodiscussions.generalmessage.tryagainaftersometime"],"failure")})}function processWidgetsContClick(a){var b=$(a.target),c=b.parent();if(b.is("a[hashPurpose]")&&b.is('a[currpurpose="usingHash"]')){var d=b.attr("hashPurpose");if(isTopicQuickView!="false"||d.indexOf("Topic/")!=0)return processHash(d),!1}else if(b.is("div.teeplus")){var e=b.attr("forumId"),f=$("#allForumControl").find('div[purpose="subForumView_'+e+'"]');f.removeClass("teeplus").addClass("teeminus"),$("ul.eachCategoryContainer_"+e).show()}else if(b.is("div.teeminus")){var e=b.attr("forumId"),f=$("#allForumControl").find('div[purpose="subForumView_'+e+'"]');f.removeClass("teeminus").addClass("teeplus"),$("ul.eachCategoryContainer_"+e).hide()}else{if(c.is("#forumPermalink")){var g=c.attr("thisForumPermalink");$("#PermalinkCont textarea").val(g),$("#permalink_Text").select(),$("#PermalinkCont").show().parent().show();return}if(c.is("li.watchingForum"))watchThisItem(c,"singleForumActions",a);else if(c.is("li.watchingCategory"))watchThisItem(c,"singleCategoryActions",a);else{if(b.is('a[purpose="newWatchedUser"]')){processHash("myarea/dashboard");return}if(b.is('a[purpose="newPrivateMsg"]')){processHash("myarea/privateMsg");return}if(b.is('a[purpose="newRecentActivity"]')){var h=b.attr("currStatus");if(h=="dashboard"){processHash("myarea/"+h);return}processHash("myarea/watchList/"+h);return}if(b.is('a[purpose="authorProfile"]')){var i=b.attr("authorName"),j=b.attr("singleClickflag");j=="0"&&(i==screenName||i==encodedScreenName?(processHash("MyArea"),b.attr("singleClickflag","1")):(processHash("User/"+i),b.attr("singleClickflag","1")));return}if(c.is("#loginToParticipate"))$("#signinwidgetBox").hide(),$("#iamLoginBox").show();else if(c.is("#chartMenu")){if(b.is("li")){b.siblings().removeClass("selected"),b.addClass("selected");var k=b.attr("assocImage"),l=$(k);if(k=="#weekTrendChart"){var m=l.find('img[chart="true"]');typeof m.attr("src")=="undefined"?(m.attr("src",m.attr("actualURL")),$("#weekTrendChartLoading").show().siblings("a").hide(),m.one("load",function(){l.show(),l.prev('div[purpose="chartLoading"]').hide()}).each(function(){this.complete&&$(this).trigger("load")})):l.show().siblings().hide()}else l.show().siblings().hide()}}else if(b.is("li[assocDiv]")){b.siblings().removeClass("selected"),b.addClass("selected");var n=b.attr("assocDiv");if(n=="#topPublishers_Month"){if($(n).find("li").length==0){var e=b.attr("forumId"),o=b.attr("categoryId"),p={};p.forumGroupId=forumGroupId,p.forumId=e,p.categoryId=o,doAjaxAction("/getLeaderboardTopics.do",p,function(a){$(n).get(0).innerHTML=a})}$(n).show(),$("#topContributors_Month").hide()}else $(n).show().siblings("ul").hide()}}}}function processAllForumsClick(a){var b=$(a.target),c=b.parent();if(b.is("a[hashPurpose]")){var d=b.attr("hashPurpose");if((isTopicQuickView!="false"||d.indexOf("Topic/")!=0)&&b.attr("isNiceUrl")!="Yes")return processHash(d),!1}else{if(c.is('li[purpose="eachForumPermalink"]')){var e=c.attr("thisForumPermalink");$("#PermalinkCont textarea").val(e),$("#permalink_Text").select(),$("#PermalinkCont").show().parent().show();return}if(c.is("li.watchingForum"))watchThisItem(c,"singleForumActions",a);else if(c.attr("watchItemType")==1)watchThisItem(c,"singleCategoryActions",a);else if(c.is('div[purpose="moderator"]')){var f=c.attr("forumId");$forumCont=$("#forumId_"+f),$forumCont.is(".singleForumSub")&&$forumCont.removeClass("singleForumSub"),$forumCont.toggleClass("singleForumMod")}else if(c.is('div[purpose="subforums"]')){var g=c.attr("forumId");$forumCont=$("#forumId_"+g),$forumCont.is(".singleForumMod")&&$forumCont.removeClass("singleForumMod"),$forumCont.toggleClass("singleForumSub")}}}function handleTopicClick(a,b,c){var d=$("#eachTopic_"+b),e=$("#lastResponse_"+b),f=e.parents('li[parentCont="actualParent"]').attr("recentResponseId"),g=$("#topicList");g.data("currentSelectedPost",d);var h=g.data("currentFocusPost");h!=undefined&&h.removeClass("hotKeyTopicCont"),g.data("currentFocusPost",d),e.is(":visible")==1?d.removeClass("ndquickList").addClass(""):(d.siblings("li.ndquickList").removeClass("ndquickList").addClass(" "),d.addClass("ndquickList"),setFocusToContainer($("#eachTopic_"+b),!1,0)),e.attr("navStatus")=="No"&&c=="topicList"&&(e.attr("navStatus","Yes"),getprevAndFirstPost(e))}function getMoreTopics(a,b,c,d,e,f,g){showLoadingImage();var h={},i="",j=$("#topicListHeaderCont").attr("isTypeURL"),k=$("#innerTabFilter");$("#topicListFilter").is(":visible")&&(k=$("#topicListFilter")),a!=""&&(h.forumURL=a,isTopicQuickView=="true"?i="forum/"+a:i=a),b!=""&&(h.categoryURL=b,i=i+"/"+b),h.forumGroupId=forumGroupId,h.fetchPage=c;var l=0;d&&d.toLowerCase()!="all"&&(isOneTopicType!="true"||d.toLowerCase()!="questions"&&d.toLowerCase()!="ideas"&&d.toLowerCase()!="problems")&&(i==""?i="filter":i+="/filter",l=1,i=i+"/"+d);if(d){if(k.attr("isTypeURL")=="yes"){var m=k.attr("topicfiltertype");d.toLowerCase()=="all"?d=m:d.toLowerCase()=="unrepliedposts"&&(h.unReplyWithType=m)}h.topicFilter=d}if(d=="postssincelastvisit"){var n=k.attr("postSinceLastVisitTime");n!=null&&n!="undefined"&&(h.postSinceLastVisitTime=n)}var o="";$("#topicList").length>0&&g!="reload"?(o="/getMoreTopics.do",$locadLocation=$("#topicList")):$("#topicsList").length>0&&g!="reload"?(o="/getMoreTopicsTP.do",$locadLocation=$("#topicsList")):(o="/getSingleForumTopics.do",$locadLocation=$("#mainContent"));if(f){f=f.toLowerCase(),f=f.replace(/\s/ig,"").replace("-","");var p=f;d=="problems"&&f=="needmoreinfo"&&(f="moreinfo",p="needmoreinfo"),d=="questions"&&f=="workingonit"&&(f="working",p="workingonit");if(i18n_Status_[f]){var q=i18n_Status_[f];q&&(l==0&&i==""?i="filter":l==0&&(i+="/filter"),i=i+"/"+p,h.statusURL=q)}}return doAjaxAction(o,h,function(a){$locadLocation.get(0).innerHTML=a,bindTopicClicks($("#topicList")),bindTopicClicks($("#topicsList")),o=="/getSingleForumTopics.do"&&(lightBox("#chartWidget"),lightBox("#topicList"),bindTopicListHeaderClicks($("#topicListHeader")),bindWidgetsContClick($("#topicListWidgetsCont"))),goToTop(),hideLoadingImage();if(typeof WmsContacts!="undefined"&&ch=="true"){var b=WmsContacts.getZohoContacts();setPresenceInTopicList(b)}if(d=="PostsSinceLastVisit"){var e=$("#topicList").find("a.mediumUnderlineLink");e.removeClass("mediumUnderlineLink").addClass("mediumUnderlineLinkNew")}j=="no"&&isTopicQuickView=="true"&&(i!=""?parseInt(c)>1?$.history.add(i+"/"+c):$.history.add(i):parseInt(c)>1?$.history.add("home/"+c):$.history.add("home"))},function(a){}),!1}function getMoreTagRelatedPost(a,b,c){showLoadingImage();var d={};return d.fetchPage=a,d.tagName=b,d.forumGroupId=forumGroupId,d.getPostFor=c,doAjaxAction("/getMoreTagRelatedPosts.do",d,function(a){$("#topicList").length>0?($("#topicList").get(0).innerHTML=a,bindTopicClicks($("#topicList"))):($("#topicsList").get(0).innerHTML=a,bindTopicClicks($("#topicsList"))),goToTop(),hideLoadingImage()},function(a){}),!1}function getSingleForumTopics(a){showLoadingImage();var b=a,c={};return c.forumId=b.attr("forumId"),c.categoryId=b.attr("categoryId"),c.forumGroupId=forumGroupId,c.fetchPage=b.attr("fetchPage"),c.ch=ch,doAjaxAction("/getSingleForumTopics.do",c,function(a){$("#mainContent").get(0).innerHTML=a,lightBox("#chartWidget"),lightBox("#topicList"),bindTopicClicks($("#topicList")),bindTopicClicks($("#topicsList")),bindTopicListHeaderClicks($("#topicListHeader")),bindWidgetsContClick($("#topicListWidgetsCont")),goToTop(),hideLoadingImage(),$("#allForumWidget").length>0&&$("#allForumWidget").find('li[purpose="forumList"]').length<9&&$("#moreForumView").hide()},function(a){$("#mainContent").get(0).innerHTML=a.responseText,hideLoadingImage()}),!1}function selectTopicType(a,b){var c="";if(typeof b=="undefined"||b==""){a.addClass("selected").siblings('li[purpose="topicTypeTab"]').removeClass("selected"),c=a.attr("topicType");var d=a.attr("topicIconClass")}else d=b,c=$("#writepostCont").attr("topicType");var e="";c==1?(e="imgAnnouncement",$("#announcementExpiryCont").show()):$("#announcementExpiryCont").hide(),$("#currentTopicType").val(c),d=="discuss"?(e="imgDiscuss",$("#writeNewTopic").html(i18n["zohodiscussions.writePost.discussionTypeMessage"])):d=="question"?(e="imgQuestion",$("#writeNewTopic").html(i18n["zohodiscussions.writePost.questionTypeMessage"])):d=="idea"?(e="imgIdea",$("#writeNewTopic").html(i18n["zohodiscussions.writePost.ideaTypeMessage"])):d=="error"?(e="imgError",$("#writeNewTopic").html(i18n["zohodiscussions.writePost.problemTypeMessage"])):$("#writeNewTopic").html(i18n["zohodiscussions.writePost.announcementTypeMessage"]),$("#TopicContentHolder").attr("class",d).attr("imgAttrClass",e);var f=$("#SelectForum").val();f==null?$("#selectForumMessage").show():$("#selectForumMessage").hide()}function initWritePost(){$("#editorHolder > .ze").is(":visible")||newOpenEditor($("#editorLocation"),"responseContent","postContentTA"),loadCategories(),isAutoSuggestEnabled&&(portalUsersAutoSuggest($("#forumallTags"),$("#forumTags")),portalUsersAutoSuggest($("#allForumUsersEmail"),$("#emailIds"))),$('#writepostTabsCont li[purpose="topicTypeTab"]').click(function(){selectTopicType($(this))}),$("#SelectForum").change(function(){loadCategories()}),$("#publishTopic").click(function(){addForumPost(!1)}),$("#previewTopic").click(function(){var a=$(this),b=a.attr("isDraft"),c=a.attr("userName");writePostPreview(c,"Preview","true",b)}),$("#attachmentsListCont").find("div.imgAshDelete").click(function(a){$this=$(this);var b=$this.attr("attachmentName"),c=$this.attr("attachmentId");deleteUnpublishedAttachment(b,c,a);return}),$("#listOfMyDraftCont").click(function(){var a=$(this).attr("draftsize");if(a<1)return;var b=$(this);b.is(".moreOptionsTop")?b.removeClass("moreOptionsTop").addClass("moreOptionsTopSelected"):b.removeClass("moreOptionsTopSelected").addClass("moreOptionsTop"),b.hover(function(){var a=b.data("destroyHandle");a&&clearTimeout(a)},function(){var a=setTimeout(function(){b.removeClass("moreOptionsTopSelected").addClass("moreOptionsTop")},500);b.data("destroyHandle",a)})}),$("#saveDraft").click(function(){addForumPost(!0)}),$("#cancelAddTopic").click(function(){$("#mainContent div.mainFullWrite").html(""),isCancelButtonClicked("Home")}),loadUploadAttachmentsCont()}function closeGDocsAttachTemplate(a){a=="zdocs"?$("#zDocsTemplate").hide():$("#gDocsTemplate").hide(),hideLoadingImage()}function loadUploadAttachmentsCont(a,b){var c=$("#attachTemplate").length==1?!0:!1,d=c==1?"attachTemplate":"responseAttachTemplate",e=$("#attachmentsListCont"),f=e.find("div.singleElementBox,li.tinyText").length;$("#publishResponse,#previewResponse").attr("disabled",!1),$("#publishTopic,#saveDraft").attr("disabled",!1),b==="attachZDocs"&&($("#publishResponse,#previewResponse").attr("disabled",!0),$("#publishTopic,#saveDraft").attr("disabled",!0)),c==1?$('#newPostRightCont  div[purpose="attachmentTemplate"]').remove():$("#attachBrowseCont").html("");if(f<maxAttachmentsPerPost){var g=maxAttachmentsPerPost-f,h=f+1,i=$("#"+d),j=i.clone();c==1?j.insertBefore(e).show():$("#attachBrowseCont").append(j.show()).show(),j.attr("id",d+"_"+h),j.attr("purpose","attachmentTemplate");var k='<form action = "/uploadFile.do" target = "fileUpdTgt" method="post" enctype="multipart/form-data"></form>';isEmbedService()&&(k='<form action = "/discussions/uploadFile.do" target = "fileUpdTgt" method="post" enctype="multipart/form-data"></form>'),j.find("div.dataEncloser").wrap(k),j.find("div.iFrameContainer").html('<iframe name = "fileUpdTgt_'+h+'"> </iframe>'),j.find("form").attr("target","fileUpdTgt_"+h);var l=j.find("form > div.dataEncloser"),m=l.find("span#desktopAttachments"),n=l.find("a#zDocsAttachments"),o=l.find("a#gDocsAttachments");m.click(function(){if($("#publishResponse").attr("disabled")||$("#publishTopic").attr("disabled"))return!1;$("input[type=file]").change(function(){$("#publishResponse,#previewResponse").attr("disabled",!0),$("#publishTopic,#saveDraft").attr("disabled",!0)})}),n.click(function(){if($("#publishResponse").attr("disabled")||$("#publishTopic").attr("disabled"))return!1;var a="https://"+ZDOCS_URL,b={servicename:"discussion",attachCount:h,search:!1,docsURL:a};ATTACHDIALOG.showAttachFileDialog(b)}),o.click(function(){if($("#publishResponse").attr("disabled")||$("#publishTopic").attr("disabled"))return!1;var a=scheme+"://"+GADGET_URL+"/gdocs?serURL="+scheme+"://"+domainNameURL+"/jsp/AddGDocs.jsp&maxDocs="+g+"&id=1";isEmbedService()&&(a=scheme+"://"+GADGET_URL+"/gdocs?serURL="+scheme+"://"+domainNameURL+"/discussions/jsp/AddGDocs.jsp&maxDocs="+g+"&id=1");var b=$("#gDocsTemplate");b.html('<iframe height="600px;" width="800px;" style="margin-top:5%; margin-left:17%" src="'+a+'"></iframe>'),b.show()});if(typeof a=="undefined")j.find(":file").change(function(){j.find('[purpose="attachLoadingCont"]').show(),j.find(':input[name="attacher"]').val(""),j.find("form").get(0).submit()});else{showLoadingImage(i18n["zohodiscussions.settings.creating"]);var p=a.split(":"),q="attachZDocs";b=="gdocs"&&(q="attachGDocs"),$.each(p,function(a,b){j.find("form div.dataEncloser").append('<input name="'+q+'"  type="hidden" value="'+b+'">')}),j.find("form").get(0).submit()}}}function uploadGDocsFileSuccess(a,b,c){var d=a.length,e=0,f="",g="";for(var h=0;h<d;h++){var i=a[h],j=i.result,k=i.actualFileName;if(j=="success"){var l=i.actualAttachId,m=i.attachmentSize,n=i.attachmentId;uploadFileSuccess(n,k,b,l,m)}else{e=1;var o=i.reason;f=f+g+"<b>"+k+"</b> : "+i18n[o],g="<br><br>"}}if(e==1){showMessage(i18n["zohodiscussions.popupContainers.failedattachmentMess"]+"<br>"+f,"failure","20%");if($("#publishResponse").attr("disabled")||$("#publishTopic").attr("disabled"))$("#publishResponse,#previewResponse").attr("disabled",!1),$("#publishTopic,#saveDraft").attr("disabled",!1),loadUploadAttachmentsCont()}closeGDocsAttachTemplate(c)}function uploadFileSuccess(a,b,c,d,e){var f=$("#attachmentsListCont"),g=$("#attachTemplate").length==1?!0:!1,h,i=a+","+encodeHTML(b)+","+e;$("#previewResponse").append('<input type = "hidden" name="attachmentId" value = "'+a+'"  attachmentDetails= "'+i+'">');if(g==1){h=$('<div id="newAttachment_'+a+'" class="singleElementBox" attachmentDetails="'+i+'"><div class="flLeft">'+encodeHTML(b)+'</div><div class="flRight imgAshDelete bgBox"></div></div>');var j=$("#previewAttachment");$("#newAttachment_"+a).attr("attachmentDetails",i),$("#AttachmentPreviewCont").show()}else i=a+","+b+","+e,h=$("#responseEachAttachmentTemplate").clone(),h.attr("id","newAttachment_"+a).attr("attachmentDetails",i).show(),h.find('[attachmentPurpose="attachmentName"]').text(b),h.find('[attachmentPurpose="attachmentSize"]').text(e);d!=-1&&h.append('<input type = "hidden" name="attachmentId" value = "'+d+'">'),h.find("div.imgAshDelete").click(function(c){deleteUnpublishedAttachment(b,a,c)}),f.append(h),loadUploadAttachmentsCont()}function deleteUnpublishedAttachment(a,b,c){if(confirm(i18n["zohodiscussions.generalmessage.deleteAttachmentConfirmMsg"])){showSmallLoadingImage(c);var d={};d.forumGroupId=forumGroupId,d.fileName=a,d.fileId=b,d[csrfParamName]=csrfToken,doAjaxAction("/deleteUnpublishedAttachment.do",d,function(a){hideLoadingImage(),a=="SUCCESS"&&($("#newAttachment_"+b).remove(),$("#previewAttachment").find("li.singleList").length==1&&$("#AttachmentPreviewCont").hide(),$("#previewResponse").find('input[value= "'+b+'"]').remove(),showTipper(i18n["zohodiscussions.general.Deleted"],"info"),loadUploadAttachmentsCont())})}}function loadCategories(){loadAdminActionsLinks();var a=$("#SelectForum"),b=a.val(),c=a.attr("selectedCategoryName"),d=a.attr("selectedCategoryId"),e=$("#categoryList").val();$("#SelectCategory").hide(),$("#selectCategory").html(""),typeof e!="undefined"&&$.each(e.split("$$"),function(a,c){if(c.indexOf(b+":")>-1)return $("#SelectCategory").html(c.split(":")[1]).show(),!1;$("#SelectCategory").html('<option selected value="-1">Uncategorised</option>').show()});var f=$("#SelectCategory").find('option[value="'+d+'"]');f.length==1?f.attr("selected","true"):$("#SelectCategory option:first").attr("selected","true")}function loadAdminActionsLinks(){var a=$("#SelectForum option:selected").attr("isForumModerator"),b=$("#SelectForum option:selected").attr("isForumPublicView");a=="true"?$("#isStickyLinkCont,#announcementLinkCont").fadeIn():($("#isStickyLinkCont,#announcementLinkCont").fadeOut(),$("#writepostTabsCont li.selected").attr("topicIconClass")=="announcement"&&$("#writepostTabsCont li:first").trigger("click"));if(forumGroupId==0x591a208af78bb8){$("#isNotifyEveryone").fadeOut();return}if(typeof b=="undefined"){$("#isNotifyEveryone").fadeOut();return}b=="false"?$("#isNotifyEveryone").fadeIn():$("#isNotifyEveryone").fadeOut()}function addForumPost(a){if($("#fileUploadStatus").val()!="uploading"){var b=a==1?i18n["zohodiscussions.general.saving"]:i18n["zohodiscussions.general.publishing"];disablePostButtons();var c=$("#addForumPostForm");$topicTitle=$("#topicTitle");var d=$topicTitle.val();d=d.replace(/^\s+|\s+$/g," ").replace(/\s+/g," "),d=$.trim(d);if(d==""){hideLoadingImage(),setFocusToContainer($("#topicTitle")),enablePostButtons(),showDiscussionMessage(i18n["zohodiscussions.writePost.TopicTitleCannotbeEmptymessage"],"failure"),$("#topicTitle").focus();return}$("#topicTitle").val(d);if(d.length>200){hideLoadingImage(),showDiscussionMessage(i18n["zohodiscussions.writePost.TopicTitleLengthMsg"],"failure"),enablePostButtons();return}var e=$("#forumTags").val();e=e.replace(/^\s+|\s+$/g," ").replace(/\s+/g," ");if(e!=""&&e.match(/^[^\^\"'()~`!@#$%&:;\/\\?|<>{}[\]*-+=]+$/)==null){hideLoadingImage(),showDiscussionMessage(i18n["zohodiscussions.singlepost.specialCharacterNotAllowedMsg"],"failure"),enablePostButtons();return}var f=e.split(",");for(var g=0;g<f.length;g++)if(f[g].length>50){showDiscussionMessage(i18n["zohodiscussions.singlepost.TagexceedMessage"],"failure"),enablePostButtons();return}var h=editor.getContent();h=h.replace(/^\s+/g,"").replace(/\s+$/g,"");var i=editor.doc.body.textContent.trim();editor.mode==="plaintext"&&(i=h.trim(),h=encodeHTML(h),h=h.replace(/\n/g,"<br/>")),$("#postContentTA").val(h.trim());if(i==""){setFocusToContainer($("#editorHolder").focus()),hideLoadingImage(),enablePostButtons(),showDiscussionMessage(i18n["zohodiscussions.writePost.noContentInPost"],"failure");return}a==1?$("#topicStatus").val(1):$("#topicStatus").val(0);var j=$("#SelectForum").val(),k=$("#SelectCategory").val();if(j==null){hideLoadingImage(),isZSupport?showDiscussionMessage(i18n["zohodiscussions.writePost.selectAnyCategoryForZSupport"],"failure"):showDiscussionMessage(i18n["zohodiscussions.writePost.selectAnyForum"],"failure"),enablePostButtons();return}if(k=="0"){hideLoadingImage(),isZSupport?showDiscussionMessage(i18n["zohodiscussions.writePost.selectAnyForumForZSupport"],"failure"):showDiscussionMessage(i18n["zohodiscussions.writePost.selectAnyCategory"],"failure"),enablePostButtons();return}var l="/addForumPost.do";ZUID==-1&&(l="/addGuestForumPost.do"),showLoadingImage(b),doAjaxAction(l,$("#addForumPostForm").serialize(),function(b){hideLoadingImage();var c=toEvaluateData(b);if(c.result=="success"){var d=c.value;if(a==1)showDiscussionMessage(i18n["zohodiscussions.writePost.saveDraftMsg"],"success",3e3),enablePostButtons(),$("#forumTopicId").val(d);else{if(c.isApproved==0){$("#mainContent div.mainFullWrite").html(""),showDiscussionMessage(i18n["zohodiscussions.writePost.topicAwaitingModeration"],"info"),isTopicQuickView=="false"&&!isZSupport?window.location.href=serverURL+"/topic/"+c.topicPermaLink:ZUID==-1?window.location.href="/portalLogin.do?forumGroupUrl="+currentForumGroupURL+"&serviceurl=/":(showLoadingImage(),topiconClickActionNewTopic(j,d,"newtopic",c.topicPermaLink));return}$("#mainContent div.mainFullWrite").html(""),showDiscussionMessage(i18n["zohodiscussions.writePost.publishMsg"],"success",4e3),isTopicQuickView=="false"&&!isZSupport?window.location.href=serverURL+"/topic/"+c.topicPermaLink:(showLoadingImage(),topiconClickActionNewTopic(j,c.value,"newtopic",c.topicPermaLink))}}else showDiscussionMessage(c.reason,"failure"),enablePostButtons()},function(a){hideLoadingImage();if(a.responseText.indexOf("'result':'failure'")>0){var b=toEvaluateData(a.responseText);if(b.result=="failure")if(b.errorcode=="HIP_REQUIRED"){var c=$("#writePostCaptcha");c.attr("currCaptcha")=="new"?showDiscussionMessage(i18n["zohodiscussions.writePost.captchaMsg"],"failure"):showDiscussionMessage(i18n["zohodiscussions.writePost.captchaErrorMsg"],"failure"),c.find('img[purpose="captchaImage"]').replaceWith("<img purpose=captchaImage name=hipImg border=0 src=/showcaptcha?digest="+b.reason+" align=absmiddle alt=HIP image>"),$("#captchaCode").attr("name",b.reason),c.attr("currCaptcha","old"),c.show()}else showDiscussionMessage(b.reason,"failure")}else a.responseText!=""&&($("#writepostCont").get(0).innerHTML=a.responseText);enablePostButtons()})}else $("#submitStat").show()}function singlePostDeleteAction(a,b){var c=a.attr("forumTopicId");c=c||a.parents('li[parentCont="actualParent"]').attr("forumTopicId");var d=a.attr("responseId"),e=a.attr("categoryId");e=e||a.parents('li[parentCont="actualParent"]').attr("categoryId");var f=a.parents('li[parentCont="actualParent"]').attr("responseAuthorId"),g=a.attr("forumId");g=g||a.parents('li[parentCont="actualParent"]').attr("forumId");var h=a.attr("itemType");if(h!="post"){var i={};f==ZUID&&(i.responseowner="true"),i.forumGroupId=forumGroupId,i.forumTopicId=c,i.categoryId=e,i.forumId=g,i.responseId=d,i[csrfParamName]=csrfToken,isEmbedService()?doAjaxAction("/deleteForumResponse.do",i,function(a){if(a=="SUCCESS"){showTipper(i18n["zohodiscussions.generalmessage.responseMovedToTrash"],"info",2e3);if(b=="moderation"){var d=$("#moderationTabCont").find("li.selected").attr("tabPurpose");refreshingPage(d)}else refreshSingleTopic(c);updateAwaitingApprovalCount()}}):b=="topicList"?doAjaxAction("/deleteForumResponse.do",i,function(a){if(a=="SUCCESS"){showTipper(i18n["zohodiscussions.generalmessage.responseMovedToTrash"],"info",2e3);var b=$("#eachTopic_"+c).attr("currTagName");b==" "?getSingleForumTopics($("#forumComboCont")):loadTagRelatedPost(b)}}):slideUpActionInModeration("/deleteForumResponse.do",i,a)}else{var j={};f==ZUID&&(j.access="author"),j.forumGroupId=forumGroupId,j.forumTopicId=c,j.categoryId=e,j.forumId=g,j[csrfParamName]=csrfToken;if(isEmbedService())doAjaxAction("/deleteTopic.do",j,function(a){if(a=="SUCCESS"){showTipper(i18n["zohodiscussions.generalmessage.topicMovedToTrash"],"info",2e3);if(b=="moderation"){var d=$("#moderationTabCont").find("li.selected").attr("tabPurpose");refreshingPage(d)}else refreshSingleTopic(c)}});else if(b=="topicList"){var k=$("#eachTopic_"+c).attr("currTagName");doAjaxAction("/deleteTopic.do",j,function(a){a=="SUCCESS"&&(showTipper(i18n["zohodiscussions.generalmessage.topicMovedToTrash"],"info",2e3),k==" "?getSingleForumTopics($("#forumComboCont")):loadTagRelatedPost(k))})}else slideUpActionInModeration("/deleteTopic.do",j,a)}}function refreshSingleTopic(a){var b=$("#topicList");b.length<1&&(b=$("#topicsList"));var c={};c.forumTopicId=a,c.forumGroupId=forumGroupId,c.singleTopicRefresh="singleTopicRefresh";var d=$("#eachTopic_"+a);doAjaxAction("/refreshSingleTopic.do",c,function(a){hideLoadingImage(),$data=$("<div></div>").html(a);if($data.find("li.singleList").length<1)return d.remove(),!1;var c=$data.find("div.singleTopicCont").attr("modifiedtime"),e=b.find("div.singleTopicCont:last").attr("modifiedtime"),f=b.find("div.singleTopicCont:first"),g=f.attr("modifiedtime"),h=!1;c<e?d.remove():c>g?($data.insertBefore(f),d.remove(),h=!0):($data.insertBefore(d),d.remove(),h=!0),h==1&&goToTop()})}function disablePostButtons(){$("#publishTopic").attr("disabled",!0),$("#saveDraft").attr("disabled",!0),$('button[purpose="publishPreviewLink"]').attr("disabled",!0)}function enablePostButtons(){$("#publishTopic").attr("disabled",!1),$("#saveDraft").attr("disabled",!1),$('button[purpose="publishPreviewLink"]').attr("disabled",!1)}function getprevAndFirstPost(a){var b=a.parents('li[parentCont="actualParent"]').attr("forumTopicId"),c={};c.forumGroupId=forumGroupId,c.forumTopicId=b;var d=a.attr("recentResponseId");if(typeof d!="undefined")c.responseId=d,c.modifiedTime=a.attr("modifiedTime"),c.currResponseCount=a.attr("currResponseCount");else{var e=a.parents("div.listOfResponseLink");c.responseId=e.attr("responseId"),c.modifiedTime=e.attr("modifiedTime"),c.currResponseCount=e.attr("currResponseCount")}c.toProvide="First",c.currStage="1",doAjaxAction("/getResponse.do",c,function(c){var e=$(c),f=$("#recent_ResPonse_"+d);$("#lastResponse_"+b).find('div.listOfResponseLink[prev="-1"]').length<1&&(e.insertAfter(f),lightBox("#"+e.get(0).id),f.next("div.listOfResponseLink").attr("Prev","-1"));var g=$("#navigationLoading_"+d);g.attr("currRequest")=="first"?(g.remove(),f.hide(),$("#navCont_"+d+",#navCont_1_"+d).removeClass("navLoading"),firstOrLastResponse($("#navCont_"+d).find("li.ndtopicNavFirst"))):provideResponse(a);return})}function provideResponse(a){var b=a.parents('li[parentCont="actualParent"]').attr("forumTopicId"),c=a.attr("recentResponseId"),d=a.attr("toProvide"),e={};e.forumGroupId=forumGroupId,e.forumTopicId=b,e.toProvide=d;if(typeof c!="undefined")e.modifiedTime=a.attr("modifiedTime"),e.currResponseCount=a.attr("currResponseCount"),e.currStage=a.attr("currResponsestage");else{var f=a.parents("div.listOfResponseLink");c=f.attr("responseId"),e.modifiedTime=f.attr("modifiedTime"),e.currResponseCount=f.attr("currResponseCount"),e.currStage=f.attr("currResponsestage")}e.responseId=c,doAjaxAction("/getResponse.do",e,function(a){var e=$("#recent_ResPonse_"+c),f=$("<div>"+a+"</div>"),g=f.find("div.listOfResponseLink").attr("responseId"),h=$("#lastResponse_"+b).find('div.listOfResponseLink[responseId = "'+g+'"]');if(h.length>0)d=="Prev"?(e.attr("Prev",g),h.attr("Next",c)):d=="Next"&&(e.attr("Next",g),h.attr("Prev",c));else{var i=$(f.html());if(d=="Prev"){i.insertAfter(e),lightBox("#"+i.get(0).id);var j=e.next("div.listOfResponseLink");j.attr("Next",c),e.attr("Prev",g)}else if(d=="Next"){i.insertBefore(e);var j=e.prev("div.listOfResponseLink");j.attr("Prev",c),e.attr("Next",g)}}var k=$("#navigationLoading_"+c);k.attr("currRequest")=="Prev"?(k.remove(),e.hide(),checkPrevNextResponse($("#navCont_"+c).find("li.ndtopicNavPrev")),$("#navCont_"+c+",#navCont_1_"+c).removeClass("navLoading")):k.attr("currRequest")=="Next"&&(k.remove(),e.hide(),checkPrevNextResponse($("#navCont_"+c).find("li.ndtopicNavNext")),$("#navCont_"+c+",#navCont_1_"+c).removeClass("navLoading"))})}function checkPrevNextResponse(a){var b=a.parents("div.listOfResponseLink"),c=b.attr("responseId"),d=a.attr("toProvide"),e=b.attr(d);if(e=="0"){var f=$("#navigationLoading").clone();f.attr("id","navigationLoading_"+c).attr("currRequest",d);var g=$("#navCont_"+c);f.insertAfter(g).show(),$("#navCont_"+c+",#navCont_1_"+c).addClass("navLoading"),provideResponse(a);return}var h=$("#recent_ResPonse_"+e);b.hide(),h.show(),setFocusToContainer(h.parents(".ndquickList"),!1,0),$("#navCont_"+e).is(".navLoading")&&$("#navCont_"+c+",#navCont_1_"+c).removeClass("navLoading");if(h.attr(d)!="0")return;var i=$("#navCont_"+e).find('li[toProvide="'+d+'"]');provideResponse(i)}function firstOrLastResponse(a){var b=a.parents("div.listOfResponseLink"),c=a.attr("toProvide"),d=b.attr("responseId"),e=a.parents('li[parentCont="actualParent"]').attr("forumTopicId"),f=$("#lastResponse_"+e),g=$("#recent_ResPonse_"+d);if(c=="First"){var h=f.find('div.listOfResponseLink[Prev="-1"]');if(h.length==0){var i=$("#navigationLoading").clone();i.attr("id","navigationLoading_"+d).attr("currRequest","first");var j=$("#navCont_"+d);i.insertAfter(j).show(),$("#navCont_"+d+", #navCont_1_"+d).addClass("navLoading"),getprevAndFirstPost(a);return}g.hide(),h.show(),setFocusToContainer($("#eachTopic_"+e),!1,0),$("#navCont_"+d).is(".navLoading")&&$("#navCont_"+d+",#navCont_1_"+d).removeClass("navLoading");var k=h.attr("responseId");if(h.attr("Next")=="0"){var l=$("#navCont_"+k).find('li[toProvide="Next"]');provideResponse(l)}}else c=="Last"&&(g.hide(),f.find('div.listOfResponseLink[Next="-1"]').show(),setFocusToContainer($("#eachTopic_"+e),!1,0))}function lightBox(a){$(a).find("a.lightbox").lightbox({navbarOnTop:!0,resizeSpeed:150,overlayOpacity:.1,fitToScreen:!0}),$(window.document).keydown(function(a){if(a.keyCode==27)return $("#lightbox").is(":visible")&&($("#lightbox").hide(),$("#overlay").hide()),!1})}function saveButtonClick(a){var b=$("#"+a),c={};c.forumGroupId=forumGroupId,c.referrer=b.attr("referrer"),c.customFieldValue=b.prev().val(),c[csrfParamName]=csrfToken,$.ajax({url:"/joinPortal.do",type:"POST",data:c,error:function(a,b,c){showTipper(a.responseText)},success:function(a){"success"==a?(showTipper(i18n["zohodiscussions.widgetscontainer.subscribedSuccessfully"],"success",1e3),$("#waitingforApproval,#portalWaitingforApproval").show(),$("#joinPortalContent,#portaljoinContent").hide()):"open"==a?window.location.reload():"customSignUp"==a&&(location.href=action)}})}function bindSubscribeAction(){$("#joinThisPortal,#portalJoin").unbind("click").click(function(){var a={};a.forumGroupId=forumGroupId,a.referrer="ajax",a[csrfParamName]=csrfToken;var b=$(this).attr("isCustomFieldStatus"),c="";b=="1"?($("#customFieldDiv,#customFieldWidgetDiv").show(),$("#portalJoin,#joinThisPortal").hide()):$.ajax({url:"/joinPortal.do",type:"POST",data:a,error:function(a,b,c){showTipper(a.responseText,"failure",1e3)},success:function(a){"success"==a?(showTipper(i18n["zohodiscussions.widgetscontainer.subscribedSuccessfully"],"success",1e3),$("#waitingforApproval,#portalWaitingforApproval").show(),$("#joinPortalContent,#portaljoinContent").hide()):"open"==a?window.location.reload():showTipper(i18n["zohodiscussions.widgetscontainer.failure"],"failure",1e3)}})}),$("#joinButtonClick,#portalJoinButtonClick").click(function(){$("#signInorSignUp,#portalsignInorSignUp").toggle(),$("#participateButtonClick,#portalparticipateButtonClick").toggle()}),$("#signInClick,#participateButtonClick").click(function(){"portalBut"==this.className&&$("#portalSignUpClick").attr("action",$(this).attr("action")),$("#iamLoginBox").show(),$("#joinPortalWidget,#portaljoinContent").hide();var a=$(this).attr("src");$("#iamLoginBox iframe,#portaliamLoginBox iframe").attr("src",a)}),$("#signUpClick,#portalSignUpClick,#portalSignUpClickPopup").click(function(){var a=$(this).attr("action");location.href=a})}function showall(a,b){var c=$("#showAll").attr("currentmode");return c=="show"?($("#"+a).removeAttr("style"),$("#showAll").text(i18n["zohodiscussions.general.less"]),$("#showAll").attr("currentmode","hide")):(b=="isCatg"?$("#"+a).attr("style","min-height:40px;max-height:170px;overflow:hidden;"):$("#"+a).attr("style","min-height:40px;max-height:230px;overflow:hidden;"),$("#showAll").text(i18n["zohodiscussions.general.more"]),$("#showAll").attr("currentmode","show")),!1}function topiconClickActionNewTopic(a,b,c,d){return isEmbedService()&&typeof c!="undefined"&&c=="newtopic"?isZIntranet?(ZIntranet.loadTopic(a,b),!1):(isSupportPortalCall?ZSupport.callForumEmbedSinglePost(d):ZSupport.callBackForumPost(a,b),!1):isTopicQuickView?(openSinglePost(b),!1):!0}function topiconClickArrowAction(a,b,c,d){return topiconClickAction(a,b,!c,d),!1}function topiconClickAction(a,b,c,d){return typeof c!="undefined"&&!c?!1:isEmbedService()?(isZIntranet?ZIntranet.loadTopic(a,b):isSupportPortalCall?ZSupport.callForumEmbedSinglePost(d,!0):ZSupport.callBackForumPost(a,b),!1):isTopicQuickView==="true"?!1:!1}function topicHeaderForumDropDownClick(a,b,c,d,e,f){return isEmbedService()?(d===undefined&&(d="-1"),c===undefined&&(c="-1"),forumClickAction(c,d,"1",e,f),!1):a!=="true"?!1:(window.location.href=b,!1)}function topicListHeaderFilterAction(a,b,c,d,e,f,g,h){if(isEmbedService())return e=e.toLowerCase(),forumFilterClickAction(c,d,e,f,1,g,h),!1;if(a!="true")return!1;window.location.href=b}function forumFilterClickAction(a,b,c,d,e,f,g){return f=f===undefined?"":f,g=g===undefined?"":g,isEmbedService()?(isZIntranet?ZIntranet.loadForum(a,c,d):isSupportPortalCall?ZSupport.callForumEmbedSingleForumTopics(f,g,c,d,e,!0):ZSupport.callBackForumFilter(a,b,c,d,e),!1):!1}function forumClickAction(a,b,c,d,e){return b=b==undefined?-1:b,c=c==undefined?1:c,d=d===undefined?"":d,e=e===undefined?"":e,isEmbedService()?(isZIntranet?ZIntranet.loadForum(a):isSupportPortalCall?ZSupport.callForumEmbedSingleForumTopics(d,e,"","",c,!0):ZSupport.callBackForumView(a,b,c),!1):!1}function initTopicsPageActions(){lightBox("#chartWidget"),lightBox("#topicList"),bindTopicClicks($("#topicList")),bindTopicClicks($("#topicsList")),bindTopicListHeaderClicks($("#topicListHeader")),bindWidgetsContClick($("#topicListWidgetsCont")),setToHotkeys()}function newTopicCall(){initLoginFrame($("#NewTopicTab"))}function initLoginFrame(a){var b=$("#loginFrame");hideLoadingImage();var c=a.attr("iamURL");b.size()>0&&(b.show().find("div.iFrameContainer").show().html('<iframe scrolling="no" frameborder="0" height="192px" src="'+c+'"></iframe>'),$("#iamLoginBox").hide());var d=$("#listof_FC_Counts");$("#countOfForum").html(d.attr("forumCount")),$("#countOfCategory").html(d.attr("categoryCount")),$("#countOfPosts").html(d.attr("postCount")),$("#countOfResponses").html(d.attr("responseCount"));var e=$("#tploginforms"),f=a.attr("loginURL"),g=a.attr("iamURL");return e.find('input[name="serviceurl"]').val(f),e.find('input[name="domain"]').val(g),!1}function loginBoxClose(){$("#iamLoginBox").show(),$("#joinPortalWidget").size()>0&&($("#joinPortalWidget").show(),$("#iamLoginBox").hide()),$("#loginFrame").hide(),initTopicsPageActions()}function signInViaGoogle(){return $("#tploginforms").find('form[name="googleform"]').submit(),!1}function signInViaYahoo(){return $("#tploginforms").find('form[name="yahooform"]').submit(),!1}function signInViaFacebook(){return $("#tploginforms").find('form[name="fbform"]').submit(),!1}function signInViaGoogleApps(){return $("#tploginforms").find('form[name="gappsform"]').submit(),!1}function forumGroupNameDecode(a){var b=a.split("&#39;").length-1;for(var c=0;c<b;c++)a=a.replace("&#39;","/'");return a}function attachDocsIntegCallBackFn(a){a=a.replace(/\%20/g," ");if(typeof a!="undefined"){var b=a.split("&");if(b.length<3)return;var c=b[0].split("docIds="),d=b[1].split("docNames="),e=b[2].split("service="),f=c[1].split(","),g=d[1].split(","),h=e[1].split(","),i=f.length,j="false",k="",l="";for(var m=0;m<f.length;m++){var n=f[m],o=g[m],p=h[m];o.indexOf(".")<0&&("show"==p?o+=".ppt":"sheet"==p?o+=".xls":"writer"==p&&(o+=".doc")),k=k+l+n+","+p+","+o+","+j,l=":"}loadUploadAttachmentsCont(k,"attachZDocs")}}function zohoSupportSearch(a,b,c,d){if(a==undefined||a.trim()==""){showMessage(i18n["zohodiscussions.searchList.noSearchString"],"failure"),hideLoadingImage();return}var e={};e.forumGroupId=b,c!=undefined&&c!=""&&(e.forumId=c),d!=undefined&&d!=""&&(e.categoryId=d),e.searchFor=a,doAjaxAction("/getSearchResult.do",e,function(b){hideLoadingImage();var c=$("<div></div>");c.get(0).innerHTML=b,$("#mainContent").get(0).innerHTML=b,bindSearchContentClick($("#mainContent")),showAuthorPopout(c),$("#searchInputBox").val(a)},function(a){hideLoadingImage();var b=toEvaluateData(a.responseText);b.errorcode==="REMOTE_IP_LOCKED"&&showMessage(i18n["zohodiscussions.generalmessage.tryagainaftersometime"],"failure")})}function UpdateCursorPosition(a){cX=a.pageX,cY=a.pageY}function UpdateCursorPositionDocAll(a){cX=event.clientX,cY=event.clientY}function HideTags(a){if(a.length<1)return;document.getElementById(a).style.display="none"}function tagOnLoad(a){var b=0,c=0,d=0,e=0;document.all?document.onmousemove=UpdateCursorPositionDocAll:document.onmousemove=UpdateCursorPosition,showDiscussionsManageTags(a)}function showDiscussionsManageTags(a){if(a.length<1)return;var b=document.getElementById(a);AssignPosition(b),b.style.display="block"}function AssignPosition(a){self.pageYOffset?(rX=self.pageXOffset,rY=self.pageYOffset):document.documentElement&&document.documentElement.scrollTop?(rX=document.documentElement.scrollLeft,rY=document.documentElement.scrollTop):document.body&&(rX=document.body.scrollLeft,rY=document.body.scrollTop),document.all&&(cX+=rX,cY+=rY),a.style.left=cX+10+"px",a.style.top=cY+10+"px"}function getUsersStartingWith(a){var b=1;discussionsFunctions.users("Users",b,a)}function updateUserScreenName(a){var b=$(a),c={};c.forumGroupId=forumGroupId,c.zuid=b.find(':input[name="zuid"]').val();var d=$.trim(b.find(':input[name="screenName"]').val()),e="";if(d===""||d===null){e="zohodiscussions.myArea.screenNameEmpty",displayScreenMessage(a,e);return}if(!d.match("^[^-!$%^&*()@+\\\\|#~=`{}\\[\\]:\";'<>?,\\/]{4,50}$")){e="zohodiscussions.myArea.screenNameValid",displayScreenMessage(a,e,"failure");return}b.find(':input[name="update"]').attr("disabled","true"),b.find(':input[name="update"]').attr("value",i18n["zohodiscussions.myArea.screenName.Update"]),c.screenName=d,c[csrfParamName]=csrfToken,doAjaxAction("/updateScreenName.do",c,function(c){var d=toEvaluateData(c);e=d.reason,displayScreenMessage(a,e,d.result),d.result==="success"&&location.reload(),b.find(':input[name="update"]').removeAttr("disabled"),b.find(':input[name="update"]').attr("value",i18n["zohodiscussions.buttons.save"]);return},function(c){var d=toEvaluateData(c.responseText),e=d.reason;d.errorcode==="REMOTE_IP_LOCKED"?e="zohodiscussions.generalmessage.tryagainaftersometime":d.errorcode==="PATTERN_NOT_MATCHED"?e="zohodiscussions.myArea.screenNameValid":b.find(':input[name="update"]').removeAttr("disabled"),b.find(':input[name="update"]').attr("value",i18n["zohodiscussions.buttons.save"]),displayScreenMessage(a,e)})}function checkScreenNameAvailablity(a){var b=$(a),c={};c.forumGroupId=forumGroupId,c.zuid=b.find(':input[name="zuid"]').val();var d=$.trim(b.find(':input[name="screenName"]').val()),e="";if(d===""||d===null){e="zohodiscussions.myArea.screenNameEmpty",displayScreenMessage(a,e,"failure");return}if(!d.match("^[^-!$%^&*()@+\\\\|#~=`{}\\[\\]:\";'<>?,\\/]{4,50}$")){e="zohodiscussions.myArea.screenNameValid",displayScreenMessage(a,e,"failure");return}c.screenName=d,c[csrfParamName]=csrfToken,doAjaxAction("/screenNameAvailablity.do",c,function(b){var c=toEvaluateData(b);e=c.reason,displayScreenMessage(a,e,c.result);return},function(c){b.find(':input[name="update"]').removeAttr("disabled"),b.find(':input[name="update"]').attr("value",i18n["zohodiscussions.buttons.save"]);var d=toEvaluateData(c.responseText),e=d.reason;d.errorcode==="REMOTE_IP_LOCKED"?e="zohodiscussions.generalmessage.tryagainaftersometime":d.errorcode==="PATTERN_NOT_MATCHED"&&(e="zohodiscussions.myArea.screenNameValid"),displayScreenMessage(a,e)})}function displayScreenMessage(a,b,c){var d=$(a),e,f;b=i18n[b],e=d.find('span[purpose="showMsg"]'),c!=="success"?(c="failure",e.removeClass("screenGreenMarkText").addClass("redMarText")):e.removeClass("redMarText").addClass("screenGreenMarkText"),f=d.find("a.greenLink"),f.hide(),e.show(),e.text(b);return}function gettingstarted(a,b,c,d,e){var f={};f.pageNum=a,f.loaded=b,f.isSkipped=c,f.forumGroupId=d,typeof e!="undefined"?f.serviceurl=e:f.serviceurl=serverURL,doAjaxAction("/gettingStarted.do",$.param(f,!0),function(a){$(".topWhiteBorder").width("95%"),$(".topWhiteBorder").html(a),gettingstartedSteps()})}function openSinglePost(a,b,c){b=b||"Topic",c!=undefined?loadSinglePost(a,"true",undefined,c):loadSinglePost(a),!isZIntranet&&!isZSupport&&$.history.add(b+"/"+a)}function loadSinglePost(a,b,c,d,e){if(isNaN(a)){var f={};f.requestedUrlPurpose="pageAccess",doAjaxAction("/errorInfo.do",f,function(a){$("body").get(0).innerHTML=a,document.title="Requested url not found"});return}var g={};g.forumTopicId=a,g.forumGroupId=forumGroupId,e=="spamReported"&&(g.isSpamReported=!0),typeof b=="undefined"&&(b=!0),isThreadSorting&&(g.sortThreads=$("#SinglePostContainer").attr("sortThread")),doAjaxAction("/getSinglePost.do",g,function(e){hideLoadingImage();if(e.indexOf('"result":"failure"')==1){var f={};f.requestedUrlPurpose="pageAccess",doAjaxAction("/errorInfo.do",f,function(a){$("body").get(0).innerHTML=a,document.title="Requested url not found";return})}else if(e.indexOf('"result":"portalLogin"')==1){var g=$.parseJSON(e);window.location.href="/portalLogin.do?forumGroupUrl="+g.sURL+"&serviceurl=/"+g.sURL;return}if($("#topicListMainContainer").length>0||$("#userProfileMainContainer").length>0||$("#myAreaParentContainer").length>0){$("#topicListMainContainer").hide().attr("shouldReload","false"),$("#userProfileMainContainer").hide().attr("shouldReload","false"),$("#myAreaParentContainer").hide().attr("shouldReload","false");if($("#SinglePostContainer").length>0)$("#mainContent").get(0).innerHTML=e,$(window).scrollTop(0);else{var h=document.createElement("div");h.innerHTML=e,$("#mainContent").get(0).appendChild(h)}}else $("#mainContent").get(0).innerHTML=e;b&&b==1?$(window).scrollTop(0):b&&b=="showWatchOption"&&$("#followTopic_"+d).show();if(typeof c!="undefined"){var i=$(c).offset().top;$("html,body").scrollTop(i-100)}initSinglePost(a);var j=$("#topicContainer_"+a),k=j.attr("forumId"),l=j.attr("categoryId");typeof k=="undefined"&&(k=-1),typeof l=="undefined"&&(l=-1);var m="NewTopic/"+k+"/"+l;$("#NewTopicTab").attr("hashPurpose",m);if(typeof WmsContacts!="undefined"&&ch=="true"){var n=WmsContacts.getZohoContacts();setPresenceInTopicList(n,a)}d!=undefined&&typeof c=="undefined"&&(setFocusToContainer($("#fullResponseContainer_"+d),!1,100,0),$("#SinglePostContainer").data("currentFocusResponse",$("#"+d))),isMac=="false"&&setHotkeysToSinglePost()},function(a){hideLoadingImage();var b=a.responseText;$("#mainContent").get(0).innerHTML=b})}function initSinglePost(a){showAuthorPopout($("#SinglePostContainer")),forumGroupName=forumGroupNameDecode(forumGroupName);var b=$("#DocumentTitle");if(isZIntranet&&isThreadSorting){var c="<style>.discussionsimgDownArrow{background:url('"+zohoStaticUrl+"/images/singlepostSprite.png')  -7px -3px no-repeat;width:8px;height:10px;cursor:pointer;margin:4px 2px 0 0;transform: rotate(180deg);-ms-transform: rotate(180deg);-webkit-transform: rotate(180deg);-o-transform: rotate(180deg);-moz-transform: rotate(180deg);}</style>";jQuery("head").append(c)}isEmbedService()||(document.title=b.length>0?b.text()+" - "+forumGroupName:forumGroupName),bindSingleTopicClicks($("#SinglePostContainer")),lightBox("#SinglePostContainer");var d=$("#topicContainer_"+a);return $("#SinglePostContainer").unbind("click",singlePostWidgetActions).click(singlePostWidgetActions),singlePostTagActions(a),$("#mainContent").attr("process-pre-tags",a),setTimeout(function(){processCodeTags($("#SinglePostContainer"),a)},5),!1}function showCode(a){var b=a.parentNode.nextSibling.innerHTML;b=b.replace(/<\/li>/ig,"\n").replace(/<[^>]*>/ig,"").replace(/&nbsp;/ig," ").replace(/&lt;/ig,"<").replace(/&gt;/ig,">").replace(/&amp;/ig,"&"),$("#CopyCodeCont").show().parent().show(),$("#copycode_text").val(b).select()}function processCodeTags(a,b){if(!b||!a||a.length<1)return;var c=$("#mainContent"),d=c.attr("process-pre-tags");if(d!=b)return;var e=a.find("ol.code");e.before(codeForPreview);var f=$("#mainContent #showCopyCode");for(var g=0;g<f.length;g++){var h=f[g].parentNode.nextSibling.innerHTML;h==""&&(f[g].parentNode.previousElementSibling.remove(),f[g].parentNode.remove())}}function bindSingleTopicClicks(a){a.unbind("click",processSingleTopicClicks).click(processSingleTopicClicks);var b=$("#SinglePostContainer").attr("forumTopicId"),c=$("#replyToTopicBtn_"+b),d=c.attr("replyContainer"),e=c.attr("canUserReplyThis");e=="true"&&d=="true"&&$("#replyToTopicBtn_"+b).find("div.imgReply").trigger("click")}function processSingleTopicClicks(a){var b=$(a.target),c=b.parent(),d="singlePost",e=$("#SinglePostContainer").attr("forumTopicId"),f=$("#topicContainer_"+e),g=$("#zdstatusList");if(b.attr("purpose")==="threadSorting"){if(b.attr("style")==="")return!1;var h={},i=b.attr("sortingOrder");h.forumGroupId=forumGroupId,h.forumTopicId=e,h.sortThreads=i,$("#SinglePostContainer").attr("sortThread",i),doAjaxAction("/getSortedThread.do",h,function(a){loadNewPost("/getSortedThread.do",a,e)})}if($("#loadingImg").is(":visible"))return;if(b.is('a[id="attachmentViewPermission"]')&&ZUID==-1){var j=b.attr("iamURL");$("#loginFrame").show().find("div.iFrameContainer").show().html('<iframe scrolling="no" frameborder="0" height="192px" src="'+j+'"></iframe>')}if(b.is('a[purpose="authorProfile"]')){var k=b.attr("authorName"),l=b.attr("singleClickflag");if(l=="0"){var m=k==screenName||k==encodedScreenName?"MyArea":"User/"+k;processHash(m)}return}if(b.is("#replyToTopicBtn_"+e+",#replyToTopicBtnSec_"+e)||c.is("#privateResponseThisTopic_"+e)){var n=b.attr("postauthor"),o=$("#paginationContainer"),p=b.attr("canUserReplyThis"),q=b.attr("replyContainer");if(p!="undefined"&&p=="false"){initLoginFrame(b,q);return}$("#topicListMainContainer").length>0&&$("#SinglePostContainer").length>0&&o.data("inEditMode")&&removeTopicListCache();if($("#responsePreviewContainer").is(":visible")){$("#responsePreviewContainer").find('button[purpose="backToEditorResponse"]').trigger("click"),showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info");var r=f.data("editorContLocation");setFocusToContainer($(r),!1);return}var s="replyToTopicBtn",t="false";c.is('[purpose="privateResponse"]')&&(s="privateResponseThisTopic",t="true");var u="#newResponseCont_"+e;if(f.data("inEditMode")){showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"]),$("#responsePreviewButton").find('button[purpose="backToEditorResponse"]').trigger("click");var r=f.data("editorContLocation");return setFocusToContainer($(r),!1),!1}return $(u).show(),newOpenEditor($("#newResponse_"+e),"responseContent","postContentTA",s+"_"+e,"Write","topicContainer_"+e,t),setFocusToContainer($(u),!1),f.data("inEditMode",!0),f.data("editorContLocation",u),$("#previewResponse").attr("forumTopicId",e),$(this).is('[purpose="privateResponse"]')&&$("#newResponseCont_"+e).find("div.header").html(i18n["zohodiscussions.singlePost.editorHeaderPrivateResponseTo"]+" "+n+""),!1}if(b.is("#TopicListLink,#ForumTopicListLink,#CategoryTopicListLink,#singlePostForumLink")){v=b,hashPurpose=v.attr("hashPurpose"),$("#topicListMainContainer").attr("shouldReload","true");if(hashPurpose!=undefined)return processHash(hashPurpose),!1}else if(b.is("#topicVoteLink")||c.is("#topicVoteLink")){var v=b.is("#topicVoteLink")?b:c,w=$("#topicVoteLink").attr("firstResponseId");if(ZUID==-1){showTipper(i18n["zohodiscussions.singlepost.logintovotetopic"],"failure");return}var x=v.attr("isThisUserVoted");if(x=="true"){showTipper(i18n["zohodiscussions.singlepost.alreadyVotedTopic"],"failure");return}showLoadingImage(i18n["zohodiscussions.general.updating"]),doAjaxAction("/voteTopic.do?forumGroupId="+forumGroupId+"&forumTopicId="+e+"&responseId="+w,csrfOptions,function(a){if(a=="SUCCESS"){showTipper(i18n["zohodiscussions.singlepost.votedresponse"],"success"),removeTopicListCache();var b=parseInt($("#topicVoteLink").attr("responseVoteCount"))+1,c=$("#topicVoteLink").attr("votemessage");c=c.substring(1,c.length),$("#topicVoteLink").attr("title",b+" "+c),$("#topicVoteLink > span").length>0?$("#topicVoteLink > span").html(b):$("#topicVoteLink").append("<span class='flLeft'>"+b+"</span>"),hideLoadingImage()}else hideLoadingImage(),showTipper(i18n["zohodiscussions.singlepost.alreadyVotedTopic"],"failure")})}else if(b.is("input[followItem]")){var y=b.attr("followItem");y=="true"&&watchThisItem(b,"singlePost",a)}else{if(c.is("#topicPermalink")){var z=c.attr("thisTopicPermalink");$("#PermalinkCont textarea").val(z),$("#permalink_Text").select(),$("#PermalinkCont").show().parent().show();return}if(c.is("#linkToTopic"))linkToTopic();else if(b.is("#deleteLinkedTopic"))deletelinkedTopic(b);else if(b.is('a[purpose="linkedTopicTitle"]')){if(isTopicQuickView!="false"){var e=b.attr("forumTopicId");return processHash("Topic/"+e),!1}}else{if(b.is('input[purpose="watchAction"]')){var A=$("#editorHolder").find('input[name="isFollowTopic"]');b.is(":checked")||b.attr("checked")==1||b.attr("checked")=="true"?A.attr("value","true"):A.attr("value","false");return}if(c.is("#emailThisTopic"))return openEmailTopicDialog(c),!1;if(c.is('li[actionPurpose="reportSpam"],div[actionPurpose="reportSpam"]')||b.is('a[actionPurpose="reportSpam"]')){var B=b.is('a[actionPurpose="reportSpam"]')?b:c;singlePostSpamAction(B,d);return}if(c.is('div[buttonPurpose="approve"]')||c.is('li[buttonPurpose="approve"]')||b.is('a[buttonPurpose="approve"]')){var B=b.is('a[buttonPurpose="approve"]')?b:c;singlePostApproveAction(B,"singlePostApprove");return}if(b.is('div[purpose="inappropriateReason"]')||b.is('span[purpose="inappropriateReason"]'))getReasonForInapppropriate(b);else{if(c.is('span[deletepurpose="deleteAttachment"]')){deletePublishedAttachment(c,a);return}if(b.is('li[purpose="topicLabel"]'))changeTopicLabel(b);else{var C=f.attr("topicAuthorId"),D=f.attr("forumId"),E=f.attr("categoryId"),F=$("#singlePostUtilCont"),G=F.attr("newThreadReplyLinks");if(b.is(G)){var v=b,e=v.attr("forumTopicId"),H=v.attr("responseId"),I=v.attr("isPrivate"),J="#newThreadResponseCont_"+H,o=$("#paginationContainer");$("#topicListMainContainer").length>0&&$("#SinglePostContainer").length>0&&o.data("inEditMode")&&removeTopicListCache();if($("#responsePreviewContainer").is(":visible")){$("#responsePreviewContainer").find('button[purpose="backToEditorResponse"]').trigger("click"),showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info");var r=f.data("editorContLocation");setFocusToContainer($(r),!1);return}if(f.data("inEditMode")){showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info"),$("#responsePreviewButton").find('button[purpose="backToEditorResponse"]').trigger("click");var r=f.data("editorContLocation");return setFocusToContainer($(r),!1),!1}return $(J).show(),newOpenEditor($("#newThreadResponse_"+H),"responseContent","postContentTA","newThreadReply_"+H,"Write","topicContainer_"+e,I),setFocusToContainer($(J),!1),f.data("inEditMode",!0),f.data("editorContLocation",J),$("#previewResponse").attr("forumTopicId",e),$("#previewResponse").attr("responseId",H),!1}var K=F.attr("responseVoteLinks");if(b.is(K)){var v=b,H=v.attr("responseId"),L=v.attr("votePurpose");if(L=="removeVote"){showTipper(i18n["zohodiscussions.singlepost.alreadyVotedResponse"],"failure");return}showLoadingImage(i18n["zohodiscussions.general.updating"]);var M=L=="removeVote"?"/removeResponseVote.do":"/voteResponse.do";doAjaxAction(M+"?forumGroupId="+forumGroupId+"&responseId="+H+"&forumTopicId="+e,csrfOptions,function(a){if(a=="SUCCESS"){showTipper(i18n["zohodiscussions.singlepost.votedresponse"],"success"),removeTopicListCache();var b=parseInt($("#resposeVoteLink_"+H).attr("responseVoteCount"))+1,c=$("#postActions_"+H+" > .commentLikeButtion").attr("votemessage");c=c.substring(2,c.length),$("#postActions_"+H+" > .commentLikeButtion").attr("title",b+" "+c),$("#postActions_"+H+" > .commentLikeButtion > span").html(b),$("#resposeVoteLink_"+H).attr("votePurpose","removeVote")}else hideLoadingImage()});return}var N=F.attr("chooseBestResponseLinks");if(b.is(N)){showLoadingImage(i18n["zohodiscussions.general.updating"]);var v=b,H=v.attr("responseId"),h={};h.forumGroupId=forumGroupId,h.responseId=H,h.forumTopicId=e,C==ZUID&&(h.topicowner="true"),h[csrfParamName]=csrfToken,isThreadSorting&&(h.sortThreads=$("#SinglePostContainer").attr("sortThread")),doAjaxAction("/bestResponse.do",h,function(a){removeTopicListCache(),showTipper(i18n["zohodiscussions.singlepost.bestResponseSuccessMsg"],"success"),loadNewPost("/bestResponse.do",a,e),h={},h.forumGroupId=forumGroupId,h.forumTopicId=e,h[csrfParamName]=csrfToken,doAjaxAction("/notifyForBestResponse.do",h,function(){})},function(a){hideLoadingImage(),showMessage(i18n["zohodiscussions.generalmessage.noPermission"])});return}var O=F.attr("responseEditLinks");if(b.is(O)){var P=b.attr("id"),v=b,H=v.attr("responseId"),I=v.attr("isPrivate"),Q="#fullResponseContainer_"+H,o=$("#paginationContainer");$("#topicListMainContainer").length>0&&$("#SinglePostContainer").length>0&&o.data("inEditMode")&&removeTopicListCache();if($("#responsePreviewContainer").is(":visible")){$("#responsePreviewContainer").find('button[purpose="backToEditorResponse"]').trigger("click"),showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info");var r=f.data("editorContLocation");setFocusToContainer($(r),!1);return}if(f.data("inEditMode")){showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info");var r=f.data("editorContLocation");return $("#responsePreviewButton").find('button[purpose="backToEditorResponse"]').trigger("click"),setFocusToContainer($(r),!1),!1}return $(Q).show(),P=="editTopic"&&($("#linkTopicCont_"+e).hide(),$("#zdstatusContainer").hide()),newOpenEditor($("#responseContentContainer_"+H),"responseContent","postContentTA",P,"Edit","topicContainer_"+e,I),setFocusToContainer($(Q),!1),f.data("inEditMode",!0),f.data("editorContLocation",Q),$("#previewResponse").attr("responseId",H),$(Q).attr("class")=="postContent"||P=="editTopic"?$("#previewResponse").attr("location","editTopic"):$("#previewResponse").attr("location","editResponse"),$("#previewResponse").attr("forumTopicId",e),!1}if(b.is("#removeBestResponse")){showLoadingImage(i18n["zohodiscussions.general.updating"]);var h={};h.forumGroupId=forumGroupId,h.forumTopicId=e,C==ZUID&&(h.topicowner="true"),h[csrfParamName]=csrfToken,isThreadSorting&&(h.sortThreads=$("#SinglePostContainer").attr("sortThread")),doAjaxAction("/removeBestResponse.do",h,function(a){removeTopicListCache(),showTipper(i18n["zohodiscussions.singlePost.removeBestResponseMsg"],"info"),loadNewPost("/removeBestResponse.do",a,e)},function(a){hideLoadingImage(),showMessage(i18n["zohodiscussions.generalmessage.noPermission"])});return}if(b.is("#deleteTopic")){showLoadingImage(i18n["zohodiscussions.general.deleting"]);var R={};C==ZUID&&(R.access="author"),R.forumGroupId=forumGroupId,R.forumTopicId=e,R.categoryId=E,R.forumId=D,R[csrfParamName]=csrfToken,doAjaxAction("/deleteTopic.do",R,function(a){jQuery.trim(a)=="SUCCESS"&&(removeTopicListCache(),showTipper(i18n["zohodiscussions.generalmessage.topicMovedToTrash"],"info"),isEmbedService()?forumClickAction(D):processHash("Home"))},function(a){});return}var S=F.attr("responseDeleteLinks");if(b.is(S)){showLoadingImage(i18n["zohodiscussions.general.deleting"]);var v=b,H=v.attr("responseId"),T=v.attr("responseAuthorId"),U={};return T==ZUID&&(U.responseowner="true"),U.forumGroupId=forumGroupId,U.forumTopicId=e,U.categoryId=E,U.forumId=D,U.responseId=H,U[csrfParamName]=csrfToken,$("#fullResponseContainer_"+H).hide(),hideLoadingImage(),doAjaxAction("/deleteForumResponse.do",U,function(a){a=="SUCCESS"&&(removeTopicListCache(),showTipper(i18n["zohodiscussions.generalmessage.responseMovedToTrash"],"info"),loadSinglePost(e,"true",undefined,undefined,"spamReported"))},function(a){}),!1}}}}}g.hover(function(){var a=g.data("destroyHandle");a&&clearTimeout(a)},function(){var a=setTimeout(function(){g.hide()},500);g.data("destroyHandle",a)})}function getReasonForInapppropriate(a){if(moderatorForSpam!="true")return;showLoadingImage();var b=a.attr("responseId"),c={};c.forumGroupId=forumGroupId,c.responseId=b,c[csrfParamName]=csrfToken,doAjaxAction("/getInappropriateReason.do",c,function(a){hideLoadingImage();var b=$("<div></div>").html(a);b.is("#noInappropriateReason")&&showMessage(i18n["zohodiscussions.inappropriate.NoReasonForInappropriate"],"failure");var c=$("#inappropriateReason");c.html(a).show(),$("#inappropriateReasonClose").click(function(){c.html("").hide()})})}function linkToTopic(){$("#linkToTopicTemplate").html($("#dimDivLinkTO").html()),$("#dimDivLinkTO").html(""),$("#linkToTopicTemplate").show(),$("#linkTopicUrl").focus(),$("#cancelLinkTo").click(function(){$this=$(this),$("#dimDivLinkTO").html($("#linkToTopicTemplate").html()),$("#linkToTopicTemplate").hide(),$("#linkToTopicTemplate").html("")}),$("#saveLinkToTopic").click(function(){showLoadingImage(i18n["zohodiscussions.general.deleting"]),$this=$(this);var a=$this.attr("currentTopicId"),b="^(ht|f)tp(s?)://[0-9a-zA-Z]([-.w]*[0-9a-zA-Z])*(:(0-9)*)*(/?)([a-zA-Z0-9-.?,:'/\\+=&amp;%$#_]*)?$",c="#Topic/",d="?ftid=",e="/topic/",f=$("#linkTopicUrl").val();if(jQuery.trim(f)==""){showMessage(i18n["zohodiscussions.createforumgroup.LinkEmpty"],"failure");return}f=$.trim(f);if(f.match(b))if(f.indexOf(c)>-1||f.indexOf(d)>-1||f.indexOf(e)){var g={};g.forumGroupId=forumGroupId,g.currentTopicId=a,g.forumTopicId=a,g.linkToTopicUrl=f,g[csrfParamName]=csrfToken,isThreadSorting&&(g.sortThreads=$("#SinglePostContainer").attr("sortThread")),doAjaxAction("/addLinkToTopic.do",g,function(b){if(b.indexOf("'result':'failure'")>0){var c=toEvaluateData(b).reason;showTipper(i18n[c],"failure")}else b==="FAILURE"||b===""?showTipper(i18n["zohodiscussions.singlePost.requestedURLnotfoundMessage"],"failure"):(removeTopicListCache(),loadNewPost("/addLinkToTopic.do",b,a),showTipper(i18n["zohodiscussions.singlepost.topicLinkedSuccessMessage"],"success"),$("#linkToTopicTemplate").hide())})}else showTipper(i18n["zohodiscussions.settings.PleaseEnteraValidurl"],"failure");else showTipper(i18n["zohodiscussions.settings.PleaseEnteraValidurl"],"failure")})}function deletelinkedTopic(a){var b=a.attr("currentTopicId"),c=a.attr("linkedTopicId"),d=a.attr("location"),e={};e.forumGroupId=forumGroupId,e.forumTopicId=b,e.linkedTopicId=c,e[csrfParamName]=csrfToken,isThreadSorting&&(e.sortThreads=$("#SinglePostContainer").attr("sortThread")),confirm(i18n["zohodiscussions.singlepost.removeLinkConfirmationMess"])&&doAjaxAction("/deleteLinkedTopic.do",e,function(a){removeTopicListCache(),showTipper(i18n["zohodiscussions.singlePost.deleteLinkedTopicMessage"],"success"),d=="topicList"?getForumTopics(-1,-1,1,"Home"):d=="singlepost"&&loadNewPost("/deleteLinkedTopic.do",a,b)},function(a){showTipper(i18n["zohodiscussions.generalmessage.errorOccured"],"failure")})}function deletePublishedAttachment(a,b){if(confirm(i18n["zohodiscussions.generalmessage.deleteAttachmentConfirmMsg"])){showLoadingImage(i18n["zohodiscussions.general.deleting"]),$this=a;var c=$this.attr("attachmentId"),d=$this.attr("forumTopicId"),e=$this.attr("responseId"),f=typeof e!="undefined"?e:d,g=$("#fullResponseContainer_"+e).find(".spattachmentList").attr("totalAttachment"),h={};h.forumGroupId=forumGroupId,h.forumTopicId=d,h.responseId=e,h.fileName=$this.attr("attachmentName"),h.fileId=c,h.access="author",h[csrfParamName]=csrfToken,hideLoadingImage(),doAjaxAction("/deleteAttachment.do",h,function(a){a=="SUCCESS"&&(showTipper(i18n["zohodiscussions.general.Deleted"],"info"),$("#SinglePostContainer").length>0?(hideLoadingImage(),showLoadingImage(),removeTopicListCache(),g>1?($("#discussionsAttachment_"+c).remove(),$("#fullResponseContainer_"+e).find(".spattachmentList").attr("totalAttachment",g-1)):$("#fullResponseContainer_"+e).find(".attachments").remove()):$("#topicList").length>0||$("#topicsList").length>0?($("#topicListMainContainer").attr("shouldReload","true"),$("#currentCategoryContext").length>0?$("#currentCategoryContext").trigger("click"):$("#currentForumContext").trigger("click")):$("#topicContent_"+f).length>0&&($("#topicContent_"+f).find("li[attachmentId ="+c+"]").remove(),$("#topicContent_"+f).find("li.singleList").length==0&&$("#topicContent_"+f).find("div.Attachments").remove()))})}}function openEmailTopicDialog(a){var b=a,c=b.attr("topicTitle"),d=b.attr("forumTopicId");d=d||b.parents('div[parentCont="actualParent"]').attr("forumTopicId");var e=e,f=$("#emailTopicPrompt");return f.find(':input[name="Subject"]').val(c),f.find(':input[name="forumTopicId"]').val(d),f.find(':input[name="topicTitle"]').val(c),f.find(':input[name="emailIds"]'),f.show().parent().show(),f.find(':input[name="emailIds"]').focus(),!1}function emailTopic(a){var b=$(a.target);b.html(i18n["zohodiscussions.singlePost.sending"]);var c=$("#emailTopicPrompt");return discussionsValidate(c.find("form"))==1?(doAjaxAction("/eMailTopic.do",c.find("form").serialize(),function(a){if(a=="SUCCESS")showTipper(i18n["zohodiscussions.singlepost.mailsentmessage"],"success"),b.html(i18n["zohodiscussions.general.send"]),cancelEmailTopic();else if(a==="FAILURE")showTipper(i18n["zohodiscussions.generalmessage.errorOccured"]);else if(a.indexOf("'result':'failure'")>0){var c=toEvaluateData(a);showTipper(c.reason,"failure"),b.html(i18n["zohodiscussions.general.send"])}},function(a){if(a.responseText.indexOf("'result':'failure'")>0){var c=toEvaluateData(a.responseText);showTipper(c.reason,"failure"),b.html(i18n["zohodiscussions.general.send"])}else showTipper(i18n["zohodiscussions.errorpage.requestedURLisnotfoundMess"],"failure",1e3)}),!1):(b.html(i18n["zohodiscussions.general.send"]),!1)}function cancelEmailTopic(){var a=$("#emailTopicPrompt");return a.hide().parent().hide(),a.find(':input[name="emailIds"]').val(""),a.find(':input[name="Subject"]').val(""),$("#emailContentArea").val(""),!1}function singlePostApproveAction(a){showLoadingImage(i18n["zohodiscussions.general.publishing"]);var b=a.attr("action"),c=a.attr("forumTopicId"),d=a.attr("forumId"),e=a.attr("categoryId"),f=a.attr("itemType"),g={};g.forumGroupId=forumGroupId,g.forumTopicId=c,g.forumId=d,g.categoryId=e,g.authorId=a.attr("authorId"),g[csrfParamName]=csrfToken;if(f=="response"){var h=a.attr("responseId");g.responseId=h}a.hide(),$("div.approveButton").hide(),hideLoadingImage(),doAjaxAction(b,g,function(a){a=="SUCCESS"&&(removeTopicListCache(),updateAwaitingApprovalCount())})}function singlePostSpamAction(a,b){var c=a.attr("postType");c==="topic"?c=i18n["zohodiscussions.moderationList.topic"]:c==="response"&&(c=i18n["zohodiscussions.moderationList.response"]);var d=a.attr("spamValue"),e="";moderatorForSpam=="true"?(d==1?e=i18n["zohodiscussions.singlepost.spamActionconfirmationmessage1"]+" "+c+" "+i18n["zohodiscussions.singlepost.inappropriateActionconfirmationmessage2"]:e=i18n["zohodiscussions.singlepost.spamActionconfirmationmessage3"]+" "+c+" "+i18n["zohodiscussions.singlepost.appropriateActionconfirmationmessage2"],confirm(e)&&spamAction(a,c,b)):d==1?($("#spamStatusMsg").show(),$("#spamDetails_Text").val(""),$("#spamContentDetails").unbind("click").click(function(){var d=$("#spamDetails_Text").val();d=$.trim(d);if(d==""){showMessage(i18n["zohodiscussions.singlePost.EmptyMsgError"],"failure");return}spamAction(a,c,b,"appropriate",d)})):confirm(i18n["zohodiscussions.singlepost.spamActionconfirmationmessage3"]+" "+c+" "+i18n["zohodiscussions.singlepost.appropriateActionconfirmationmessage2"])&&spamAction(a,c,b,"appropriate");return}function spamAction(a,b,c,d,e){var f=a.attr("forumTopicId");f=f||a.parents('div[parentCont="actualParent"]').attr("forumTopicId");var g=a.attr("forumId");g=g||a.parents('div[parentCont="actualParent"]').attr("forumId");var h=a.attr("categoryId");h=h||a.parents('div[parentCont="actualParent"]').attr("categoryId");var i={},j=a.attr("spamValue");i.forumTopicId=f,i.forumGroupId=forumGroupId,i.action=j,i.postType=a.attr("postType"),i.purpose=d||a.attr("purpose"),i.forumId=g,i.categoryId=h,i[csrfParamName]=csrfToken,typeof e!="undefined"&&(i.spamDetails=e);var k=a.attr("responseId");typeof k!="undefined"&&(i.responseId=k),doAjaxAction("/spamAction.do",i,function(e){$("#spamStatusMsg").hide();if(e=="SUCCESS"){removeTopicListCache(),j=="1"?d=="appropriate"?showTipper(i18n["zohodiscussions.statistics.this"]+" "+b+" "+i18n["zohodiscussions.singlepost.Inappropriatemarkedmessage2"],"success",1e3):showTipper(i18n["zohodiscussions.statistics.this"]+" "+b+" "+i18n["zohodiscussions.singlepost.spammarkedmessage2"],"success",1e3):d=="appropriate"?showTipper(i18n["zohodiscussions.statistics.this"]+" "+b+" "+i18n["zohodiscussions.singlepost.InappropriateRemovedmessage"],"success",1e3):showTipper(i18n["zohodiscussions.statistics.this"]+" "+b+" "+i18n["zohodiscussions.singlepost.spamRemovedmessage"],"success",1e3);if(c=="singlePost")loadSinglePost(f,"true",undefined,undefined,"spamReported");else if(moderatorForSpam=="true")j==1?processHash("home"):(a.parent().remove(),$("#reportInappropriate_"+k).remove());else if(j==1){var g=$("#reportInappropriate_"+k);g.attr("spamValue","2"),g.find("div.imgAshSpam").removeClass("imgAshSpam").addClass("imgNotSpamIcon"),g.find("a").html(i18n["zohodiscussions.singlePost.Appropriate"]);if($("#reasonInappropriate_"+k).length>0){var h=$("#reasonInappropriate_"+k),i=parseInt(h.attr("reportCount"));i+=1,h.find('span[purpose="inappropriateReason"]').html(i18n["zohodiscussions.singlePost.Inappropriate"]+" ("+i+")"),h.attr("reportCount",i)}}else{var g=$("#reportInappropriate_"+k);g.attr("spamValue","1"),g.find("div.imgNotSpamIcon").removeClass("imgNotSpamIcon").addClass("imgAshSpam"),g.find("a").html(i18n["zohodiscussions.singlePost.Inappropriate"]);var h=$("#reasonInappropriate_"+k),i=parseInt(h.attr("reportCount"));i-=1,i>0?(h.attr("reportCount",i),h.find('span[purpose="inappropriateReason"]').html(i18n["zohodiscussions.singlePost.Inappropriate"]+" ("+i+")")):h.remove()}}},function(a){var b=toEvaluateData(a.responseText);b.result=="failure"&&showMessage(b.reason,"failure")})}function singlePostWidgetActions(a){var b=$(a.target),c=b.parent(),d="singlePost";if(c.is('li[purpose="bookmark"]'))bookMark(c,a);else if(c.is('li[purpose="watchAction"]')||c.is('div[purpose="watchAction"]'))watchThisItem(c,d,a);else if(c.is('li[purpose="lockTopic"]')||b.is("#unLockTopic")){var e=b.is("#unLockTopic")?b:c;lockTopicLink(e,a)}else if(c.is('li[purpose="moveTopic"]'))moveTopic(c);else if(c.is('li[purpose="stickyPost"]'))stickyLink(c,a);else if(c.is('li[purpose="moderateThisTopic"]'))moderateAction(c,d,a);else if(c.is('li[purpose="changeTopicType"]')){var f=c.attr("forumTopicId");changeTopicType(f)}else if(b.is('input[purpose="notifyAuthor"]')){var f=b.attr("forumTopicId");updateNotification(b,f,a)}else{if(b.is('a[purpose="forumPostsFilter"]'))return hashPurpose=b.attr("hashPurpose"),processHash(hashPurpose),!1;c.is('li[purpose="raiseZSupportRequest"]')&&raiseZSupportRequest(c,a)}}function changeTopicType(a){$("#changeTopicTypeTemplate").html($("#changeTopicType_"+a).html()),$("#changeTopicType_"+a).html(""),$("#changeTopicTypeTemplate").show(),$("#cancelTopicChange,#cancelChangingTopicType").click(function(){$("#changeTopicType_"+a).html($("#changeTopicTypeTemplate").html()),$("#changeTopicTypeTemplate").hide(),$("#changeTopicTypeTemplate").html("")}),$("#topicTypeListForChange").change(function(){var b=$(this);b.val()==1?$("#postExpiryDays_"+a).show():$("#postExpiryDays_"+a).hide()}),$("#doChange_"+a).click(function(){var b=$(this);$(this).attr("disabled",!0);var c=$("#topicTypeListForChange").val(),d=b.attr("forumId"),e=b.attr("categoryId"),f=b.attr("isTopicOwner"),g={};f=="true"&&(g.access="author");if(c==1){var h=$("#announcementExpiryDays_"+a).val();g.expiryDay=h}g.forumGroupId=forumGroupId,g.forumTopicId=a,g.forumId=d,g.categoryId=e,g.postTopicType=c,g[csrfParamName]=csrfToken,isThreadSorting&&(g.sortThreads=$("#SinglePostContainer").attr("sortThread")),doAjaxAction("/updateTopicType.do",g,function(b){removeTopicListCache(),loadNewPost("/updateTopicType.do",b,a),$("#changeTopicTypeTemplate").hide(),showTipper(i18n["zohodiscussions.singlePost.updateTopicTypeSuccessMessage"],"success")},function(a){showTipper(i18n["zohodiscussions.singlePost.updateTopicTypeErrorMessage"],"failure")})})}function updateNotification(a,b,c){var d={};d.forumGroupId=forumGroupId,d.forumTopicId=b,d.access="author",notifyStat=a.attr("notifyOnResponse"),notifyStat=="true"?(notifyStat="false",a.attr("notifyOnResponse",notifyStat)):(notifyStat="true",a.attr("notifyOnResponse",notifyStat)),d.currNotifyStatus=notifyStat,d[csrfParamName]=csrfToken,doAjaxAction("/updateNotify.do",d,function(a){(a="SUCCESS")?(removeTopicListCache(),showTipper(i18n["zohodiscussions.singlepost.Notificationsavedmessage"],"success",1e3)):showTipper(i18n["zohodiscussions.generalmessage.errorOccured"],"failure")})}function moderateAction(a,b,c){var d=a.attr("forumTopicId");d=d||a.parents('div[parentCont="actualParent"]').attr("forumTopicId");var e=a.attr("forumId");e=e||a.parents('div[parentCont="actualParent"]').attr("forumId");if(a.attr("moderationStatus")=="moderate"){var f={};f.forumTopicId=d,f.forumGroupId=forumGroupId,f.forumId=e,f[csrfParamName]=csrfToken,showSmallLoadingImage(c),doAjaxAction("/moderateTopic.do",f,function(c){c=="SUCCESS"?(removeTopicListCache(),a.attr("moderationStatus","moderated"),showTipper(i18n["zohodiscussions.singlepost.Now"]+i18n["zohodiscussions.singlepost.topicundermoderationmessage"],"success",2e3),b=="singlePost"?$("#moderateTopicText").html(i18n["zohodiscussions.singlepost.unmoderatethistopicmessage"]):a.find('a[purpose = "moderateTopicText"]').html(i18n["zohodiscussions.singlepost.unmoderatethistopicmessage"])):showTipper(i18n["zohodiscussions.singlepost.Moderationfailed"],"success",2e3),hideLoadingImage()})}else if(a.attr("moderationStatus")=="moderated"){var g={};g.forumTopicId=d,g.forumGroupId=forumGroupId,g[csrfParamName]=csrfToken,doAjaxAction("/unModerateTopic.do",g,function(c){c=="SUCCESS"?(removeTopicListCache(),a.attr("moderationStatus","moderate"),showTipper(i18n["zohodiscussions.singlepost.moderationtopicremoved"],"success",2e3),b=="singlePost"?$("#moderateTopicText").html(i18n["zohodiscussions.singlepost.moderatethistopicmessage"]):a.find('a[purpose = "moderateTopicText"]').html(i18n["zohodiscussions.singlepost.moderatethistopicmessage"])):showTipper(i18n["zohodiscussions.singlepost.Moderationfailed"],"success",2e3)})}}function moveTopic(a){var b=a.attr("forumTopicId");$("#moveTopicTemplate").html($("#moveTopic_"+b).html()),loadCategoriesToMove($("#forumListForMove").val()),$("#moveTopicTemplate").show();var c=$("#forumListForMove"),d=$("#forumListForModerator");a.attr("moderatorUser")=="yes"?(d.hide(),c.show(),c.val(a.attr("forumId")),loadCategoriesToMove(a.attr("forumId")),$("#moveToCategory").val(a.attr("categoryId"))):(c.hide(),d.show(),loadCategoriesToMove(d.val())),$("#cancelMove,#cancelMoveTopic").click(function(){$("#moveTopic_"+b).html($("#moveTopicTemplate").html()),$("#moveTopicTemplate").hide(),$("#moveTopicTemplate").html(""),$("#doMove").html(i18n["zohodiscussions.singlePost.Movetopic"])}),$("#forumListForMove,#forumListForModerator").change(function(){var b=a.attr("forumId"),c=$(this).val();b==c?$("#doMove").attr("disabled",!0):$("#doMove").attr("disabled",!1),loadCategoriesToMove($(this).val())}),$("#doMove").unbind("click").click(function(){var c=$(this);c.html(i18n["zohodiscussions.singlePost.Moving"]);var d=0;a.attr("moderatorUser")=="yes"&&(d=1);var e=$(this).attr("isTopicOwner"),f={};f.forumTopicId=b,f.forumId=$("#forumListForMove").val(),d==0&&(f.forumId=$("#forumListForModerator").val()),e&&(f.topicowner="true");var g=$("#moveToCategory"),h=g.is(":visible");f.categoryId=h==1?g.val():-1,f.forumGroupId=forumGroupId,f[csrfParamName]=csrfToken,f.categoryId||(f.categoryId=""),doAjaxAction("/moveTopic.do",f,function(a){removeTopicListCache(),$("#moveTopicTemplate").hide(),$("#moveTopicTemplate").html(""),showTipper(i18n["zohodiscussions.generalmessage.moveTopicSuccessMsg"],"success",3e3),loadNewPost("/moveTopic.do",a,b),$("#NewTopicTab").attr("hashPurpose","NewTopic/"+$("#moveTopicLink").attr("forumId")+"/"+$("#moveTopicLink").attr("categoryId")),a.indexOf("'result':'failure'")>0&&c.html(i18n["zohodiscussions.singlePost.Movetopic"])})})}function loadCategoriesToMove(a){categoriesForForum=$("#categoryListFormove").val().split("$$"),$("#moveToCategory").hide().parent().hide(),$.each(categoriesForForum,function(b,c){if(c.indexOf(a+":")>-1){$("#moveToCategory").html(c.split(":")[1]).show().parent().show();return}})}function singlePostTagActions(a,b){$("#forumTopicTags").find('b[purpose = "deleteTag"]').click(function(){if(confirm(i18n["zohodiscussions.singlepost.tagDeleteConfirmMsg"])){$this=$(this);var b={},c=$this.attr("postTagId"),d=$this.attr("eachTagName"),e=$this.attr("zuid"),f=$this.attr("forumId"),g=$this.attr("postAuthorId");g==e&&(b.access="author"),b.forumGroupId=forumGroupId,b.forumTopicId=a,b.forumId=f,b.postTagId=c,b[csrfParamName]=csrfToken;var h=$("#tagRelatedPosts_"+c).attr("tagCount");doAjaxAction("/deleteForumPostTags.do",b,function(b){b=="SUCCESS"&&(removeTopicListCache(),h=--h,$(".deleteTag").attr("tagCount",h),showTipper("<i>"+d+" </i> "+i18n["zohodiscussions.resource.tagdelete"],"info",3e3),$("#tagRelatedPosts_"+c).hide(),h==0&&($("#LockTopicLink").attr("isLocked")&&$("#linkTopicCont_"+a).length>0?$("#forumTopicTags").append('<span class="addTagSpan">'+i18n["zohodiscussions.singlepost.noTagsMsg"]+"</span>"):($("#addTagsForPost").hide(),$("#forumTopicTags").append('<span class="addTagSpan"> Click <a id="addNewTag" href="javascript:;">here</a> to add new tags.</span>'),singlePostTagActions())))})}return!1}),$("#addTagsForPost,#addNewTag").click(function(){$("#addPostTags").show(),$("#addPostTags").find(':input[name="postTags"]').focus(),$("#addTagSpan").hide()}),$("#cancelTags").click(function(){$("#addPostTags").hide(),$("#addPostTags").find(':input[name="postTags"]').attr("value"," ")}),$("#savePostTags").click(function(){$this=$(this);var b=$("#addPostTags"),c=b.find(':input[name="postTags"]').val();c=c.replace(/^\s+|\s+$/g," ").replace(/\s+/g," ");var d="false";if(c!=""&&c.match(/^[^\^\"'()~`!@#$%&:;\/\\?|<>{}[\]*-+=]+$/)==null){hideLoadingImage(),showMessage(i18n["zohodiscussions.singlepost.specialCharacterNotAllowedMsg"],"failure"),enablePostButtons();return}var e=c.split(",");for(var f=0;f<e.length;f++){if(e[f].length>50){showTipper(i18n["zohodiscussions.singlepost.TagexceedMessage"],"failure");return}e[f]!=""&&!jQuery.trim(e[f])==""&&(d="true")}if(d=="false"){showMessage(i18n["zohodiscussions.singlepost.tagNameEmptyMsg"],"failure");return}if(c.indexOf("-")<0){var g=$this.attr("forumId"),h=$this.attr("postAuthorId"),i={};h==ZUID&&(i.access="author"),i.forumId=g,i.postTags=c,i.forumGroupId=forumGroupId,i.forumTopicId=a,i[csrfParamName]=csrfToken;if(jQuery.trim(c)==""){showMessage(i18n["zohodiscussions.singlepost.tagNameEmptyMsg"],"failure");return}doAjaxAction("/addNewTagsForPost.do",i,function(b){removeTopicListCache(),showTipper(i18n["zohodiscussions.resource.tagsadded"],"success",2e3),loadNewPost("/addNewTagsForPost.do",b,a)})}}),$("#forumTopicTags").find('[purpose="getTagRelatedPosts"]').unbind("click").click(function(){$this=$(this),b=b||"Tag";var a=$this.attr("hashPurpose");return processHash(a),!1})}function changeTopicLabel(a){var b=$("#zdstatusList"),c=a.attr("topicLabelId"),d=b.attr("forumTopicId"),e=b.attr("forumId"),f={};f.forumGroupId=forumGroupId,f.forumTopicId=d,f.forumId=e,f.topicLabelId=c,f[csrfParamName]=csrfToken,doAjaxAction("/updateTopicLabel.do",f,function(b){if(b=="success"){removeTopicListCache(),showTipper(i18n["zohodiscussions.singlePost.updateTopicLabelSuccessMsg"],"success");var c=$.trim(a.html());$("#zdstatusInfo").html(c)}else showMessage(i18n["zohodiscussions.singlePost.updateTopicLabelErrorMessage"],"failure")},function(a){})}function watchThisItem(a,b,c){var d=a.attr("hashPurpose"),e=a.attr("watchItemType"),f=a.attr("watchItemId");f=f||a.parents('div[parentCont="actualParent"]').attr("forumTopicId");var g=a.attr("status"),h=a.attr("watchStatus"),i=a.attr("itemName"),j={};j.watchItemType=e,j.watchItemId=f,j.forumGroupId=forumGroupId,j[csrfParamName]=csrfToken;if(g=="watch"||h=="watch")showSmallLoadingImage(c),doAjaxAction("/watchItem.do",j,function(c){if(c=="SUCCESS"){removeTopicListCache();if(e==0){showTipper(i18n["zohodiscussions.singlepost.watchTopicSuccessMsg"],"success",3e3);if(b=="singlePost")$(".wrapper > div[watchItemId="+f+"]").attr("status","unwatch"),$(".wrapper > div[watchItemId="+f+"] > a").html(i18n["zohodiscussions.singlePost.unwatchTopic"]),hideLoadingImage();else if(b=="singleTopicWatch"){a.attr("status","unwatch");var g=a.parent();g.removeClass("smallAshBox").addClass("smallAshBoxShow"),a.removeClass("imgSmallWatch").addClass("imgSmallWatchSel"),hideLoadingImage()}else a.attr("status","unwatch"),a.find('a[purpose = "watchItemText"]').html(i18n["zohodiscussions.singlePost.unwatchTopic"]),hideLoadingImage()}else{if(e==2)return showTipper(i18n["zohodiscussions.widgetscontainer.watchForumSuccessMsg"],"success",3e3),a.attr("status","unwatch"),d!="type"?processHash(d):(a.find("a").html(i18n["zohodiscussions.general.Unwatch"]+" "+i),$("#ajaxLoaderSmall").hide()),!1;if(e==1)return showTipper(i18n["zohodiscussions.widgetscontainer.watchCategorySuccessMsg"],"success",3e3),a.attr("status","unwatch"),d!="type"?processHash(d):(a.find("a").html(i18n["zohodiscussions.general.Unwatch"]+" "+i),$("#ajaxLoaderSmall").hide()),!1;if(e==4||e==5||e==6)return showTipper(i18n["zohodsicussions.watchlist.announcement.follow.success"],"success",3e3),a.attr("status","unwatch"),a.html(i18n["zohodiscussions.general.Unwatch"]+" "+i),$("#ajaxLoaderSmall").hide(),!1}}});else{var k="";if(e==0)k=i18n["zohodiscussions.singlepost.unwatchTopicConfirmMsg1"];else if(e==1)k=i18n["zohodiscussions.singlepost.unwatchCategoryConfirmMsg3"];else if(e==2)k=i18n["zohodiscussions.singlepost.unwatchForumConfirmMsg2"];else if(e==4||e==5||e==6)k=i18n["zohodsicussions.watchlist.announcement.unwatch.confirm"];if(confirm(k)){var l={};l.watchItemId=f,l.forumGroupId=forumGroupId,l[csrfParamName]=csrfToken,doAjaxAction("/unWatch.do",l,function(c){if(c=="SUCCESS"){removeTopicListCache();if(e==0){showTipper(i18n["zohodiscussions.singlepost.unwatchTopicSuccessMsg"],"info",3e3);if(b=="singlePost")$(".wrapper > div[watchItemId="+f+"]").attr("status","watch"),$(".wrapper > div[watchItemId="+f+"] > a").html(i18n["zohodiscussions.singlePost.watchTopic"]);else if(b=="singleTopicWatch"){a.attr("status","watch");var g=a.parent();g.removeClass("smallAshBoxShow").addClass("smallAshBox"),a.removeClass("imgSmallWatchSel").addClass("imgSmallWatch"),hideLoadingImage()}else a.attr("status","watch"),hideLoadingImage()}else{if(e==2)return showTipper(i18n["zohodiscussions.widgetscontainer.unwatchForumSuccessMsg"],"success",3e3),a.attr("status","watch"),d!="type"?processHash(d):(a.find("a").html(i18n["zohodiscussions.general.watch"]+" "+i),$("#ajaxLoaderSmall").hide()),!1;if(e==1)return showTipper(i18n["zohodiscussions.widgetscontainer.unwatchCategorySuccessMsg"],"success",3e3),a.attr("status","watch"),d!="type"?processHash(d):(a.find("a").html(i18n["zohodiscussions.general.watch"]+" "+i),$("#ajaxLoaderSmall").hide()),!1;if(e==4||e==5||e==6)return showTipper(i18n["zohodsicussions.watchlist.announcement.stop.success"],"success",3e3),a.attr("status","watch"),a.html(i18n["zohodiscussions.general.watch"]+" "+i),$("#ajaxLoaderSmall").hide(),!1}}})}}}function bookMark(a,b){var c=a.attr("status"),d={};d.forumGroupId=forumGroupId,d.forumTopicId=a.attr("forumTopicId"),d[csrfParamName]=csrfToken,showSmallLoadingImage(b),c=="bookmark"?doAjaxAction("/addBookMark.do",d,function(b){hideLoadingImage(),b=="SUCCESS"?(removeTopicListCache(),showTipper(i18n["zohodiscussions.singlepost.bookmarkTopicSuccessMsg"],"success",3e3),a.attr("status","removeBookmark"),a.find("a").html(i18n["zohodiscussions.singlePost.removeBookmark"])):showTipper(i18n["zohodiscussions.singlePost.bookMarkErrorMessage"],"failure")}):doAjaxAction("/removeBookMark.do",d,function(b){hideLoadingImage(),b=="SUCCESS"?(removeTopicListCache(),showTipper(i18n["zohodiscussions.singlePost.removeBookmarkMsg"],"info",3e3),a.attr("status","bookmark"),a.find("a").html(i18n["zohodiscussions.singlePost.bookmarkTopic"])):showTipper(i18n["zohodiscussions.singlePost.removeBookMarkErrorMessage"],"failure")})}function stickyLink(a,b){var c=0,d=a.attr("status"),e=a.attr("isSticky");e=="true"&&(c=1);var f={};f.forumGroupId=forumGroupId,f.forumTopicId=a.attr("forumTopicId"),f.action=c,f[csrfParamName]=csrfToken,showSmallLoadingImage(b),doAjaxAction("/stickyAction.do",f,function(b){b=="SUCCESS"&&(removeTopicListCache(),d=="stickyPost"?(showTipper(i18n["zohodiscussions.singlepost.stickyPostSuccessMsg"],"success",3e3),a.attr("status","normal"),a.attr("isSticky","true"),$("#stickyPostText").html(i18n["zohodiscussions.singlePost.notStickyPost"])):(showTipper(i18n["zohodiscussions.singlePost.removeStickyPostMsg"],"info",3e3),a.attr("status","stickyPost"),a.attr("isSticky","false"),$("#stickyPostText").html(i18n["zohodiscussions.singlePost.makeStickyPost"])),hideLoadingImage())})}function lockTopicLink(a,b){var c=0,d=a.attr("status"),e=a.attr("isLocked"),f=a.attr("forumTopicId");e=="true"&&(c=1);var g=d=="lockTopic"?i18n["zohodiscussions.singlepost.lockConfirmationMsg"]:i18n["zohodiscussions.singlepost.unlockConfirmationMsg"];if(confirm(g)){var h={};h.forumGroupId=forumGroupId,h.forumTopicId=f,h.action=c,h[csrfParamName]=csrfToken,isThreadSorting&&(h.sortThreads=$("#SinglePostContainer").attr("sortThread")),doAjaxAction("/lockAction.do",h,function(a){removeTopicListCache(),d=="lockTopic"?showTipper(i18n["zohodiscussions.singlepost.lockTopicSuccessMsg"],"info",3e3):showTipper(i18n["zohodiscussions.singlepost.unlockTopicSuccessMsg"],"info",3e3),loadNewPost("/lockAction.do",a,f)})}}function raiseZSupportRequest(a,b){var c={};c.forumGroupId=forumGroupId,c.forumTopicId=a.attr("forumTopicId"),c.forumId=a.attr("forumId"),c[csrfParamName]=csrfToken,showSmallLoadingImage(b),jQuery("#ajax_load_tab").show(),doAjaxAction("/raiseZSupportRequest.do",c,function(b){jQuery("#ajax_load_tab").hide();var c=toEvaluateData(b);c.result=="success"?(showTipper("Support ticket added successfully","info",3e3),a.attr("Purpose")=="raiseZSupportRequest"&&(a.remove(),$(".sideBar").find(".wrapper").prepend('<div class="spwidgetBox"><div class="zsupportReqMsg">'+i18n["zohodiscussions.singlepost.zsupportRequestMsg"]+"</div></div>")),a.parents('[purpose="zsRequestLinkCont"]').remove(),hideLoadingImage()):showMessage(c.reason,"failure")})}function disablePostResponseButtons(){$("#publishResponse").attr("disabled",!0),$('button[purpose="publishPreviewResponse"]').attr("disabled",!0)}function enablePostResponseButtons(){$("#publishResponse").attr("disabled",!1),$('button[purpose="publishPreviewResponse"]').attr("disabled",!1)}function addForumResponse(a,b,c,d){showLoadingImage(i18n["zohodiscussions.general.publishing"]);var e=editor.getContent();e=e.replace(/^\s+/g,"").replace(/\s+$/g,"");var f=editor.doc.body.textContent.trim();editor.mode==="plaintext"&&(f=e.trim(),e=encodeHTML(e),e=e.replace(/\n/g,"<br/>")),$("#postContentTA").val(e.trim());if(f===""){hideLoadingImage(),showMessage(i18n["zohodiscussions.writePost.noContentInPost"],"failure");return}$("#editorHolder").append($("#attachmentsListCont").clone().hide());var g=b&&b=="Edit"?"/updateResponse.do":ZUID==-1?"/addGuestForumResponse.do":"/addForumResponse.do";if(b=="TweetPost"){var h=$("#editorHolder").find('input[name="forumPostTitle"]').val();h=h.replace(/^\s+/g,"").replace(/\s+$/g,"");var i=$("<div></div>").html(h);i=i.text(),i=$.trim(i);if(i==""){hideLoadingImage(),showMessage(i18n["zohodiscussions.writePost.TopicTitleCannotbeEmptymessage"],"failure"),$("#editorHolder").find('input[name="forumPostTitle"]').focus();return}if($("#forum_Twitter_SelectForum").val()==-1){hideLoadingImage(),showMessage(i18n["zohodiscussions.writePost.selectAnyForum"],"failure");return}if($("#forum_Twitter_SelectSubForum_"+d).val()==-1&&$("#forum_Twitter_SelectSubForum_"+d).text()!="Uncategorised"){hideLoadingImage(),showMessage(i18n["zohodiscussions.writePost.selectAnyCategory"],"failure");return}g="/addTweetPost.do";var j=$tempCont;$("#editorHolder").find('input[name="twitterResponseContent"]').val(j)}return disablePostResponseButtons(),doAjaxAction(g,$("#editorHolder").serialize(),function(d){d=$.trim(d),hideLoadingImage();if(d.substring(12,19)=="failure"){var f=toEvaluateData(d);f.errorcode=="SPAM_DETECTED"?confirm(f.reason)&&($("#editorHolder").find('input[name="detectSpamPresence"]').val(0),$("#publishResponse").trigger("click")):showMessage(f.reason,"failure"),enablePostResponseButtons()}else{if(d.substring(12,19)=="success"){var f=toEvaluateData(d);if($("#SinglePostContainer").length>0)removeTopicListCache(),loadSinglePost(a,!1,undefined,undefined,"spamReported");else if($("#topicList").length>0||$("#topicsList").length>0)$("#topicListMainContainer").attr("shouldReload","true"),$("#currentCategoryContext").length>0?$("#currentCategoryContext").trigger("click"):b=="TweetPost"?(showTipper(i18n["zohodiscussions.writePost.publishMsg"],"success",4e3),isTopicQuickView=="false"?window.location.href=serverURL+"/topic/"+f.topicPermaLink:(showLoadingImage(),loadSinglePost(f.value))):$("#currentForumContext").trigger("click");showTipper(i18n[f.reason],"info",5e3);return}var h=b&&b=="Edit"?i18n["zohodiscussions.singlepost.ResponseUpdated"]:i18n["zohodiscussions.singlepost.ResponseAdded"];showTipper(h,"success",3e3);if($("#SinglePostContainer").length>0)removeTopicListCache(),showLoadingImage(),loadNewPost(g,d,a);else if($("#topicList").length>0||$("#topicsList").length>0){$("#topicListMainContainer").attr("shouldReload","true");var i=$("#topicListMainContainer").attr("forumId");if(isEmbedService())return ZIntranet.loadForum(i),$("#cancelResponse").trigger("click"),!1;if($("#currentCategoryContext").length>0)$("#currentCategoryContext").trigger("click");else if($("#currentForumContext").length==0){var j=$("#eachTopic_"+a).attr("currTagName");loadTagRelatedPost(j)}else $("#currentForumContext").trigger("click")}else if($("#myJournalsInnerContent").length>0){var k=a;c&&$("#topicContent_"+k).length<1&&(k=c),$("#topicContent_"+k).html(e),$("#editTopic_"+k).html(e),$("#cancelResponse").trigger("click")}else if($("#authorProfileInnerContent").length>0){var k=a;c&&$("#topicContent_"+k).length<1&&(k=c),$("#topicContent_"+k).html(e),$("#editTopic_"+k).html(e),$("#cancelResponse").trigger("click")}$('#responsePreviewContainerTemplate button[purpose="publishPreviewResponse"]').attr("disabled",!1)}},function(a){hideLoadingImage();if(a.responseText.indexOf("'result':'failure'")>0){var b=toEvaluateData(a.responseText);if(b.result=="failure")if(b.errorcode=="HIP_REQUIRED"){$("#editorHolder").find("div#responseAttachmentContActual").remove();var c=$("#responseAttachmentContActual").find('div[purpose="responseCaptcha"]');c.attr("currCaptcha")=="new"?showMessage(i18n["zohodiscussions.writePost.captchaMsg"],"failure"):showMessage(i18n["zohodiscussions.writePost.captchaErrorMsg"],"failure"),c.find('img[purpose="captchaImage"]').replaceWith("<img purpose=captchaImage name=hipImg border=0 src=/showcaptcha?digest="+b.reason+" align=absmiddle alt=HIP image>"),c.find(":input").attr("name",b.reason),c.attr("currCaptcha","old"),c.show(),$("#responseAttachmentContActual").is(":visible")||$("#responseAttachmentContActual").show(),enablePostResponseButtons()}else showMessage(b.reason,"failure"),enablePostResponseButtons()}else $("#SinglePostContainer").get(0).innerHTML=a.responseText}),!1}function removeTopicListCache(){$("#topicListMainContainer:hidden").remove(),$("#userProfileMainContainer:hidden").remove(),$("#myAreaParentContainer:hidden").remove()}function loadNewPost(a,b,c){var d=$(b),e=$("#topicContainer_"+c);hideLoadingImage();if(a=="/updateResponse.do"){var f=$('#editorHolder [name="responseId"]').val(),g=d.find("#fullResponseContainer_"+f).html();$("#fullResponseContainer_"+f).html(g)}else if(a=="/moveTopic.do"){var h=$("#topicVoteLink").attr("firstResponseId"),i=d.find(".spbreadCrumbCont").html(),j=d.find("#fullResponseContainer_"+h).html(),k=d.find("#singlePostActionsWidget_"+c).html();$(".spbreadCrumbCont").html(i),$("#fullResponseContainer_"+h).html(j),$("#singlePostActionsWidget_"+c).html(k)}else if(a=="/addLinkToTopic.do"||a=="/lockAction.do"||a=="/deleteLinkedTopic.do"){var i=d.find("#SinglePostContainer_"+c).html(),j=d.find("#singlePostActionsWidget_"+c).html(),l=d.find("#forumTopicTags").html();$("#SinglePostContainer_"+c).html(i),$("#singlePostActionsWidget_"+c).html(j),$("#forumTopicTags").html(l)}else if(a=="/addNewTagsForPost.do"){var m=d.find("#forumTopicTags").html();$("#forumTopicTags").html(m)}else if(a==="/updateTopicType.do"||a==="/addForumResponse.do"||a==="/bestResponse.do"||a==="/removeBestResponse.do"||a==="/addGuestForumResponse.do"){var n=d.find("#SinglePostContainer_"+c).html();$("#SinglePostContainer_"+c).html(n);if(a=="/addForumResponse.do"){var o=d.find("#discussionsResponseCount").html();$("#discussionsResponseCount").html(o);var p=d.find('.sideBar > .wrapper > div[purpose="watchAction"]');p.length>0&&($('.sideBar > .wrapper > div[purpose="watchAction"]').remove(),$(".sideBar > .wrapper").prepend(p));var q=d.find("#topicContainer_"+c).attr("recentResponseId");$("#topicContainer_"+c).attr("recentResponseId",q),$(window).scrollTop($("#fullResponseContainer_"+q).offset().top)}}else if(a==="/getSortedThread.do"){var n=d.find("#singlePostreplyContainer_"+c).html();$("#singlePostreplyContainer_"+c).html(n)}e.data("inEditMode",!1),initSinglePost(c)}function bindMyAreaClicks(a){a.unbind("click",processMyAreaClick).click(processMyAreaClick),$("#recentActivityContent, #profileDetailCont").unbind("click",processAllMyAreaMainClick).click(processAllMyAreaMainClick),$("#mainContent").unbind("click",processAuthorProfileClick),$("#mainContent").unbind("click",processAllActionClick),initialiseUserActivityChart()}function processMyAreaClick(a){var b=$(a.target),c=b.parent();if($("#loadingImg").is(":visible")||$("#discussChartLoading").is(":visible"))return;if((c.is('[purpose="dashBoard"]')||c.is('[purpose="myJournals"]')||c.is('[purpose="watchList"]')||c.is('[purpose="friends"]')||c.is('[purpose="bookMark"]')||c.is('[purpose="privateMsg"]')||c.is('[purpose="preference"]'))&&c.attr("isNiceUrl")!="Yes"){getMyAreaAction(c);return}if((b.is('[purpose="dashBoard"]')||b.is('[purpose="myJournals"]')||b.is('[purpose="watchList"]')||b.is('[purpose="friends"]')||b.is('[purpose="bookMark"]')||b.is('[purpose="privateMsg"]')||b.is('[purpose="preference"]'))&&b.attr("isNiceUrl")!="Yes"){getMyAreaAction(b);return}}function getMyAreaAction(a,b){showLoadingImage(),a.parent("ul").find("li").removeClass("selected"),a.addClass("selected");var c=a.attr("action"),d={};d.forumGroupId=forumGroupId,d[csrfParamName]=csrfToken,d.ch=ch;var e=a.attr("purpose");b!=undefined&&e=="watchList"&&(c="/myWatchListSubAction.do",d.subAction=b),$("#myAreaLists").attr("currView",e),e=="myJournals"&&(d.userId=a.attr("userId"),d.viewType="myself"),doAjaxAction(c,d,function(a){return hideLoadingImage(),$("#myAreaInnerMainContent").find("div.innerWrapper").get(0).innerHTML=a,isEmbedAllowedService()&&(e=="myJournals"?($.history.add("MyArea/myPosts"),lightBox("#myJournalsInnerContent")):e=="watchList"&&b!=undefined?$.history.add("MyArea/"+e+"/"+b):e=="friends"&&b!=undefined?$.history.add("MyArea/"+e+"/"+b):$.history.add("MyArea/"+e)),bindMyareaTabsActions(e,b),!1},function(a){var b=toEvaluateData(a.responseText);showMessage(b.reason,"failure"),hideLoadingImage()})}function bindMyareaTabsActions(a,b){var c=$("#myAreaInnerMainContent").find("div.innerWrapper");if(a=="preference"){c.unbind("click",processPreferenceClick).click(processPreferenceClick);var d=$("#user_AvatarImage");d.find("li.selected").length>0&&avatarImageFocus(d);var e=$("#preferenceInnerContent").find("form").attr("userPhotoPref"),f=$("#preferenceInnerContent").find("form").attr("userUploadPhotoUrl"),g=$("#preferenceInnerContent").find("form").attr("userIAMphoto"),h="";if(e=="IAM")h=g;else if(e=="userUpload")h=f;else if(e=="Avatar"&&$("#allAvatarList").find("li.selected").length==0){$("#allAvatarList").find('li[count="1"]').addClass("selected");var i="../images/avatars/avatarn1.gif";$("#userSelectedAvatarImage").attr("value",i),$("#userSelectedProfileImage").attr("value",i),$("#userPreferencePhotoCont").find("img").attr("src",i),$("#user_Photo").attr("value","Avatar")}insertBrowserOptionToUpload(e,h);var j=$("#resetpassword"),k={};k[csrfParamName]=csrfToken,j.find("a").click(function(a){showSmallLoadingImage(a),j.hide(),doAjaxAction("https://"+defaultDomain+"/sendResetPassword.do",k,function(a){a=="success"?(hideLoadingImage(),j.html(i18n["zohodiscussions.reset.success"]),j.show()):(hideLoadingImage(),j.html(i18n["zohodiscussions.reset.failure"]),j.show())})})}else c.unbind("click",processAllMyAreaMainClick).click(processAllMyAreaMainClick),c.unbind("click",processAllActionClick).click(processAllActionClick),allFilterOption(a),showAuthorPopout(c),b=="following"&&setFocusToContainer(c.find("#followingAuthors"),!1,100,0);if(a=="dashBoard"){if(typeof WmsContacts!="undefined"&&ch=="true"){var l=WmsContacts.getZohoContacts();setPresence(l,"followingUserDetails"),setPresence(l,"followersUserDetails"),setPresence(l,"friendsListContainer"),setPresenceInMyArea(l,"current_recentActivity_List")}initialiseUserActivityChart()}if(a=="watchList"&&typeof WmsContacts!="undefined"&&ch=="true"){var l=WmsContacts.getZohoContacts();setPresenceInMyArea(l,"userChat_watchTopics")}if(a=="privateMsg"&&typeof WmsContacts!="undefined"&&ch=="true"){var l=WmsContacts.getZohoContacts();setPresenceInMyArea(l,"userChat_inbox")}if(a=="friends"&&typeof WmsContacts!="undefined"&&ch=="true"){var l=WmsContacts.getZohoContacts();setPresenceInMyArea(l,"friendsDetailsInnerContent")}}function avatarImageFocus(a){var b=a.find("li.selected").attr("count"),c=parseInt(b/7);b%7==0&&(c-=1),a.scrollTop(c*60)}function UserPhotoPreference(a,b){b=="uploadUserPhoto"&&($("#uploadPhotoCont").find('input[name="imageFileName"]').val(""),$("#uploadPhotoCont").find('img[purpose="uploadPhotoLoadingCont"]').remove(),$("#uploadPhotoPreference").attr("src",a),$("#uploadPhotoCont").find('img[purpose="avat_Image"]').attr("src",a),$("#userSelectedAvatarImage").attr("value",a),$("#userSelectedProfileImage").attr("value",a),$("#preferenceInnerContent").find("form").attr("userUploadPhotoUrl",a),$("#userPreferencePhotoCont").find("img").attr("src",a),$("#user_Photo").attr("value","userUpload"),$("#uploadPhotoCont").find("div.profilePhoto").removeClass("profilePhoto").addClass("profilePhotoSelected"),$("#allAvatarList").find("li.selected").removeClass("selected"),showTipper(i18n["zohodiscussions.userpreference.uploadsuccessMess"],"success",1e3))}function processAllMyAreaMainClick(a){var b=$(a.target),c=b.parent();lightBox("#myJournalsInnerContent");if($("#loadingImg").is(":visible")||$("#discussChartLoading").is(":visible"))return;if(b.is('a[purpose="postTitle"]')){if(b.attr("postType")=="draft"){editDraftPost(b);return}showLoadingImage();if(isTopicQuickView!="false"){var d=b.attr("forumTopicId"),e=b.attr("recentResponseId");return e!=undefined?processHash("Topic/"+d+"/"+e):processHash("Topic/"+d),!1}}else{if((b.is('a[purpose="forumAction"]')||b.is('a[purpose="categoryAction"]'))&&b.attr("isNiceUrl")!="Yes"){var f=b.attr("hashPurpose");return processHash(f),!1}if(b.is('a[purpose="authorProfile"],a[purpose="authorProfileMore"]')&&b.attr("isNiceUrl")!="Yes"){var g=b.attr("authorName"),h=b.attr("singleClickflag");h=="0"&&(g==screenName||g==encodedScreenName?(processHash("MyArea"),b.attr("singleClickflag","1")):(processHash("User/"+g),b.attr("singleClickflag","1")));return}if(b.is('div[purpose="unWatch"]')){unWatchItem(b);return}if(b.is('a[purpose="moreFollowing"]')&&b.attr("isNiceUrl")!="Yes"){processHash("myarea/watchList/following");return}if(b.is('a[purpose="moreFollowers"]')&&b.attr("isNiceUrl")!="Yes"){processHash("myarea/watchList/follower");return}if(c.is('li[deletepurpose="deleteAttachment"]')){deletePublishedAttachment(c,a);return}if(b.is("li.navBtnEnabled")&&b.is('li[action="false"]')){var i=b.attr("purpose");fnPaginationProcess(c,i);return}}}function processAllActionClick(a){var b=$(a.target),c=b.parent(),d=$("#myAreaLists").attr("currView");d||(d="authorProfile");if($("#loadingImg").is(":visible")||$("#discussChartLoading").is(":visible"))return;if(b.is(".bigPlusIcon")){var e=b.parents("li.headerContent");!e.find("div.expandTextContent").is(":visible")||d=="privateMsg"?(e.find("div.textContent").addClass("expandTextContent").show(),e.parents("div.moderateSinglePost").find("div.lowerButton").show()):e.find("div.textContent").addClass("expandTextContent"),b.removeClass("bigPlusIcon").addClass("bigMinusIcon"),setFocusToContainer(b,!0,200);return}if(b.is(".bigMinusIcon")){var e=b.parents("li.headerContent");e.find("div.textContent").removeClass("expandTextContent").hide(),e.parents("div.moderateSinglePost").find("div.lowerButton").hide(),b.removeClass("bigMinusIcon").addClass("bigPlusIcon");return}if(c.is('li[purpose="expandedView"]')||c.is('li[purpose="listView"]')){manageExpandOrCollapseType(c,d);return}if(b.is("li.navBtnEnabled")&&b.is('li[action="true"]')){var f=b.attr("purpose");d=="authorProfile"?fnPagination(c,f,"true"):fnPagination(c,f);return}if(b.is('li[purpose="removeBookMark"]')){removeBookMarkAction(b);return}if(c.is('li[purpose="removeBookMark"]')){removeBookMarkAction(c);return}if(b.is('li[purpose="postTitle"]')){if(b.attr("postType")=="draft"){editDraftPost(b);return}showLoadingImage();if(isTopicQuickView!="false"){var g=b.attr("forumTopicId");return processHash("Topic/"+g),!1}}else if(c.is('li[purpose="postTitle"]')){if(c.attr("postType")=="draft"){editDraftPost(c);return}showLoadingImage();if(isTopicQuickView!="false"){var g=c.attr("forumTopicId");return processHash("Topic/"+g),!1}}else{if(c.is('li[purpose="delete"]')){myJournalsDeletePost(c,d+"Tab");return}if(b.is('li[purpose="delete"]')){myJournalsDeletePost(b,d+"Tab");return}if(b.is('li[purpose="resources"]')||b.is('li[purpose="topics"]')||b.is('li[purpose="drafts"]')||b.is('li[purpose="replies"]')||b.is('li[purpose="authorTopics"]')||b.is('li[purpose="authorReplies"]')||b.is('li[purpose="privateMsg"]')){$("#"+d+"Tab").find("li").removeClass("selected"),myAreaAllTabClick(b,d);return}if(c.is('li[purpose="resources"]')||c.is('li[purpose="topics"]')||c.is('li[purpose="drafts"]')||c.is('li[purpose="replies"]')||c.is('li[purpose="authorTopics"]')||c.is('li[purpose="authorReplies"]')||c.is('li[purpose="privateMsg"]')){$("#"+d+"Tab").find("li").removeClass("selected"),myAreaAllTabClick(c,d);return}if(b.attr("purpose")=="watchTopics"||b.attr("purpose")=="watchUsers"||b.attr("purpose")=="watchForums"||b.attr("purpose")=="watchCategories"||b.attr("purpose")=="simpleView"||b.attr("purpose")=="followers")$("#watchListTabs").find("li").removeClass("selected"),myAreaAllTabClick(b,"watchList");else if(c.attr("purpose")=="watchTopics"||c.attr("purpose")=="watchUsers"||c.attr("purpose")=="watchForums"||c.attr("purpose")=="watchCategories"||c.attr("purpose")=="simpleView"||c.attr("purpose")=="followers")$("#watchListTabs").find("li").removeClass("selected"),myAreaAllTabClick(c,"watchList");else if(b.attr("purpose")=="friendsActivities"||b.attr("purpose")=="friendsList"||b.attr("purpose")=="pendingFriendRequests")$("#friendsDetailsTabs").find("li").removeClass("selected"),friendsTabClick(b,"friendsDetails");else if(c.attr("purpose")=="friendsActivities"||c.attr("purpose")=="friendsList"||c.attr("purpose")=="pendingFriendRequests")$("#friendsDetailsTabs").find("li").removeClass("selected"),friendsTabClick(c,"friendsDetails");else if(c.is('li[purpose="removeFriend"]'))removeFriend(c);else if(c.is('li[purpose="confirmFriend"]'))confirmFriendRequest(c);else{if(b.is('li[purpose="unWatch"]')){unWatchItem(b);return}if(c.is('li[purpose="unWatch"]')){unWatchItem(c);return}if(c.is('li[purpose="unWatchItem"]'))unWatchItem(c,"authorProfile");else{if(b.attr("purpose")=="inbox"||b.attr("purpose")=="sent"){$("#privateMsgTab").find("li").removeClass("selected");var h=$("#newReplyPrivateMsgCont");h.is(":visible")&&(h.parent().hide(),h.remove()),myAreaAllTabClick(b,"privateMsg");return}if(c.attr("purpose")=="inbox"||c.attr("purpose")=="sent"){$("#privateMsgTab").find("li").removeClass("selected");var h=$("#newReplyPrivateMsgCont");h.is(":visible")&&(h.parent().hide(),h.remove()),myAreaAllTabClick(c,"privateMsg");return}if(b.is('li[purpose="deleteThisPM"]'))deletePrivateMsg(b);else if(c.is('li[purpose="deleteThisPM"]'))deletePrivateMsg(c);else if(b.is('li[purpose="replyToThisPM"]')||b.is('li[purpose="editThisPM"]'))replyToPrivateMsg(b);else if(c.is('li[purpose="replyToThisPM"]')||c.is('li[purpose="editThisPM"]'))replyToPrivateMsg(c);else if(c.is('a[purpose="postConversation"]'))privateConversation(c);else if(b.is('a[purpose="postConversation"]'))privateConversation(b);else if(b.is('a[purpose="postConversationTitle"]')){var i=b.parents("li.headerContent"),j=i.find("div.textContent");j.is(":visible")?i.find("div.bigMinusIcon").trigger("click"):i.find("div.bigPlusIcon").trigger("click")}}}}}function allFilterOption(a){$("#"+a+"_Filter").change(function(){var b=$(this),c=b.val(),d=$(this).find('option[filterType="'+c+'"]');b.attr("action")=="true"?myJournalsFilterAction(d,a):myJournalsFilter(d,a)})}function removeBookMarkAction(a){var b=a.attr("forumTopicId"),c={};c.forumGroupId=forumGroupId,c.forumTopicId=b,c[csrfParamName]=csrfToken,doAjaxAction("/removeBookMark.do",c,function(a){a==="SUCCESS"?(hideLoadingImage(),showTipper(i18n["zohodiscussions.bookMark.successfullyRemoveBookMark"],"success"),$("#bookMark_"+b).remove()):showTipper(i18n["zohodiscussions.singlePost.removeBookMarkErrorMessage"],"failure")},function(a){var b=toEvaluateData(a.responseText);showMessage(b.reason,"failure"),hideLoadingImage()})}function processPreferenceClick(a){var b=$(a.target),c=b.parent(),d=$("#preferenceInnerContent").find("form").attr("userUploadPhotoUrl"),e=$("#preferenceInnerContent").find("form").attr("userIAMphoto");if($("#loadingImg").is(":visible")||$("#discussChartLoading").is(":visible"))return;if(b.attr("purpose")=="profile"||b.attr("purpose")=="notification"||b.attr("purpose")=="privacy")c.find("li.selected").removeClass("selected"),b.addClass("selected"),myAreaAllTabClick(b,"preference");else if(c.attr("purpose")=="profile"||c.attr("purpose")=="notification"||c.attr("purpose")=="privacy")c.parent("ul").find("li.selected").removeClass("selected"),c.addClass("selected"),myAreaAllTabClick(c,"preference");else if(b.is('input[purpose="save"]')||c.is('input[purpose="save"]'))updateUserPreference();else if(c.is('li[purpose="avat_Image"]')){$("#user_IamImage").find("div.profilePhotoSelected").removeClass("profilePhotoSelected").addClass("profilePhoto"),$("#user_AvatarImage").find("li.selected").removeClass("selected"),c.addClass("selected");var f=b.attr("src");$("#userPreferencePhotoCont").find("img").attr("src",f),$("#user_Photo").attr("value","Avatar"),$("#userSelectedAvatarImage").val(f),$("#userSelectedProfileImage").val(""),$("#zohoAccounts").removeAttr("purpose"),$("#myComputer").removeAttr("purpose")}else if(b.is("#myComputer"))$("#zohoAccountMess").remove(),$("#uploadPhotoCont").remove(),$("#curr_UploadPhoto_Cont").remove(),$("#fgid").remove(),$("#allAvatarList").hide(),$("#myComputer").addClass("selected").siblings("li.selected").removeClass("selected"),insertBrowserOptionToUpload("userUpload",d);else if(b.is("#zohoAccounts"))$("#zohoAccountMess").remove(),$("#curr_UploadPhoto_Cont").remove(),$("#fgid").remove(),$("#uploadPhotoCont").remove(),$("#curr_UploadPhoto_Cont").remove(),$("#allAvatarList").hide(),$("#zohoAccounts").addClass("selected").siblings("li.selected").removeClass("selected"),insertBrowserOptionToUpload("IAM",e);else if(b.is("#AvatarsList")){$("#zohoAccountMess").remove(),$("#uploadPhotoCont").remove(),$("#curr_UploadPhoto_Cont").remove(),$("#AvatarsList").addClass("selected").siblings("li.selected").removeClass("selected");if($("#fgid").length==0){var g=$('<input type = "hidden" id="fgid" name="forumGroupId" value="'+forumGroupId+'"/>');g.insertAfter($('#preferenceInnerContent > form > input[name="avatar"]')).show()}var h=$("#allAvatarList").find("li.selected").find("img").attr("src");$("#userSelectedAvatarImage").attr("value",h),$("#userSelectedProfileImage").attr("value",h),$("#allAvatarList").show(),avatarImageFocus($("#user_AvatarImage"))}else if(c.is('div[purpose="avat_Image"]')){$("#user_AvatarImage").find("li.selected").removeClass("selected"),c.removeClass("profilePhoto").addClass("profilePhotoSelected"),$("#userSelectedProfileImage").val("yes");var f=b.attr("src");$("#userPreferencePhotoCont").find("img").attr("src",f),$("#userSelectedAvatarImage").val(f),$("#zohoAccounts").removeAttr("purpose"),$("#myComputer").removeAttr("purpose")}$("#userNameChangePopUp").find('input[name="screenName"]').unbind("focus").focus(function(){$("#userNameChangePopUp").find("a.greenLink").show(),$("#userNameChangePopUp").find('span[purpose="showMsg"]').hide()})}function insertBrowserOptionToUpload(a,b){var c=$("#preferenceInnerContent").find("form").attr("userUploadPhotoUrl"),d=$("#preferenceInnerContent").find("form").attr("userIAMphoto");if(a=="IAM"){var e=$("#uploadPhoto_Cont"),f=e.clone();f.insertAfter($("#user_AvatarImage").find("ul")).show(),f.attr("id","curr_UploadPhoto_Cont"),f.attr("purpose","userPhotoTemplate"),f.find('div[purpose="uploadPhotoContent"]').wrap('<form action = "/uploadUserPhoto.do" style="margin-left:230px;margin-top:-30px;margin-right:100px;" target = "fileUpdTgt_user" method="post" enctype="multipart/form-data"></form>'),f.find("div.iFrameContainer").html('<iframe name = "fileUpdTgt_user"> </iframe>'),f.find("form").attr("target","fileUpdTgt_user");var g=$('<input type = "hidden"  name="forumGroupId" value="'+forumGroupId+'"/>');g.insertAfter($("#curr_UploadPhoto_Cont").find('div[purpose="uploadPhotoContent"]')),$("#curr_UploadPhoto_Cont").find('div[purpose="uploadName"]').html(i18n["zohodiscussions.userProfile.zohoImage"]),f.find(":file").change(function(){f.find('[purpose="uploadPhotoLoadingCont"]').show(),f.find(':input[name="attacher"]').val(""),f.find("form").get(0).submit()});var h=$("#zohoAccounts").attr("purpose"),i="profilePhoto";typeof h!="undefined"&&(i="profilePhotoSelected");var j=$('<div class="'+i+'"  imgpurpose="IAMPhotoSelected"><img height="48" width="48" purpose="avat_Image" src="'+d+'"/></div>');j.insertBefore($("#curr_UploadPhoto_Cont").find("form")),$('<div class="boldText" style="margin-left:120px;margin-top:-45px;margin-right:100px;">'+i18n["zohodiscussions.userpreference.changePhoto"]+":</div>").insertAfter($("#curr_UploadPhoto_Cont").find('div[imgpurpose="IAMPhotoSelected"]')),$("#curr_UploadPhoto_Cont").find('div[imgpurpose="IAMPhotoSelected"]').click(function(){var a=$("#preferenceInnerContent").find("form").attr("userIAMphoto");$("#userPreferencePhotoCont").find("img").attr("src",a);var b=$("#userPreferencePhotoCont").attr("currentPref");if(b="userUpload")$("#myComputer").removeAttr("purpose"),$("#zohoAccounts").attr("purpose","iamUploadselected");$("#user_Photo").attr("value","IAM"),$("#allAvatarList").find("li.selected").removeClass("selected"),$("#curr_UploadPhoto_Cont").find("div.profilePhoto").removeClass("profilePhoto").addClass("profilePhotoSelected")}),$("#iamImageSize").show().siblings().hide(),$('<div id="zohoAccountMess" style="padding:50px;margin-left:50px;"><p class="innerInfo tinyText"><span>'+i18n["zohodiscussions.userpreference.uploadzohoAccountMess"]+"</span></p></div>").insertAfter($("#curr_UploadPhoto_Cont"))}else if(a=="userUpload"){var e=$("#uploadPhoto_Cont"),k=e.clone();k.insertAfter($("#user_AvatarImage").find("ul")).show(),k.attr("id","uploadPhotoCont"),k.attr("purpose","uploadUserPhotoTemplate"),k.find('div[purpose="uploadPhotoContent"]').wrap('<form action = "/uploadCustomFile.do" style="margin-left:230px;margin-top:-30px;margin-right:100px;" target = "fileUpdTgt_user" method="post" enctype="multipart/form-data"></form>'),k.find(':input[type="file"]').attr("name","imageFileName"),k.find("div.iFrameContainer").html('<iframe name = "fileUpdTgt_user"> </iframe>'),k.find("form").attr("target","fileUpdTgt_user");var g=$('<input type = "hidden"  name="forumGroupId" value="'+forumGroupId+'"/>'),l=$('<input type = "hidden"  name="portalzaid" value="'+discussionsZaid+'"/>'),m=$(' <input type="hidden" value="uploadUserPhoto" name="purpose"/>');g.insertAfter($("#uploadPhotoCont").find('div[purpose="uploadPhotoContent"]')),l.insertAfter($("#uploadPhotoCont").find('div[purpose="uploadPhotoContent"]')),m.insertAfter($("#uploadPhotoCont").find('div[purpose="uploadPhotoContent"]')),k.find(":file").change(function(){k.find('[purpose="uploadPhotoLoadingCont"]').show(),k.find("form").get(0).submit()});var h=$("#myComputer").attr("purpose"),i="profilePhoto";typeof h!="undefined"&&(i="profilePhotoSelected");var j=$('<div class="'+i+'" imgpurpose="userUploadedPhotoSelected"><img height="48" width="48" purpose="avat_Image" src="'+c+'"/></div>');j.insertBefore($("#uploadPhotoCont").find("form")),$('<div class="boldText" style="margin-left:120px;margin-top:-45px;margin-right:100px;">'+i18n["zohodiscussions.userpreference.changePhoto"]+":</div>").insertAfter($("#uploadPhotoCont").find('div[imgpurpose="userUploadedPhotoSelected"]')),$("#uploadPhotoCont").find('div[imgpurpose="userUploadedPhotoSelected"]').click(function(){var a=$("#preferenceInnerContent").find("form").attr("userUploadPhotoUrl");$("#uploadPhotoCont").find("div.profilePhoto").removeClass("profilePhoto").addClass("profilePhotoSelected"),$("#userPreferencePhotoCont").find("img").attr("src",a),$("#user_Photo").attr("value","userUpload"),$("#allAvatarList").find("li.selected").removeClass("selected");var b=$("#userPreferencePhotoCont").attr("currentPref");if(b="IAM")$("#zohoAccounts").removeAttr("purpose"),$("#myComputer").attr("purpose","userUploadselected")}),$("#customImageSize").show().siblings().hide()}}function uploadUserPhoto(a,b){$("#curr_UploadPhoto_Cont").find('img[purpose="uploadPhotoLoadingCont"]').remove();if(a=="failure")showMessage(b+" ,Please try again.","failure");else{$("#curr_UploadPhoto_Cont").find('input[name="uploadPhotoFile"]').val("");var c=$("#preferenceInnerContent").find("form").attr("photoUrl"),d=c+"/file?t=user&width=48&height=48&ID="+ZUID+"&nocache=1";$("#curr_UploadPhoto_Cont").find('img[purpose="avat_Image"]').attr("src",d),$("#userSelectedAvatarImage").attr("value",d),$("#userSelectedProfileImage").attr("value",d),$("#preferenceInnerContent").find("form").attr("userIAMphoto",d),$("#userPreferencePhotoCont").find("img").attr("src",d),$("#curr_UploadPhoto_Cont").find("div.profilePhoto").removeClass("profilePhoto").addClass("profilePhotoSelected"),$("#user_Photo").attr("value","IAM"),$("#allAvatarList").find("li.selected").removeClass("selected"),showTipper(i18n["zohodiscussions.userpreference.uploadsuccessMess"],"success",1e3),processHash("myArea/preference")}}function updateUserPreference(){if($("#userAvatarList").is(":focus")){var a=$("#imgContUl"),b=a.find("li.listAvatarSelected"),c=b.find("img").attr("src");a.find('input[name="avatar"]').val(c)}var d=$("#wikiUrl"),e=$("#blogUrl"),f=$("#webSite"),g=sanitizeURL($.trim(""+d.val())),h=sanitizeURL($.trim(""+e.val())),i=sanitizeURL($.trim(""+f.val()));d.val(g),e.val(h),f.val(i);var j=$("#twitterLink"),k=$("#facebookLink"),l=$("#linkedinLink"),m=sanitizeURL($.trim(""+j.val())),n=sanitizeURL($.trim(""+k.val())),o=sanitizeURL($.trim(""+l.val()));j.val(m),k.val(n),l.val(o),doAjaxAction("/updateUserSetting.do",$("#preferenceInnerContent").find("form").serialize(),function(a){if(a=="SUCCESS"){showTipper(i18n["zohodiscussions.userpreference.userprofileupdated"],"success");var b=$("#userSelectedAvatarImage").val();$("#topContainerPhoto").find("img").attr("src",b),isEmbedService()?authorProfileEmbedClickAction("myarea"):processHash("myArea/preference")}},function(a){var b=toEvaluateData(a.responseText);showMessage(b.reason,"failure")})}function editDraftPost(a){showLoadingImage();var b=a.attr("authorId"),c=a.attr("forumTopicId"),d={};d.forumGroupId=forumGroupId,d.forumTopicId=c,d[csrfParamName]=csrfToken,d.editMode="true";var e=a.attr("forumId"),f=a.attr("categoryId");b==ZUID&&(d.access="author"),doAjaxAction("/editDraft.do",d,function(a){hideLoadingImage(),document.title=i18n["zohodiscussions.writePost.documentTitle"]+" - "+forumGroupName,$("#mainContent").get(0).innerHTML=a,$("#SelectForum").val(e),initWritePost(),$("#SelectCategory").val(f);if(isAutoSuggestEnabled){var b=$("#forumTags").val();b=b!=undefined?b.split(","):[];for(var c=0;c<b.length-1;c++)addTagsToContainer(b[c],$("#forumTags"),$("#forumallTags"))}},function(a){var b=toEvaluateData(a.responseText);showMessage(b.reason,"failure"),hideLoadingImage()})}function myJournalsDeletePost(a,b){var c=a.attr("authorId"),d=a.attr("action"),e={};e.forumGroupId=forumGroupId,e.forumId=a.attr("forumId"),e.categoryId=a.attr("categoryId"),e.forumTopicId=a.attr("forumTopicId"),e[csrfParamName]=csrfToken,d=="/deleteForumResponse.do"&&(e.responseId=a.attr("responseId")),c==ZUID&&(e.access="author"),doAjaxAction(d,e,function(b){hideLoadingImage(),d=="/deleteForumResponse.do"?showTipper(i18n["zohodiscussions.myJournals.successfullyTopicDeleted"],"success"):showTipper(i18n["zohodiscussions.myJournals.successfullyResponseDeleted"],"success"),a.parents("div.moderateSinglePost").hide()},function(a){var b=toEvaluateData(a.responseText);showMessage(b.reason,"failure"),hideLoadingImage()})}function myJournalsFilter(a,b){var c=a.attr("purpose"),d=$("#"+b+"InnerContent").find('div[status="show"]');d.attr("currFilterType",a.text()),d.attr("filterType",c),d.find("div.moderateSinglePost").hide();var e=-1;c=="all"?($listOfTypes=d.find("div.moderateSinglePost"),$listOfTypes.each(function(a,b){a<postPerPage&&$(b).show(),e=a})):($listOfTypes=d.find("div."+c),$listOfTypes.each(function(a,b){a<postPerPage&&$(b).show(),e=a})),b=="watchList"&&(b="watchTopic"),postPerPage>e||e==-1?$("#"+b+"Next").removeClass("navBtnEnabled").addClass("navBtnDisabled"):$("#"+b+"Next").removeClass("navBtnDisabled").addClass("navBtnEnabled");var f=$("#"+b+"Prev");f.removeClass("navBtnEnabled").addClass("navBtnDisabled"),f.parent("ul").attr("fetchPage",1),e==-1?($("#"+b+"FilterEmptyMsg").show(),$("#"+b+"_Nav").hide()):($("#"+b+"FilterEmptyMsg").hide(),$("#"+b+"_Nav").show())}function myJournalsFilterAction(a,b){var c=a.parent(),d=a.attr("purpose"),e=$("#"+b+"InnerContent").find('div[status="show"]'),f=a.text();e.attr("currFilterType",f);var g=$("#"+b+"Tab").find("li.selected").attr("purpose");showLoadingImage();var h=c.attr(g+"Action"),i={};i.forumGroupId=forumGroupId,i.userId=c.attr("userId"),i.filterType=f,i[csrfParamName]=csrfToken,doAjaxAction(h,i,function(a){hideLoadingImage(),e.get(0).innerHTML=a;if(b=="myJournals"){var c=$("#"+b+"SelectAction");c.find('li[purpose="expandedView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.expandView"]+"</a>"),c.find('li[purpose="listView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.listView"]+"</span>")}},function(a){var b=toEvaluateData(a.responseText);showMessage(b.reason,"failure"),hideLoadingImage()})}function replyToPrivateMsg(a){var b=$("#newReplyPrivateMsgCont");if(b.is(":visible")){showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info");return}var c=a.attr("postType"),d=a.attr("forumTopicId"),e=$("#privateMsgCont_"+d),f=$("#privateMsg"+c+"Container"),g="reply",h="Write",i=a.attr("toMember"),j=a.attr("purpose"),k=-1,l="";c=="Sent"&&$("#topicContent_"+d).hide(),e.show(),j=="editThisPM"?($("#PrivateMsgReply").hide(),$("#PrivateMsgEdit").show()):($("#PrivateMsgReply").show(),$("#PrivateMsgEdit").hide());var m=$("#replyPrivateMsgContent");b=m.clone(),b.attr("id","newReplyPrivateMsgCont"),b.find("#PrivateMsgReply").attr("id","newPrivateMsgReply"),b.find("#PrivateMsgEdit").attr("id","newPrivateMsgEdit"),b.find("#cancelPrivateReplyButton").attr("id","newcancelPrivateReplyButton");var g="",n=b.find('textarea[name="privateMsgContent"]'),o=b.find('input[name="toMemberName"]'),p=b.find('input[name="forumPostTitle"]'),q="",r=$("#privateMsg_"+d).html();return j=="editThisPM"?(k=a.attr("responseId"),o.parent().hide(),q=a.attr("postTitle"),p.val(q),g="/editPrivateMsg.do",$("#privateMsg_"+d).hide()):(l=a.attr("toMemberName"),o.val(l),p.parent().hide(),g="/replyToPM.do"),n.val(r),b.find('input[name="toMember"]').val(i),b.find('input[name="forumTopicId"]').val(d),b.find('input[name="responseId"]').val(k),e.append(b.show()),$("#newPrivateMsgReply, #newPrivateMsgEdit").unbind("click").click(function(){if(j=="editThisPM"){var a=$.trim(p.val());if(a==""){showMessage(i18n["zohodiscussions.writePost.noTitleInPost"],"failure");return}}var c=$.trim(n.val());if(c==""){showMessage(i18n["zohodiscussions.writePost.noContentInPost"],"failure");return}doAjaxAction(g,b.find("form").serialize(),function(a){showTipper(i18n["zohodiscussions.privateMsg.successfullyPMAdded"],"success"),j=="editThisPM"?($("#privateMsg_"+d).html(n.val()),$("#topicContent_"+d).html(n.val()),$("#editPrivateMsg_"+d).attr("postTitle",p.val()),$("#privateMsgPostTitle_"+d).html(p.val()),$("#newcancelPrivateReplyButton").trigger("click")):processHash("myArea/privateMsg")},function(a,c,d){b.find("div#writePMCaptcha").attr("id","newWritePMCaptcha");var e=toEvaluateData(a.responseText);if(e.errorcode=="HIP_REQUIRED"){var f=$("#newWritePMCaptcha");f.find("input#captchaCodePM").attr("id","newCaptchaCodePM"),f.show(),f.attr("currCaptcha")=="new"?showMessage(i18n["zohodiscussions.writePost.captchaMsg"],"failure"):showMessage(i18n["zohodiscussions.writePost.captchaErrorMsg"],"failure"),f.find('img[purpose="captchaImage"]').replaceWith("<img purpose=captchaImage name=hipImg border=0 src=/showcaptcha?digest="+e.reason+" align=absmiddle alt=HIP image>"),$("#newCaptchaCodePM").attr("name",e.reason),f.attr("currCaptcha","old"),f.show()}else showMessage(e.reason,"failure");hideLoadingImage()})}),$("#newcancelPrivateReplyButton").click(function(){$("#privateMsgCont_"+d).hide(),b.remove(),j=="editThisPM"&&$("#privateMsg_"+d).show()}),!1}function addPrivateMsg(a,b,c,d){showLoadingImage();if(d=="UserPM"){var e=$("#privateMsgTab").find("li.selected");e.attr("isthere","false")}var f=$("#postContentTA"),g="";if(b&&b=="Edit"){g=f.parent().find('input[name="forumPostTitle"]').val(),g=g.replace(/^\s+/g,"").replace(/\s+$/g,"");if(g==""){hideLoadingImage(),showMessage(i18n["zohodiscussions.writePost.noTitleInPost"],"failure");return}}var h=f.data("editor").val();h=h.replace(/^\s+/g,"").replace(/\s+$/g,"");if(h==""){hideLoadingImage(),showMessage(i18n["zohodiscussions.writePost.noContentInPost"],"failure");return}f.val(h);var i=b&&b=="Edit"?"/editPrivateMsg.do":d=="UserPM"?"/addPrivateMsg.do":"/replyToPM.do";return doAjaxAction(i,$("#editorHolder").serialize(),function(c){hideLoadingImage(),showTipper(i18n["zohodiscussions.privateMsg.successfullyPMAdded"],"success");if(b=="Edit"){var e=$("#privateMsgCont_"+a).parent("li");e.find('a[purpose="postConversationTitle"]').html(g),$("#cancelResponse").trigger("click")}else if(d=="UserPM"){var f=$("#UserPM").attr("authorName");processHash("user/"+f)}else processHash("myArea/privateMsg")},function(a,b,c){var d=toEvaluateData(a.responseText);if(d.errorcode=="HIP_REQUIRED"){var e=$("#replyPMContActual").show().find('div[purpose="responseCaptcha"]');e.find(":input").val(""),e.attr("currCaptcha")=="new"?showMessage(i18n["zohodiscussions.writePost.captchaMsg"],"failure"):showMessage(i18n["zohodiscussions.writePost.captchaErrorMsg"],"failure"),e.find('img[purpose="captchaImage"]').replaceWith("<img purpose=captchaImage name=hipImg border=0 src=/showcaptcha?digest="+d.reason+" align=absmiddle alt=HIP image>"),e.find(":input").attr("name",d.reason),e.attr("currCaptcha","old"),e.show()}else showMessage(d.reason,"failure");hideLoadingImage()}),!1}function deletePrivateMsg(a){var b=a.attr("forumTopicId"),c={};c.forumGroupId=forumGroupId,c.forumTopicId=b,c[csrfParamName]=csrfToken,doAjaxAction("/deletePM.do",c,function(a){hideLoadingImage(),showTipper(i18n["zohodiscussions.privateMsg.successfullyPMDeleted"],"success");var b=$("#privateMsgTab").find("li.selected");b.attr("purpose")=="inbox"?processHash("myArea/privateMsg"):b.attr("isthere","false").trigger("click")},function(a){var b=toEvaluateData(a.responseText);showMessage(b.reason,"failure"),hideLoadingImage()})}function privateConversation(a){var b=a.attr("forumTopicId"),c=$("#privateConversation_"+b).html(),d=$("#privateConversation");d.show(),$("#privateConversationCont").get(0).innerHTML=c,$("#privateConversationClose").unbind("click").click(function(){d.hide();return}),$("#morePrivateConversation").unbind("click").click(function(){d.hide(),showLoadingImage(),openSinglePost(b);return})}function friendsTabClick(a){a.addClass("selected"),showLoadingImage();var b=a.attr("purpose"),c=a.attr("action"),d={};d.forumGroupId=forumGroupId,doAjaxAction(c,d,function(a){hideLoadingImage(),$("#friendsInnerCont").get(0).innerHTML=a,setPresenceInMyArea(dataOb,"friendsDetailsInnerContent")})}function myAreaAllTabClick(a,b){var c=$("#"+b+"InnerContent"),d=c.find('div[status="show"]');a.addClass("selected");var e=a.attr("purpose");e=="resources"?$("#myAreaInnerMainContent").find("div.contentActionsCont").hide():$("#myAreaInnerMainContent").find("div.contentActionsCont").show();var f=a.attr("isthere"),g=c.find('div[purpose="author_'+e+'"]');d.attr("status","hide").hide(),b=="authorProfile"&&(e=="privateMsg"?$("#authorProfileContentAction").hide():$("#authorProfileContentAction").show()),b=="watchList"&&(e!="watchTopics"?$("#"+b+"_Filter").parent().hide():$("#"+b+"_Filter").parent().show());if(b=="myJournals"||b=="privateMsg"||b=="authorProfile"){var h=$("#"+b+"SelectAction");if(f=="true"){if(b=="myJournals"||b=="authorProfile"){var i=$("#"+b+"_Filter");if(e=="replies"||e=="authorReplies")i.parent().hide();else{i.parent().show();var j=g.attr("currFilterType");i.val(j)}}g.attr("status","show").show(),g.find("div.collapse").length>0?(h.find('li[purpose="expandedView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.expandView"]+"</a>"),h.find('li[purpose="listView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.listView"]+"</span>")):g.find("div.expand").length>0&&(h.find('li[purpose="expandedView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.expandView"]+"</span>"),h.find('li[purpose="listView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.listView"]+"</a>"));if(b=="privateMsg"&&typeof WmsContacts!="undefined"&&ch=="true"){var k=WmsContacts.getZohoContacts();setPresenceInMyArea(k,"userChat_"+e)}return}}else if(f=="true"){g.attr("status","show").show();if(b=="watchList"&&typeof WmsContacts!="undefined"&&ch=="true"){var k=WmsContacts.getZohoContacts();setPresenceInMyArea(k,"userChat_"+e)}return}showLoadingImage();var e=a.attr("purpose"),l=a.attr("action"),m={};if(e!="privateMsg"){m.forumGroupId=forumGroupId,m[csrfParamName]=csrfToken;if(b=="myJournals"||b=="authorProfile")m.userId=a.attr("userId")}b=="myJournals"&&(m.viewType="myself"),doAjaxAction(l,m,function(c){hideLoadingImage();var f;if(b=="myJournals"||b=="authorProfile"){f=$("<div purpose=author_"+e+" status=show currFilterType=all></div>").html(c);var g=$("#"+b+"_Filter");e=="replies"||e=="authorReplies"?g.parent().hide():(g.parent().show(),g.val("All"))}else f=$("<div purpose=author_"+e+" status=show id=userChat_"+e+"></div>").html(c);hideLoadingImage(),showAuthorPopout(f),f.insertAfter(d),a.attr("isthere","true"),e==="drafts"||e==="inbox"||e==="sent"||e==="authorTopics"||e==="replies"?(h.find('li[purpose="expandedView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.expandView"]+"</a>"),h.find('li[purpose="listView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.listView"]+"</span>")):e==="authorReplies"&&(h.find('li[purpose="expandedView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.expandView"]+"</span>"),h.find('li[purpose="listView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.listView"]+"</a>"));if(b=="privateMsg"||b=="watchList")if(typeof WmsContacts!="undefined"&&ch=="true"){var i=WmsContacts.getZohoContacts();setPresenceInMyArea(i,"userChat_"+e)}},function(a){var b=toEvaluateData(a.responseText);showMessage(b.reason,"failure"),hideLoadingImage()})}function manageExpandOrCollapseType(a,b){var c=a.attr("purpose");if(a.find("a").length<1)return;var d=$("#"+b+"InnerContent"),e=$("#"+b+"SelectAction"),f=d.find('div[status="show"]');c=="expandedView"?(f.find("div.collapse").attr("class","expand"),f.find("div.expand div.bigPlusIcon").removeClass("bigPlusIcon").addClass("bigMinusIcon"),f.find("div.textContent").addClass("expandTextContent").show(),f.find("div.moderateSinglePost div.lowerButton").show(),e.find('li[purpose="expandedView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.expandView"]+"</span>"),e.find('li[purpose="listView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.listView"]+"</a>")):c=="listView"&&(f.find("div.expand").attr("class","collapse"),f.find("div.collapse div.bigMinusIcon").removeClass("bigMinusIcon").addClass("bigPlusIcon"),f.find("div.textContent").addClass("expandTextContent").hide(),f.find("div.moderateSinglePost div.lowerButton").hide(),e.find('li[purpose="expandedView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.expandView"]+"</a>"),e.find('li[purpose="listView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.listView"]+"</span>"));return}function manageCountValue(a){var b=$("#"+a).find("li.selected"),c=b.attr("count");c=--c;var d=b.attr("purpose");d=="watchTopics"?b.find("a").html(i18n["zohodiscussions.myJournals.topics"]+"("+c+")"):d=="authorReplies"?b.find("a").html(i18n["zohodiscussions.general.replies"]+"("+c+")"):d=="watchUsers"?b.find("a").html(i18n["zohodiscussions.watchList.users"]+"("+c+")"):d=="inbox"?b.find("a").html(i18n["zohodiscussions.privateMsg.inbox"]+"("+c+")"):d=="sent"?b.find("a").html(i18n["zohodiscussions.privateMsg.sent"]+"("+c+")"):d=="watchForums"?b.find("a").html(i18n["zohodiscussions.general.forums"]+"("+c+")"):d=="watchCategories"&&b.find("a").html(i18n["zohodiscussions.myArea.subForums"]+"("+c+")"),b.attr("count",c)}function fnPagination(a,b,c){showLoadingImage();var d=a.attr("action"),e=a.attr("currType"),f={};c=="true"&&(e="authorProfile");var g=$("#"+e+"InnerContent").find('div[status="show"]');f.forumGroupId=forumGroupId;if(e!="privateMsg"){f.userId=a.attr("userId");var h=$("#"+e+"Tab").find("li.selected").attr("purpose");if(h=="topics"||h=="drafts"||h=="authorTopics")f.filterType=g.attr("currfiltertype")}e=="myJournals"&&(f.viewType="myself");var i=parseInt(a.attr("fetchPage"));b=="next"?f.fetchPage=i+1:f.fetchPage=i-1,f.getPostFor=a.attr("getPostFor"),doAjaxAction(d,f,function(a){hideLoadingImage(),g.get(0).innerHTML=a;var b=$("#"+e+"Tab").find("li.selected").attr("purpose"),c=$("#"+e+"SelectAction");b=="replies"?(c.find('li[purpose="expandedView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.expandView"]+"</span>"),c.find('li[purpose="listView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.listView"]+"</a>")):(c.find('li[purpose="expandedView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.expandView"]+"</a>"),c.find('li[purpose="listView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.listView"]+"</span>"))},function(a){var b=toEvaluateData(a.responseText);showMessage(b.reason,"failure"),hideLoadingImage()})}function fnPaginationProcess(a,b){var c=parseInt(a.attr("fetchPage")),d=a.attr("currType"),e=a.attr("postCount");b=="next"?c+=1:c-=1,a.attr("fetchPage",c);var f=$("#current_"+d+"_List"),g=c*postPerPage,h=g-postPerPage+1,i=h;e<=g?(g=e,a.find('li[purpose="next"]').removeClass("navBtnEnabled").addClass("navBtnDisabled")):a.find('li[purpose="next"]').removeClass("navBtnDisabled").addClass("navBtnEnabled"),h==1?a.find('li[purpose="prev"]').removeClass("navBtnEnabled").addClass("navBtnDisabled"):a.find('li[purpose="prev"]').removeClass("navBtnDisabled").addClass("navBtnEnabled");if(d=="recentActivity"){f.find("li").hide();for(i;i<=g;i++)$("#recentActivity_"+i).show()}else{f.find("div.moderateSinglePost").hide();var j=d;d=="watchTopic"&&(d="watchList");var k=$("#"+d+"InnerContent").find('div[status="show"]').attr("filterType");if(d!="watchList"&&d!="bookMark"||k=="all")for(i;i<=g;i++)f.find('div.moderateSinglePost[listStage="'+j+"_"+i+'"]').show();else{var l;$listOfTypes=f.find("."+k),i--,$listOfTypes.each(function(a,b){a<g&&i<=a&&$(b).show(),l=a})}}}function getAuthorProfile(a){showLoadingImage();var b=$("#userProfileMainContainer");if(b.length>0&&b.is('[shouldReload="false"]'))b.show().attr("shouldReload","true").siblings().remove(),hideLoadingImage();else{var c={};c.forumGroupId=forumGroupId,c.authorName=a,c[csrfParamName]=csrfToken,c.ch=ch,doAjaxAction("/getAuthorProfile.do",c,function(b){hideLoadingImage(),$("#authorPopout:visible").hide(),$("#mainContent").get(0).innerHTML=b,$.history.add("User/"+a),bindAuthorProfileActions(a)},function(a){var b=toEvaluateData(a.responseText);showMessage(b.reason,"failure"),hideLoadingImage()})}}function bindAuthorProfileActions(a){$("#mainContent").unbind("click",processAuthorProfileClick).click(processAuthorProfileClick),$("#mainContent").unbind("click",processAllMyAreaMainClick).click(processAllMyAreaMainClick),$("#mainContent").unbind("click",processAllActionClick).click(processAllActionClick),lightBox("#authorProfileInnerContent"),allFilterOption("authorProfile"),lightBox("#authorProfileInnerContent");var b=$("#mainContent > #userProfileMainContainer").attr("authorId");$("#authorPopout_"+b).hide();if(typeof WmsContacts!="undefined"&&ch=="true"&&!isTopicQuickView){var c=WmsContacts.status(b);c===!1&&(c=9),manageUserChatStatus("userOnlineStatus_"+b,c)}initialiseUserActivityChart()}function processAuthorProfileClick(a){var b=$(a.target),c=b.parent();if($("#loadingImg").is(":visible")||$("#discussChartLoading").is(":visible"))return;c.is('li[purpose="sendPM"]')?addPrivateMessage(c):c.is('li[purpose="watchItem"]')?watchItem(c):c.is('li[purpose="addAsFriend"]')?addAsFriend(c):c.is('li[purpose="blockUser"]')?blockUser(c):c.is('li[purpose="unBlockUser"]')?unBlockUser(c):c.is('li[purpose="moderateUser"]')?moderateUser():c.is('li[purpose="assignLabel"]')&&bindUserLabelsAction()}function writePrivateMsg(){var a=$("#sentPrivateMsg"),b=$("#editorContainer_PM");if(b.data("inEditMode"))return showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"failure"),!1;a.show(),openEditor($("#editPM"),"privateMsgContent","postContentTA","UserPM","Write","editorContainer_PM"),b.data("inEditMode",!0)}function watchItem(a){showLoadingImage();var b=a.attr("watchItemType"),c={};c.forumGroupId=forumGroupId,c.watchItemType=b,c.watchItemId=a.attr("watchItemId"),c[csrfParamName]=csrfToken,doAjaxAction("/watchItem.do",c,function(c){hideLoadingImage();var d=b=="0"?"zohodiscussions.singlepost.watchTopicSuccessMsg":"zohodiscussions.generalmessage.userAddedToWatchlist";showTipper(i18n[d],"success"),a.attr("purpose","unWatchItem"),a.find("a").html(i18n["zohodiscussions.userProfile.unwatchUser"])},function(a){var b=toEvaluateData(a.responseText);showMessage(b.reason,"failure"),hideLoadingImage()})}function unWatchItem(a,b){showLoadingImage();var b=a.attr("unWatchType"),c=a.attr("watchItemId"),d={};d.forumGroupId=forumGroupId,d.watchItemId=c,d[csrfParamName]=csrfToken,doAjaxAction("/unWatch.do",d,function(d){hideLoadingImage(),b=="authorProfile"?(showTipper(i18n["zohodiscussions.generalmessage.userRemovedFromWatchlist"],"success"),a.attr("purpose","watchItem"),a.find("a").html(i18n["zohodiscussions.userProfile.watchUser"])):b=="following"?(showTipper(i18n["zohodiscussions.generalmessage.userRemovedFromWatchlist"],"success"),$("#watch_"+c).parents("li").remove()):(showTipper(i18n["zohodiscussions.singlepost.unwatchTopicSuccessMsg"],"success"),a.parents("div#watch_"+c).remove(),manageCountValue("watchListTabs"))},function(a){var b=toEvaluateData(a.responseText);showMessage(b.reason,"failure"),hideLoadingImage()})}function addAsFriend(a){showLoadingImage();var b=a.attr("successMsg"),c={};c.forumGroupId=forumGroupId,c.userId=a.attr("userId"),c[csrfParamName]=csrfToken,doAjaxAction("/addAsFriend.do",c,function(c){hideLoadingImage(),c=="SUCCESS"&&(a.attr("purpose","friendWaitingApproval"),$("#addAsFriendLink").attr("style","cursor:default;text-decoration:none;").html(i18n["zohodiscussions.friends.awaitingApproval"]).siblings("div.imgAddFriend").removeClass("imgAddFriend").addClass("imgWaitingFriend"),showTipper(b,"success"))},function(a){var b=toEvaluateData(a.responseText);showMessage(b.reason,"failure"),hideLoadingImage()})}function confirmFriendRequest(a){showLoadingImage();var b=a.attr("userId"),c=a.attr("successMsg"),d={};d.forumGroupId=forumGroupId,d.userId=b,d[csrfParamName]=csrfToken,doAjaxAction("/confirmFriendRequest.do",d,function(a){hideLoadingImage(),showTipper(c,"info");var d=$("#friendId_"+b);if(d.length>0){var e=d.siblings("div.moderateSinglePost");d.fadeOut().remove(),$('#friendsDetailsTabs li.selected span[purpose="friendsCount"]').html(e.length);var f=$('#friendsDetailsTabs li span[mainPurpose="approvedFriends"]').text();f=parseInt(f),f++,$('#friendsDetailsTabs li span[mainPurpose="approvedFriends"]').html(f)}else location.reload()},function(a){var b=toEvaluateData(a.responseText);showMessage(b.reason,"failure"),hideLoadingImage()})}function removeFriend(a){var b=a.attr("confirmMsg");if(confirm(b)){showLoadingImage();var c=a.attr("userId"),d=a.attr("successMsg"),e={};e.forumGroupId=forumGroupId,e.userId=c,e[csrfParamName]=csrfToken,doAjaxAction("/removeFriend.do",e,function(a){hideLoadingImage(),showTipper(d,"info");var b=$("#friendId_"+c);if(b.length>0){var e=b.siblings("div.moderateSinglePost");b.fadeOut().remove(),$('#friendsDetailsTabs li.selected span[purpose="friendsCount"]').html(e.length)}else location.reload()},function(a){var b=toEvaluateData(a.responseText);showMessage(b.reason,"failure"),hideLoadingImage()})}}function blockUser(a){showLoadingImage();var b={};b.forumGroupId=forumGroupId,b.authorId=a.attr("authorId"),b[csrfParamName]=csrfToken,doAjaxAction("/blockUser.do",b,function(b){if(b==="SUCCESS")hideLoadingImage(),showTipper(i18n["zohodiscussions.userProfile.successfullyBlockUser"],"success"),a.attr("purpose","unBlockUser"),a.find("a").html(i18n["zohodiscussions.userProfile.unblockUser"]);else if(b.indexOf("'result':'failure'")>0){var c=toEvaluateData(b);showMessage(c.reason,"failure")}},function(a){var b=toEvaluateData(a.responseText);showMessage(b.reason,"failure"),hideLoadingImage()})}function unBlockUser(a){showLoadingImage();var b={};b.forumGroupId=forumGroupId,b.authorId=a.attr("authorId"),b[csrfParamName]=csrfToken,doAjaxAction("/unBlockUser.do",b,function(b){if(b==="SUCCESS")hideLoadingImage(),showTipper(i18n["zohodiscussions.userProfile.successfullyUnBlockUser"],"success"),a.attr("purpose","blockUser"),a.find("a").html(i18n["zohodiscussions.userProfile.blockUser"]);else if(b.indexOf("'result':'failure'")>0){var c=toEvaluateData(b);showMessage(c.reason,"failure")}},function(a){var b=toEvaluateData(a.responseText);showMessage(b.reason,"failure"),hideLoadingImage()})}function moderateUser(){$("#moderateUserTemplate").html($("#dimDivModerateUser").html()),$("#dimDivModerateUser").html(""),$("#moderateUserTemplate").show();var a=$("#eachForumListForModeration").find(":input[name='forumLevelModeration']"),b=$("#moderateUserPopOutForm").find(":input[name='portalLevelModeration']");a.length==0&&$("#forumLabel").hide(),b.attr("checked")&&a.attr("disabled",!0),$("#imgCancel").click(function(){var a=$(this),b=a.attr("authorName");if(isZSupport)authorProfileEmbedClickAction("user",b);else if(isTopicQuickView=="false"){location.href=serverURL+"/user/"+b;return}$("#dimDivModerateUser").html($("#moderateUserTemplate").html()),$("#moderateUserTemplate").hide(),$("#moderateUserTemplate").html("");var c=$("#moderateUserCont");if(c.attr("status")=="changed"){var d=$("#userProfileMainContainer");d.show().attr("shouldReload","true"),getAuthorProfile(b)}}),b.click(function(){$this=$(this),$this.attr("checked")?a.attr("disabled",!0):a.attr("disabled",!1),moderateUserAction($this)}),a.click(function(){$this=$(this),moderateUserAction($this)})}function moderateUserAction(a){var b=$("#moderateUserCont");b.attr("status","changed");var c=a.attr("authorId"),d=a.attr("userName"),e=a.attr("moderationStatus"),f=a.attr("isAdmin"),g=a.attr("isPortal"),h=0,i=!1,j="",k="",l={};l.authorId=c,l.forumGroupId=forumGroupId,l[csrfParamName]=csrfToken,l.adminUser=f;if(g)l.moderateType=1,e=="unmoderated"?(j=i18n["zohodiscussions.userProfile.moderateUserConfirmMess"]+" "+d+" "+i18n["zohodiscussions.userProfile.moderateUserPortalLevel"],k=i18n["zohodiscussions.userProfile.usermoderatedSuccessMess"]):(j=i18n["zohodiscussions.userProfile.unmoderateUserConfirmMess"]+" "+d+" "+i18n["zohodiscussions.userProfile.moderateUserPortalLevel"],k=i18n["zohodiscussions.userProfile.userUnmoderatedSuccessMess"]);else{l.moderateType=0;var m=a.attr("forumId");l.forumId=m;var n=a.attr("forumName");e=="unmoderated"?(j=i18n["zohodiscussions.userProfile.moderateUserConfirmMess"]+" "+d+" "+i18n["zohodiscussions.general.in"]+" "+n+" "+i18n["zohodiscussions.userProfile.moderateUserForumLevel"],k=" "+i18n["zohodiscussions.userProfile.usermoderatedSuccessMess"]):(j=i18n["zohodiscussions.userProfile.unmoderateUserConfirmMess"]+" "+d+" "+i18n["zohodiscussions.general.in"]+" "+n+" "+i18n["zohodiscussions.userProfile.moderateUserForumLevel"],k=i18n["zohodiscussions.userProfile.userUnmoderatedSuccessMess"])}if(e=="unmoderated")if(confirm(j))doAjaxAction("/moderateUser.do",l,function(b){b=="SUCCESS"?(showTipper(d+" "+k,"success",1e3),a.attr("moderationStatus","moderated"),$("#imgCancel").trigger("click"),g||$("#itemListCont_"+m).find("span.italicText").html(i18n["zohodiscussions.moderationLeftContainer.moderated"])):showMessage(i18n["zohodiscussions.moderationAction.errormessage"],"failure")});else{var b=$("#moderateUserCont");b.attr("status",""),g?($("#moderateUserPopOutForm").find(":input[isPortal='true']").attr("checked",!1),$("#eachForumListForModeration").find(":input[name='forumLevelModeration']").attr("disabled",!1)):$("#moderateUserPopOutForm").find(":input[forumId='"+m+"']").attr("checked",!1)}else if(confirm(j))doAjaxAction("/unModerateUser.do",l,function(b){b=="SUCCESS"?(showTipper(d+" "+k,"success",1e3),a.attr("moderationStatus","unmoderated"),$("#imgCancel").trigger("click"),g||$("#itemListCont_"+m).find("span.italicText").html(i18n["zohodiscussions.ModerateUsers.ModerateUsers"])):showMessage(i18n["zohodiscussions.moderationAction.errormessage"],"failure")});else{var b=$("#moderateUserCont");b.attr("status",""),g?($("#moderateUserPopOutForm").find(":input[isPortal='true']").attr("checked",!0),$("#eachForumListForModeration").find(":input[name='forumLevelModeration']").attr("disabled",!0)):$("#moderateUserPopOutForm").find(":input[forumId='"+m+"']").attr("checked",!0)}}function bindUserLabelsAction(){$("#userLabelsTemplate").html($("#dimDivUserLabels").html()),$("#dimDivUserLabels").html(""),$("#userLabelsTemplate").show(),$("#closeUserLabelsDialog").click(function(){$("#dimDivUserLabels").html($("#userLabelsTemplate").html()),$("#userLabelsTemplate").hide(),$("#userLabelsTemplate").html("")}),$('#userLabelsCont select[purpose="userLabelBox"]').change(function(){var a=$(this),b=a.attr("forumId"),c=a.attr("userId"),d=a.val(),e={};e.forumGroupId=forumGroupId,e.forumId=a.attr("forumId"),e.userId=a.attr("userId"),e.labelId=a.val(),e[csrfParamName]=csrfToken,doAjaxAction("/mapLabelToUser.do",e,function(b){if(b=="SUCCESS"){a.find("option[selected]").removeAttr("selected");var c=a.find("option[value='"+d+"']"),e=c.text();c.replaceWith("<option value='"+d+"' selected>"+e+"</option>"),d=="-1"?showTipper(i18n["zohodiscussions.UserDetails.labelRemovedMsg"],"info"):showTipper(i18n["zohodiscussions.UserDetails.labelAddedMsg"],"success")}})})}function setPresenceInTopicList(a,b){if(!a)return;var c="";b?(c=$("#SinglePostContainer_"+b+" div.sppostAuthor div.authorChatPresence"),c.each(function(c,d){var e=$(d),f=e.attr("authorId");if(f==ZUID)return;var g=e.attr("responseId"),h="";h=$("#uc_"+b+"_"+g+"_"+f+",#ucReply_"+b+"_"+g+"_"+f);try{var i=a[f].STATUS;manageUserChatStatusInTopicList(h,i,"IS_SINGLE_POST")}catch(j){}})):($("#topicList").length>0?c=$("#topicList > div.ndtopicsItemsContainer > div.ndwrapperIn > ul.ndtopicsList > li.ndsingleList > div.ndhideOverflow > p.ndPostMeta > img.authorChatPresence"):c=$("#topicsList > div.ndtopicsItemsContainer > div.ndwrapperIn > ul.ndtopicsList > li.ndsingleList > div.ndhideOverflow > p.ndPostMeta > img.authorChatPresence"),$stickyPostAuthors=$("#recentStickyPosts >li  >div.ashColorText >div.authorChatPresence"),$announcementPostAuthors=$("#recentAnnouncementPosts >li  >div.ashColorText >div.authorChatPresence"),c.each(function(b,c){var d=$(c),e=d.attr("authorId");if(e==ZUID)return;var f=d.attr("userChatId"),g="";g=$("#uc_"+f+"_"+e);try{var h=a[e].STATUS;manageUserChatStatusInTopicList(g,h,"topicList")}catch(i){}}),$stickyPostAuthors.each(function(b,c){var d=$(c),e=d.attr("authorId");if(e==ZUID)return;try{var f=a[e].STATUS;manageUserChatStatusInTopicList(d,f)}catch(g){}}),$announcementPostAuthors.each(function(b,c){var d=$(c),e=d.attr("authorId");if(e==ZUID)return;try{var f=a[e].STATUS;manageUserChatStatusInTopicList(d,f)}catch(g){}}))}function setPresenceInMyArea(a,b){if(!a)return;var c="";b=="current_recentActivity_List"?c=$("#"+b+" >li >div.authorChatPresence"):b=="userChat_inbox"||b=="userChat_sent"?c=$("#"+b+" div.moderateSinglePost ul li img.authorChatPresence"):c=$("#"+b+" div.moderateSinglePost ul li div.authorChatPresence"),c.each(function(b,c){var d=$(c),e=d.attr("authorId");if(e==ZUID)return;try{var f=a[e].STATUS;manageUserChatStatusInTopicList(d,f)}catch(g){}})}function setPresence(a,b){if(!a)return;var c=$("#"+b+" > li > div.userChatPresence");c.each(function(b,c){var d=$(c),e=d.attr("authorId");if(e==ZUID)return;var f=d.attr("id");try{var g=a[e].STATUS;manageUserChatStatus(f,g)}catch(h){}})}function manageUserChatStatus(a,b){var c=$("#"+a),d=c.attr("authorName");b=="4"?(c.find("div").attr("class","wms-4 chatOverride flLeft").unbind("click",chatInvoker).click(chatInvoker),c.find("a").html(i18n["zohodiscussions.chat.idleForChat"]),c.attr("title",d+" "+i18n["zohodiscussions.chat.isNowIdle"]).unbind("click",chatInvoker).click(chatInvoker)):b=="3"?(c.find("div").attr("class","wms-3 chatOverride flLeft").unbind("click",chatInvoker).click(chatInvoker),c.find("a").html(i18n["zohodiscussions.chat.busyforchat"]),c.attr("title",d+" "+i18n["zohodiscussions.chat.isBusyToChat"]).unbind("click",chatInvoker).click(chatInvoker)):b=="1"?(c.find("div").attr("class","wms-1 chatOverride flLeft"),c.find("a").html(i18n["zohodiscussions.chat.availableforchatmessage"]),c.attr("title",d+" "+i18n["zohodiscussions.chat.isAvailableToChat"]).unbind("click",chatInvoker).click(chatInvoker)):b=="0"?(c.find("div").attr("class","wms-0 chatOverride flLeft"),c.find("a").html(i18n["zohodiscussions.chat.offlineforchat"]).unbind("click",chatInvoker).click(chatInvoker),c.attr("title",i18n["zohodiscussions.chat.offlineforchat"]).unbind("click",chatInvoker).click(chatInvoker)):b=="-1"?(c.find("div").attr("class","imgAddContact flLeft"),c.find("a").html(i18n["zohodiscussions.chat.invitedforchat"]),c.attr("title",i18n["zohodiscussions.chat.youHaveInvited"]+" "+d+" "+i18n["zohodiscussions.chat.toChat"]).unbind("click",chatInvoker)):b=="-3"&&(c.find("div").attr("class","imgAddContact flLeft"),c.find("a").html(i18n["zohodiscussions.chat.acceptinvitationforchat"]),c.attr("title",d+" "+i18n["zohodiscussions.chat.youHaveInvited"]).unbind("click",chatInvoker)),c.find("div").unbind("click",chatInvoker).click(chatInvoker),c.find("a").unbind("click",chatInvoker).click(chatInvoker)}function manageUserChatStatusInTopicList(a,b,c){var d=0;b=="4"?(d=1,a.attr("class","wms-4 flLeft").unbind("click",chatInvoker).click(chatInvoker),c=="IS_SINGLE_POST"&&a.find('div[purpose="chatStatus"]').html(i18n["zohodiscussions.chat.busy"])):b=="3"?(d=1,a.attr("class","wms-3 flLeft").unbind("click",chatInvoker).click(chatInvoker),c=="IS_SINGLE_POST"&&a.find('div[purpose="chatStatus"]').html(i18n["zohodiscussions.chat.idle"])):b=="1"?(d=1,a.attr("class","wms-1 flLeft").unbind("click",chatInvoker).click(chatInvoker),c=="IS_SINGLE_POST"&&a.find('div[purpose="chatStatus"]').html(i18n["zohodiscussions.chat.available"])):b=="0"?(d=1,a.attr("class","wms-0 flLeft").unbind("click",chatInvoker).click(chatInvoker),c=="IS_SINGLE_POST"&&a.find('div[purpose="chatStatus"]').html(i18n["zohodiscussions.chat.offline"])):b=="-4"?a.attr("class","flLeft").unbind("click",chatInvoker):b=="-5"&&a.attr("class","flLeft").unbind("click",chatInvoker),c=="topicList"?d==1?a.addClass("authorChatPresence chatStyleOverride"):a.remove():a.addClass("authorChatPresence chatOverride")}function chatInvoker(){var a=$(this),b=a.attr("authorName"),c=a.attr("authorId");c==undefined&&(c=a.parent().attr("authorId"),b=a.parent().attr("authorName"));var d=WmsContacts.status(c);if(d>-1&&d!==!1){WebMessanger.chat(c);return}d==-1?confirm(b+" "+i18n["zohodiscussions.chat.reminder"])&&WmsContacts.add("zoho",b,ZUID):d==-3?WmsContacts.accept("zoho",b,ZUID):WmsContacts.add("zoho",b,ZUID)}function updatePresence(a,b,c){if(ch!="true")return;if($("#recentStickyPosts").is(":visible")){var d=$("#recentStickyPosts >li >div.ashColorText >div.authorChatPresence");d.each(function(b,d){var e=$(d),f=e.attr("authorId");f==a&&manageUserChatStatusInTopicList(e,c)})}if($("#recentAnnouncementPosts").is(":visible")){var d=$("#recentAnnouncementPosts >li >div.ashColorText >div.authorChatPresence");d.each(function(b,d){var e=$(d),f=e.attr("authorId");f==a&&manageUserChatStatusInTopicList(e,c)})}if($("#topicListMainContainer").is(":visible")){var e=$.parseJSON($("#uListForStatusUpdate").html()),f="z"+a;if(typeof e[f]!="undefined")for(i=0;i<e[f].length;i++){var g=$("#uc_"+e[f][i]+"_"+a);manageUserChatStatusInTopicList(g,c,"topicList")}if($("#singleForumHeaderView").is(":visible")){var h=$("#singleForumHeaderView").attr("forumId");manageUserChatStatus("moderatorOnlineStatus_"+h+"_"+a,c)}}else if($("#SinglePostContainer").is(":visible")){var j=$("#SinglePostContainer").attr("forumTopicId"),e=$.parseJSON($("#uListForStatusUpdate").html()),f="z"+a;if(typeof e[f]!="undefined")for(i=0;i<e[f].length;i++){var g=$("#uc_"+j+"_"+e[f][i]+"_"+a);manageUserChatStatusInTopicList(g,c,"IS_SINGLE_POST")}}else if($("#userProfileMainContainer").is(":visible"))manageUserChatStatus("userOnlineStatus_"+a,c);else if($("#myAreaInnerMainContent").is(":visible")){if($("#profileDetailCont").is(":visible")){manageUserChatStatus("followersOnlineStatus_"+a,c),manageUserChatStatus("followingOnlineStatus_"+a,c);var k=$("#current_recentActivity_List >li >div.authorChatPresence");k.each(function(b,d){var e=$(d),f=e.attr("authorId");f==a&&manageUserChatStatusInTopicList(e,c)})}else{var l="";if($("#watchListInnerContent").is(":visible")){var m=$("#watchListInnerContent").find('div[status="show"]');l=m.attr("id")}else if($("#privateMsgInnerContentent").is(":visible")){var m=$("#privateMsgInnerContent").find('div[status="show"]');l=m.attr("id")}if(l!=""){var k="";l=="privateMsgInnerContent"?k=$("#"+l+" div.moderateSinglePost ul li img.authorChatPresence"):k=$("#"+l+" div.moderateSinglePost ul li div.authorChatPresence"),k.each(function(b,d){var e=$(d),f=e.attr("authorId");f==a&&manageUserChatStatusInTopicList(e,c)})}}manageUserChatStatus("authorPopup_"+a,c)}}function addPrivateMessage(a){var b=a.attr("toMember"),c=a.attr("authorname"),d=$("#privateMsgPrompt"),e=$("#privateMsgToMemberArea"),f=$("#privateMsgTitleArea"),g=$("#privateMsgContentArea"),h=$("#privateMsgToMemberId");h.val(""),e.val(""),f.val(""),g.val(""),h.val(b),e.val(c),d.show().parent().show(),$("#cancelPrivateMsgButton, #cancelPrivateMsg").unbind("click").click(function(){e.val(""),f.val(""),g.val("");var a=$("#writePMCaptcha");a.find("img").attr("src","/images/spacer.gif"),a.find(":input").val(""),a.hide(),d.hide().parent().hide()}),$("#addNewPrivateMsg").unbind("click").click(function(){showLoadingImage();var a=g.val();a=a.replace(/^\s+/g,"").replace(/\s+$/g,"");if(a==""){hideLoadingImage(),showMessage(i18n["zohodiscussions.writePost.noContentInPost"],"failure");return}var b=f.val();b=b.replace(/^\s+/g,"").replace(/\s+$/g,"");if(b==""){hideLoadingImage(),showMessage(i18n["zohodiscussions.writePost.noTitleInPost"],"failure");return}doAjaxAction("/addPrivateMsg.do",d.find("form").serialize(),function(a){var b=$("#writePMCaptcha");b.find("img").attr("src","/images/spacer.gif"),b.find(":input").val(""),b.hide(),hideLoadingImage();if(a=="SUCCESS")showTipper(i18n["zohodiscussions.privateMsg.successfullyPMAdded"],"success");else{var c=toEvaluateData(a);showMessage(c.reason,"failure"),hideLoadingImage()}d.hide().parent().hide()},function(a){var b=toEvaluateData(a.responseText);if(b.errorcode=="HIP_REQUIRED"){var c=$("#writePMCaptcha");c.attr("currCaptcha")=="new"?showMessage(i18n["zohodiscussions.writePost.captchaMsg"],"failure"):showMessage(i18n["zohodiscussions.writePost.captchaErrorMsg"],"failure"),c.find('img[purpose="captchaImage"]').replaceWith("<img purpose=captchaImage name=hipImg border=0 src=/showcaptcha?digest="+b.reason+" align=absmiddle alt=HIP image>"),$("#captchaCodePM").attr("name",b.reason),c.attr("currCaptcha","old"),c.show()}else showMessage(b.reason,"failure");hideLoadingImage()})}),f.focus()}function myAreaEmbedClickAction(a,b){return isZSupport?(getMyAreaBindActions(b,"myarea"),!1):isTopicQuickView=="false"?(window.location.href=a,!1):!1}function authorProfileEmbedClickAction(a,b,c){if(typeof b==undefined||typeof b=="guest")return!1;if(typeof c==undefined||typeof c=="undefined")c="";if(isZIntranet)return;return a=="myarea"?(newMyAreaClick(forumGroupId),getMyAreaBindActions("dashboard",a,"niceurl"),!1):a=="user"?(c!=""?ZSupport.callBackUserAction(forumGroupId,"",c):ZSupport.callBackUserAction(forumGroupId,b),!1):isTopicQuickView=="false"?(window.location.href=actionURL,!1):!1}function Collaboration(){}function WmsContactImpl(){}function WmsliteImpl(){}function bindReportsClicks(a){var a=$("#reportsLeftPanel");a.unbind("click",processReportClick).click(processReportClick),$("#reportsDateFilterArrow,#allTypeTrendDateFilter,#postResponseDateFilter,#repUnrepDateFilter,#topicStatusDateFilter,#mostVotedTopicsArrow,#userParticipationDateFilter").click(function(){displayStatisticsArrowClick($(this))}),$("#forumDropDownArrow").unbind("click",processForumArrowClick).click(processForumArrowClick),bindDateFilterClick($("#dateFilterCont").find("button")),avtivateReportsCalendar(),showOverallUsageCharts()}function avtivateReportsCalendar(){if($("#dateFilterCont").length<=0)return;setDate("#fromDate"),setDate("#toDate")}function setDate(a){$(a).datepicker({changeMonth:!0,changeYear:!0,dateFormat:"yy-mm-dd",gotoCurrent:!0,onChangeMonthYear:function(a,b,c){b=b.toString().length<2?"0"+b:b,$this=$(this);var d=$.trim($this.val());""!=d&&$this.val(a+"-"+b+"-"+d.substring(d.length-2))}})}function processReportClick(a){var b=$(a.target),c=b.parent();c.is('[topicType="-1"]')||c.is('[topicType="0"]')||c.is('[topicType="1"]')||c.is('[topicType="2"]')||c.is('[topicType="3"]')||c.is('[topicType="4"]')||c.is('[purpose="fbReports"]')?bindReportsAction(c):(b.is('[topicType="-1"]')||b.is('[topicType="0"]')||b.is('[topicType="1"]')||b.is('[topicType="2"]')||b.is('[topicType="3"]')||b.is('[topicType="4"]')||b.is('[purpose="fbReports"]'))&&bindReportsAction(b)}function bindReportsAction(a){showLoadingImage(),$("#dateFilter").text($("#reportsDateFilterArrow .forumOptions ul").find('li[dateFilter="1"]').text()),$("#forumDropDownArrow div").text($("#reportsForumFilter").find('li[forumId="-1"]').text()).attr("forumId","-1"),$("#dateFilterCont").hide(),a.parent("ul").find("li").removeClass("selected"),a.addClass("selected");var b={};b.forumGroupId=forumGroupId,b[csrfParamName]=csrfToken,b.ch=ch;var c=a.attr("purpose"),d=a.attr("isZSNewUI"),e=a.attr("forumId"),f=a.attr("categoryId"),g=a.attr("topicType");f&&(b.categoryId=f),e&&(b.forumId=e);var h=a.find("a").text();g&&(b.topicType=g);var i=$("#reportsLeftPanel li.selected").attr("action");i=="/topicTypeReports.do"?$("#topicTypesFilterCont").show():$("#topicTypesFilterCont").hide(),c&&c=="fbReports"||d&&d==="true"?$("#reportsForumFilterCont").hide():$("#reportsForumFilterCont").show(),doAjaxAction(i,b,function(a){$("#reportsInnerContent").get(0).innerHTML=a,$("#reportsTitle").text(h),bindReportsClicks(),hideLoadingImage()})}function displayStatisticsArrowClick(a){var b=a.find("div.forumOptions");b.show(),b.find("li").unbind("click").click(function(){var a=$(this),c=a.attr("dateFilter");$("#postRespDateFilterText,#dateFilter").attr("dateFilter",c).text(a.text()),b.mouseout();if(c=="2"){$("#dateFilterCont").show();return}$("#dateFilterCont").hide(),doDateFilterAction(a)}),a.hover(function(){var b=a.data("destroyHandle");a.data("destroyHandle",!1),b&&clearTimeout(b)},function(){var c=setTimeout(function(){b.hide(),a.unbind("mouseenter").unbind("mouseleave")},500);a.data("destroyHandle",c)})}function bindDateFilterClick(a){a.unbind("click").click(function(){doDateFilterAction($(this))})}function doDateFilterAction(a){var b=a,c={},d=b.attr("dateFilter");if(d=="2"){var e=a.parents().find('input[name="startDate"]').val(),f=a.parents().find('input[name="endDate"]').val();if(!e||""==e){showMessage(i18n["zohodiscussions.statistics.provideStartDateMsg"],"failure");return}c.startDate=e,f&&""!=f&&(c.endDate=f)}var g=b.attr("topFilter")=="true"?!0:!1;c.dateFilter=d,c.forumGroupId=forumGroupId;var h=$("#forumDropDownArrow div").attr("forumId");h&&(c.forumId=h);var i=b.attr("authorId");i&&i>0&&(c.userId=i),c[csrfParamName]=csrfToken;var j=g?$("#reportsLeftPanel li.selected").attr("action"):b.attr("action"),k=$("#reportsLeftPanel li.selected").attr("topicType");k&&(c.topicType=k);var l=b.attr("chartFor");l&&(c.chartFor=l),showLoadingImage(),doAjaxAction(j,c,function(a){hideLoadingImage();var c;g?c=$("#reportsInnerContent"):c=b.parents("#allTypeTrendChartCont,#postRespTrendChartCont,#repUnrepChartCont,#topicStatusPieChartCont,#mostVotedTopicsChartCont,#userParticipationChartCont"),c.get(0).innerHTML=a,bindReportsClicks()},function(a,b,c){var d=toEvaluateData(a.responseText);showMessage(d.reason,"failure"),hideLoadingImage()})}function processForumArrowClick(a){var b=$(a.target),c=$("#reportsForumFilterCont div.moreOptions");c.show(),c.find("ul").find("li").unbind("click").click(function(){var a=$(this),b={};c.hide(),b.forumGroupId=forumGroupId,b[csrfParamName]=csrfToken;var d=a.attr("forumId");b.forumId=d;var e=$("#dateFilter").attr("dateFilter");b.dateFilter=e;if(e=="2"){var f=$("#dateFilterCont"),g=f.find('input[name="startDate"]').val(),h=f.find('input[name="endDate"]').val();if(!g||""==g){showMessage(i18n["zohodiscussions.statistics.provideStartDateMsg"],"failure");return}b.startDate=g,h&&""!=h&&(b.endDate=h)}var i=$("#reportsLeftPanel li.selected").attr("topicType");i&&(b.topicType=i),showLoadingImage();var j=$("#reportsLeftPanel li.selected").attr("action");doAjaxAction(j,b,function(b){hideLoadingImage();var c=$("#reportsInnerContent");c.get(0).innerHTML=b,$("#forumDropDownArrow div").text(a.text()).attr("forumId",d),bindReportsClicks()},function(a,b,c){var d=toEvaluateData(a.responseText);showMessage(d.reason,"failure"),hideLoadingImage()})}),c.hover(function(){var a=c.data("destroyHandle");a&&clearTimeout(a)},function(){var a=setTimeout(function(){c.hide(),c.unbind("mouseenter").unbind("mouseleave")},500);c.data("destroyHandle",a)})}function showOverallUsageCharts(){isImageLoaded("topicTypeTrendImgCont");var a=[0,1,2,3,4];for(var b=0;b<a.length;b++)isImageLoaded("postRespTrendImgCont_"+a[b]);isImageLoaded("statusPieChartImgCont"),isImageLoaded("statusMeterPlotImgCont"),isImageLoaded("repUnrepPieChartImgCont"),isImageLoaded("repUnrepMeterImgCont"),isImageLoaded("userParticipationImgCont")}function isImageLoaded(a){var b=$("#"+a);if(b.length>0){var c=b.find("img").length,d=0;b.find("img").one("load",function(){d++,d==c&&(b.show(),b.prev('div[purpose="chartLoading"]').hide()),lightBox("#"+a)}).each(function(){this.complete&&$(this).trigger("load")})}}function initialiseUserActivityChart(){$("#postResponseDateFilter").click(function(){displayStatisticsArrowClick($(this))}),isImageLoaded("postRespTrendImgCont_2"),bindDateFilterClick($("#dateFilterCont").find("button")),avtivateReportsCalendar()}function triggerTopicType(a){$("#reportsLeftPanel").find('li[topicType="'+a+'"]').trigger("click")}function portalUsersList(){var a=null,b=null;if($("#privateForumMembersList").val()!==undefined&&$("#privateForumMembersList").val()!==""){a=$("#privateForumMembersList").val().split(",");var c=$("#privateForumMembers").val().split(",");for(var d=0;d<a.length;d++){var e=$('<span currTagName="'+c[d]+'">'+a[d]+'<a class="removeTag">&nbsp;x</a></span>');e.insertBefore($("#forumMembersAutoSugg"))}}if($("#privateForumModeratorsList").val()!==undefined&&$("#privateForumModeratorsList").val()!==""){b=$("#privateForumModeratorsList").val().split(",");var f=$("#privateForumModerators").val().split(",");for(var d=0;d<b.length;d++){var e=$('<span currTagName="'+f[d]+'">'+b[d]+'<a class="removeTag">&nbsp;x</a></span>');e.insertBefore($("#forumModeratorsAutoSugg"))}}$("#privateForumMembersContainer").click(function(){var b=$("#forumMembersAutoSugg"),c=$("#privateForumMembers");b.focus(),portalUsersAutoSuggest(b,c,a)}),$("#privateForumModeratorsContainer").click(function(){var a=$("#forumModeratorsAutoSugg"),c=$("#privateForumModerators");a.focus(),portalUsersAutoSuggest(a,c,b)})}function portalUsersObjFilter(a,b,c){var d=[];if(a.attr("id")==="privateForumMembers"){var e=$("#portalCreatedUser").val();for(var f=0;f<b.length;f++)e.toString()===b[f].userid.toString()&&b.splice(f,1)}for(var g=0;g<b.length;g++)c!=null?c.indexOf(b[g].label.toString())==-1&&d.push(b[g]):d.push(b[g]);return d}function portalUsersAutoSuggest(a,b,c){a.bind("paste",function(b){setTimeout(function(){var b=a.val();if(b!=null){b=b.split(",");for(var c=0;c<b.length;c++){var d=$.trim(b[c]);if(d!=""&&a.attr("id")==="forumallTags")addTagsToContainer(d,$("#forumTags"),a);else if(a.attr("id")==="allForumUsersEmail"){var e=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,f=e.test(d);f&&addTagsToContainer(d,$("#emailIds"),a)}}}})});var d=b.val(),e=a.parent().attr("id"),f=0,g=null;a.autocomplete({source:function(d,h){if(a.val().length==2||a.val().length>=4){var i=a.val().toLowerCase();if(a.data(i)!==undefined||a.data(i)!=="")g=a.data(i);if(g==null&&a.val().length>4){var j=a.val().toLowerCase();j=j.substring(0,4),a.data(j)!=null&&(g=a.data(j))}if(g==null){var k={};k.forumGroupId=forumGroupId,k.searchFor=i,k[csrfParamName]=csrfToken;var l="";a.attr("id")==="forumallTags"?l="/getTagsSearchResult.do":l="/getUsersSearchResult.do",$(".ui-autocomplete").is(":visible")||($("#"+e+"_search").show(),b.attr("id")=="privateForumMembers"||b.attr("id")=="privateForumModerators"?($("#"+e+"_search").css("top",$("#"+e).offset().top+59+"px"),$("#"+e+"_search").css("left",$("#"+e).offset().left+"px")):$("#"+e+"_search").css("top",$("#"+e).offset().top-22+"px"),$("#"+e+"_search").css("width",$("#"+e).width()+"px")),doAjaxAction(l,k,function(b){g=$.parseJSON(b),a.data(i,g),$("#"+e+"_search").hide(),a.autocomplete("search")},function(a){$("#"+e+"_search").hide()})}}if(g!=null){if(b.attr("id")=="privateForumMembers"||b.attr("id")=="privateForumModerators")g=portalUsersObjFilter(b,g,c);var m=$.grep(g,function(a){if(a.label.substring(0,d.term.length).toLowerCase()===d.term.toLowerCase())return!0}),n=b.val().split(","),o="";for(var p=0;p<n.length-1;p++)for(var q=0;q<m.length;q++)m[q].userid==undefined?o=m[q].label:o=m[q].userid,o==n[p]&&m.splice(q,1);m=m.splice(0,5),h(m),a.attr("id")==="allForumUsersEmail"?f=$(".userAutoSuggContainer").offset().top-7-m.length*45:a.attr("id")==="forumallTags"&&(f=$("#tagsContainer").offset().top-6-$(".ui-autocomplete").height()),f!==0?$(".ui-autocomplete").css("top",f+"px"):$(".ui-autocomplete").css("top",$("#"+e).offset().top+59+"px"),$(".ui-autocomplete").css("width",$("#"+e).width()+"px"),$(".ui-autocomplete").css("left",$("#"+e).offset().left+"px")}},select:function(c,e){var f="";return e.item.userid==undefined?(d=b.val()+e.item.label+",",f='<span currTagName="'+e.item.label+'">'+e.item.label+'<a class="removeTag">&nbsp;x</a></span>'):(d=b.val()+e.item.userid+",",f='<span currTagName="'+e.item.userid+'">'+e.item.label+'<a class="removeTag">&nbsp;x</a></span>'),a.before(f),b.val(d),!1},create:function(){$(this).data("autocomplete")._renderItem=function(a,b){return b.useravatar==undefined?$("<li></li>").data("item.autocomplete",b).append("<a style='text-decoration:none;cursor:hand;'>"+b.label+"&nbsp;</img></a>").appendTo(a):$("<li></li>").data("item.autocomplete",b).append("<a style='text-decoration:none;cursor:hand;'><img src='"+b.useravatar+"' width='40' height='40' style='vertical-align: middle;white-space:nowrap;'>&nbsp;&nbsp;&nbsp;"+b.label+"&nbsp;</img></a>").appendTo(a)}},close:function(a,b){(a.which===1||a.which===13)&&$(".ui-autocomplete-input").val("")}}),a.parent().click(function(){a.focus()}),$(".removeTag",$("#"+e)).live("click",function(){var a=$(this).parent().attr("currTagName");removeTagsToContainer(a,b),$(this).parent().remove()})}function deleteOrAddTags(a,b,c){if(a.keyCode===8||a.keyCode===46)b.prev().attr("style")==="background-color:#E0E0E0"?(removeTagsToContainer(undefined,c),b.prev().remove()):b.prev().length>0&&b.val()===""&&b.prev().attr("style","background-color:#E0E0E0");else if(a.keyCode===188){var d=b.val().slice(0,-1);d=$.trim(d),c.attr("id")==="forumTags"&&(d=d.replace(/^\s+|\s+$/g," ").replace(/\s+/g," "),d!=""&&(d.match(/^[^\^\"'()~`!@#$%&:;\/\\?|<>{}[\]*-+=]+$/)==null?showMessage(i18n["zohodiscussions.singlepost.specialCharacterNotAllowedMsg"],"failure"):addTagsToContainer(d,c,b)));if(c.attr("id")==="emailIds"||c.attr("id")==="privateForumMembers"||c.attr("id")==="privateForumModerators"){var e=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,f=e.test(d);f?addTagsToContainer(d,c,b):showTipper(i18n["zohodiscussions.feedbackwidget.emailIdemptyErrMsg"])}b.val("")}else b.prev().attr("style")==="background-color:#E0E0E0"&&b.prev().attr("style","background-color:#EFEFEF")}function removeTagsToContainer(a,b){var c=b.val().slice(0,-1).split(","),d=c.length,e="";a===undefined&&(d-=1);for(var f=0;f<d;f++)c[f]!==a&&(e=e+c[f]+",");e===","&&(e=""),b.val(e)}function addTagsToContainer(a,b,c){var d=b.val();d=d+a+",",b.val(d);var e='<span currTagName="'+a+'">'+a+'<a class="removeTag">&nbsp;x</a></span>';c.before(e),c.val("")}function usersListAutoSuggest(a,b){if(a=="pendingUser")return $("#searchAction").show(),$("#searchAction").click(function(){userSearchAction()}),!1;var c=null;$("#searchText").keyup(function(d){var e=$(this).val().toLowerCase();if(e!=="")if($("#searchText").data(a+"_"+e)==undefined||$("#searchText").data(a+"_"+e)==""){var f={};f.forumGroupId=forumGroupId,f.filterPurpose=a,f.searchFor=e,f[csrfParamName]=csrfToken,f.fetchPage=b,doAjaxAction("/getUsersSearchResult.do",f,function(b){c=$.parseJSON(b),$("#searchText").data(a+"_"+e,c),c!=null&&c!=""&&$("#searchText").keyup()})}else c=$("#searchText").data(a+"_"+e);c!=null&&membersListTemplate(e,a,c)})}function getMoreUsers(a,b,c){var d=null;c=c.toLowerCase();if($("#searchText").data(a+"_"+c+"_"+b)==undefined||$("#searchText").data(a+"_"+c+"_"+b)==""){var e={};e.forumGroupId=forumGroupId,e.filterPurpose=a,e.searchFor=c,e[csrfParamName]=csrfToken,e.fetchPage=b,doAjaxAction("/getUsersSearchResult.do",e,function(e){d=$.parseJSON(e),$("#searchText").data(a+"_"+c+"_"+b,d),d!=null&&membersListTemplate(c,a,d)})}else d=$("#searchText").data(a+"_"+c+"_"+b),membersListTemplate(c,a,d)}function membersListTemplate(a,b,c){var d=$("#userFilterContainer").find(".wrapper"),e=0;d.html(""),$.template("usersListContainer",'<div id="usercont" class="ashBorderBox" ><fieldset class="hideIt"><legend>'+i18n["zohodiscussions.general.allUsers"]+"</legend>"+'<div class="subFrompageslist"><ul class="resetMargin"></ul></div>'),$.tmpl("usersListContainer").appendTo(d);for(var f=0;f<25&&f<c.length;f++)c[f].label.toLowerCase().indexOf(a)>-1&&($.template("usersList",'<li id="manageUserActions_${userid}"><div class="flLeft photos"><img src="${useravatar}" /></div><div class="flLeft"><span class="listText"> ${label} </span>{{if(userlabel != null)}}<span class="activeLabel tinyText">${userlabel}</span>{{/if}}<div class="ashText metaList"><span class="greenText">'+i18n["zohodiscussions.general.E-Mail"]+': <a href="javaScript:;">${emailid}</a></span></div>'+'<div class="ashText metaList"><span class="greenText">'+"{{if isadminuser}}"+i18n["zohodiscussions.email.action.admin"]+"{{else}}"+i18n["zohodiscussions.UserDetails.Member"]+"{{/if}}"+"</span></div></div>"+'<div class="iconArea flRight">'+'{{if !isblocked}}<a class="action flLeft" href="javascript:;" userId="${userid}" userName="${label}" purpose="userSettings"><div class="imgCogIcon flLeft"></div>'+i18n["zohodiscussions.general.manage"]+"</a>{{/if}}"+"{{if canblockthisuser}}"+'{{if !isblocked}} <a class="action" href="javascript:;" id="blockUser" purpose="blockUser" userId="${userid}" userName="${label}">'+'<div class="imgDisableIcon flLeft"></div>'+i18n["zohodiscussions.general.block"]+"</a>"+'{{else}} <a class="action" href="javascript:;" id="blockUser" purpose="unblockUser" userId="${userid}" userName="${label}">'+'<div class="imgDisableIcon flLeft"></div>'+i18n["zohodiscussions.general.unblock"]+"</a> {{/if}}"+"{{/if}} {{if canmoderateuserortopic}}"+'<a href="javascript:;" class="action ${ismoderate != true?"moderate":"unmoderate"}" purpose="moderateUser" id="moderateUser" userId="${userid}" userName="${label}">'+'<div class="imgModerateIcon flLeft"></div>${ismoderate == true?"'+i18n["zohodiscussions.moderationList.Unmoderate"]+'":"'+i18n["zohodiscussions.moderationList.moderate"]+'"}</a>'+"{{/if}} {{if candeletethisuser}}"+'<a href="javascript:;" class="action" userId="${userid}" userName="${label}" purpose="userDelete"><div class="imgDeleteIcon flLeft" ></div>'+i18n["zohodiscussions.general.delete"]+"</a>"+"{{/if}}"+"</div>"+"</li>"),$.tmpl("usersList",c[f]).appendTo(d.find(".resetMargin")));d.find(".resetMargin").html()===""&&($.template("userNotFound",i18n["zohodiscussions.allportalmemberslist.nosearchingResult"]),$.tmpl("userNotFound",c[e]).appendTo(d.find(".resetMargin")));if(c.length>0){var g=c[e].fetchpage==1?"navBtnDisabled":"navBtnEnabled",h=c.length>24?"navBtnEnabled":"navBtnDisabled",i=1,j=25;c[e].fetchpage>1&&(i=(c[e].fetchpage-1)*j+1),$.template("usersPaginationContainer",'<ul class="ulNoStyle flRight smallText" id="usersPaginationContainer"><li class="flLeft '+g+'" onclick=getMoreUsers("'+b+'",${fetchpage-1},"'+$("#searchText").val().toLowerCase()+'");  fetchPage="${fetchpage}">&laquo; ${prev}</li>'+'<li class="flLeft" style="margin:5px 3px 2px;padding:3px;"><span style="padding-top:3px;">'+i+" - "+(i+c.length-1)+"</span></li>"+'<li class="flLeft '+h+'" onclick=getMoreUsers("'+b+'",${fetchpage+1},"'+$("#searchText").val().toLowerCase()+'"); fetchPage="${fetchpage+1}">${next} &raquo;</li>'+"<ul>"),$.tmpl("usersPaginationContainer",c[e]).appendTo(d.find(".hideIt"))}}var discussionsFunctions={};discussionsFunctions.tphome=function(a,b,c,d,e,f,g,h,i,j,k,l){var m=1;getForumTopics(b,c,m,a,d,e,f,g,h,i,j,k,l)},discussionsFunctions.home=function(a,b){var c=-1,d=-1,b=b;typeof a=="undefined"&&(a="home",b=1),getForumTopics(c,d,b,a)},discussionsFunctions.chome=function(a,b){var c=-1,d=-1,b=b;typeof a=="undefined"&&(a="chome",b=1),getForumTopics(c,d,b,a)},discussionsFunctions.stats=function(a){var b=-1,c=-1,d=1;getTopicsReport(b,c,d,a)},discussionsFunctions.forum=function(a,b,c,d){document.title=forumGroupName;var e=$("#topicListMainContainer"),f={};f.forumGroupId=forumGroupId,f.forumURL=b,f.fetchPage=d,c&&(f.categoryURL=c),doAjaxAction("/getSingleForumTopics.do",f,function(e){hideLoadingImage(),$("#mainContent").get(0).innerHTML=e,lightBox("#chartWidget"),c?parseInt(d)>1?$.history.add(a+"/"+b+"/"+c+"/"+d):$.history.add(a+"/"+b+"/"+c):parseInt(d)>1?$.history.add(a+"/"+b+"/"+d):$.history.add(a+"/"+b),goToTop(),lightBox("#topicList"),bindTopicClicks($("#topicList")),bindTopicClicks($("#topicsList")),bindTopicListHeaderClicks($("#topicListHeader")),bindWidgetsContClick($("#topicListWidgetsCont"));var f=$("#forumComboCont"),g=f.attr("forumId"),h=f.attr("categoryId"),i="NewTopic/"+g+"/"+h;$("#allForumWidget").length>0&&$("#allForumWidget").find('li[purpose="forumList"]').length<9&&$("#moreForumView").hide(),$("#NewTopicTab").attr("hashPurpose",i);if(typeof WmsContacts!="undefined"&&ch=="true"){var j=WmsContacts.getZohoContacts();setPresence(j,"moderatorsChatList_"+g),setPresenceInTopicList(j)}return setToHotkeys(),!1},function(a){$("#mainContent").get(0).innerHTML=a.responseText,hideLoadingImage()})},discussionsFunctions.newtopic=function(a,b,c){var d=ZUID;if(d==-1&&canThisUserPostATopic=="false"&&isCustomSSOPortal=="false")initLoginFrame($("#NewTopicTab"));else if(d==-1&&canThisUserPostATopic!="true"||isTopicQuickView!="false")d!=-1&&typeof canThisUserPostATopic=="undefined"?window.location.href=serverURL:typeof b=="undefined"&&typeof c=="undefined"?getWritePost("-1","-1",a):(b=typeof b=="undefined"?-1:b,c=typeof c=="undefined"?-1:c,getWritePost(b,c,a));else{var e=$("#NewTopicTab").attr("topicURL");window.location.href=serverURL+"/"+e}},discussionsFunctions.search=function(a,b,c){var d={};d.forumGroupId=forumGroupId,b||(b=$("#searchInputBox").val(),b=$.trim(b));if(b==""){showMessage(i18n["zohodiscussions.searchList.noSearchString"],"failure"),hideLoadingImage();return}if(c===undefined||c==="")c=!1;var e=$("#forumComboCont"),f=$("#categoryComboCont"),g=e.attr("forumId"),h=e.attr("categoryId"),i=f.attr("hashPurpose");d.searchFor=b,d.forumId=g,d.categoryId=h;var j=$("#searchSelectedImage").attr("purpose");d.normalSearchType=j,d.isResourceSearch=c,typeof j=="undefined"?j="":j!="all"?j="/"+j:j="",typeof i!="undefined"&&i!=""?a=i+"/"+a:(i=e.attr("hashPurpose"),i=="Home"&&(i=""),typeof i!="undefined"&&i!=""&&(a=i+"/"+a)),(c===undefined||c===""||c===!1)&&$.history.add(a+j+"/"+encodeURIComponent(b)),$("#currSearchSortBy").attr("currSortBy")=="date"&&(d.searchSortBy="date"),doAjaxAction("/getSearchResult.do",d,function(a){hideLoadingImage();var c=$("<div></div>");c.get(0).innerHTML=a,$("#mainContent").get(0).innerHTML=a,bindSearchContentClick($("#mainContent")),showAuthorPopout(c),$("#searchInputBox").val(b)},function(a){hideLoadingImage();var b=toEvaluateData(a.responseText);b.errorcode=="REMOTE_IP_LOCKED"&&showMessage(i18n["zohodiscussions.generalmessage.tryagainaftersometime"],"failure")})},discussionsFunctions.topic=function(a,b,c){c!=undefined?openSinglePost(b,a,c):openSinglePost(b,a)},discussionsFunctions.tag=function(a,b){$.history.add(a+"/"+b),$this=$(this),loadTagRelatedPost(b)},discussionsFunctions.alltags=function(a){$.history.add(a),$this=$(this);var b={};b.forumGroupId=forumGroupId,doAjaxAction("/showAllTags.do",b,function(a){return hideLoadingImage(),$("#mainContent").get(0).innerHTML=a,bindTagsContClick($("#allTagsContainer")),bindWidgetsContClick($("#topicListWidgetsCont")),!1},function(a){hideLoadingImage();var b=a.responseText;$("#mainContent").get(0).innerHTML=b})},discussionsFunctions.allforums=function(a){$("#preloadedForumsCont").length>0&&($("#preloadedForumsCont").show().siblings().remove(),$.history.add(a),hideLoadingImage());var b={};b.purpose="AllForums",b.forumGroupId=forumGroupId,b[csrfParamName]=csrfToken,doAjaxAction("/AllForums.do",b,function(a){hideLoadingImage(),document.title=i18n["zohodiscussions.general.allForums"],$.history.add("AllForums"),$("#mainContent").get(0).innerHTML=a;var b=$("#iamLoginBox").find("iframe"),c=b.attr("src");return b.attr("src",c),allForumsBindActions(),!1},function(a){hideLoadingImage();var b=a.responseText;$("#mainContent").get(0).innerHTML=b})},discussionsFunctions.myarea=function(a,b,c){document.title=i18n["zohodiscussions.general.myarea"];var d=$("#myAreaParentContainer");if(d.length>0&&d.is('[shouldReload="false"]'))d.show().attr("shouldReload","true").siblings().remove(),hideLoadingImage();else{var e={};e.forumGroupId=forumGroupId,e[csrfParamName]=csrfToken,b||(b="dashboard");if(b!="dashboard"&&b!="myposts"&&b!="watchlist"&&b!="friends"&&b!="bookmark"&&b!="privatemsg"&&b!="preference"){hideLoadingImage();return}e.myAreaAction=b,e.ch=ch,doAjaxAction("/getMyArea.do",e,function(d){return $("#authorPopout:visible").hide(),hideLoadingImage(),$("#mainContent").get(0).innerHTML=d,getMyAreaBindActions(b,a,"",c),!1},function(a){hideLoadingImage();var b=a.responseText;$("#mainContent").get(0).innerHTML=b})}},discussionsFunctions.user=function(a,b){getAuthorProfile(b)},discussionsFunctions.moderation=function(a){document.title=i18n["zohodiscussions.moderationAction.moderation"];var b={};b.forumGroupId=forumGroupId,portalPlanIndex>0?b.postFor="AllWaitingApproval":(b[csrfParamName]=csrfToken,b.postFor="AllReportedSpam"),ModerationLoadingPage(b)};var createEditor=function(){try{var a;isDiscussionsMobileDevice==1?a={id:"editorHolder",mode:"plaintext",content:$("#postContentTA").val()}:a={id:"editorHolder",content:$("#postContentTA").val()},editor=ZE.create(a)}catch(b){setTimeout(function(){createEditor()},300)}};$(window.document).click(function(a){var b=$("#switchToProductOptions,#changePortalOptions"),c=$("#zdstatusList,#typeFilterOptions"),d=$(a.target),e=d.parent();if(d.is('[purpose="linkForDropDown"]')||e.is('[purpose="linkForDropDown"]')||d.is("#zdstatusInfo")||e.is("#zdstatusContainer")||d.is("#zdstatusContainer")){var f=d.attr("dropDownLinkPurpose");return f=f||e.attr("dropDownLinkPurpose"),c.each(function(a,b){var c=$(b);if(typeof f=="undefined"&&c.is("#zdstatusList")){if($("#zdstatusInfo").find("div.statuschanges").length>0||$("#zdstatusContainer").find("b.imgdownArrow"))$("#zdstatusList").is(":visible")?c.hide():c.show()}else c.is('div[dropDownPurpose!="'+f+'"]:visible')&&(c.hide(),c.parent(".newComboSelected").addClass("newCombo").removeClass("newComboSelected"))}),!1}c.parent(".newComboSelected").addClass("newCombo").removeClass("newComboSelected")}),$(window.document).keypress(function(a){var b=$("#zdstatusList,#typeFilterOptions,#privateConversation"),c=$("#portalComboCont");if(a.keyCode==27)return $("#messageContainer").hide(),$("#authorPopout:visible").hide(),$('#PopupContainer div.dimDiv:visible button:visible[purpose="closePopout"]').trigger("click"),$('#PopupContainer div.dimDiv:visible div:visible[purpose="imgCancel"]')&&$("#imgCancel").trigger("click"),b.is(":visible")&&b.hide(),c.is(".newComboSelected")&&c.addClass("newCombo").removeClass("newComboSelected"),$("#privateMsgPrompt").is(":visible")&&$("#privateMsgPrompt").parent().hide(),$("#inappropriateReason").is(":visible")&&$("#inappropriateReason").hide(),!1}),discussionsFunctions.users=function(a,b,c){var d={},e="";d.purpose="Users",d.forumGroupId=forumGroupId,d.forumId=-1,d.fetchPage=b,d.nameStartsWith=c,bindTopicClicks($("#topicList")),bindTopicClicks($("#topicsList")),doAjaxAction("/Users.do",d,function(a){hideLoadingImage(),document.title="Users",$.history.add("Users"),$("#mainContent").get(0).innerHTML=a;var c=$("#iamLoginBox").find("iframe"),d=c.attr("src");c.attr("src",d),lightBox("#chartWidget"),bindWidgetsContClick($("#topicListWidgetsCont")),goToTop();var e=$("#listof_FC_Counts");$("#countOfForum").html(e.attr("forumCount")),$("#countOfCategory").html(e.attr("categoryCount")),$("#countOfPosts").html(e.attr("postCount")),$("#countOfResponses").html(e.attr("responseCount"));if(typeof WmsContacts!="undefined"&&ch==="true"){var f=WmsContacts.getZohoContacts();setPresenceInTopicList(f)}return!1})};var codeForPreview='<div class="__zd_findAndReplaceParent" style="height:11px"></div><div class = "__zd_findAndReplace" style="text-align:right;float:right;background-color:#efefef;margin-right:30px;padding:0px 3px;"><span id="showCopyCode" onclick = "javascript:showCode(this);return false;" style="font:normal 10px trebuchet ms,arial;text-decoration:underline;color:blue;cursor:pointer">Copy code</span></div>';Collaboration.handleUserList=function(a,b){},Collaboration.handleMessage=function(a,b,c,d,e){},Collaboration.handlePresence=function(a,b,c,d,e){},Collaboration.join=function(a){WebMessanger.joinCollab(a)},Collaboration.quit=function(a){WebMessanger.quit(a)},Collaboration.serverup=function(){},Collaboration.serverdown=function(){},Collaboration.handleZohoMessage=function(a,b,c,d,e,f,g,h,i,j,k,l){return a=="FM"?(setTimeout(function(){showBubble(b,e)},2),!0):!1},Collaboration.handleCustomMessage=function(a){},Collaboration.handleCrossProductMessage=function(a,b){},Collaboration.onConnect=function(){},Collaboration.openURL=function(a,b,c,d){return!0},Collaboration.handleCollabAdd=function(a,b,c,d,e){},Collaboration.handleCollabDelete=function(a,b,c,d,e){},Collaboration.handleUserAdd=function(a,b){},Collaboration.handleUserDeleted=function(a,b){},Collaboration.handleIsOnline=function(a){updateStatus(a)},Collaboration.handleLogout=function(a){setTimeout(function(){$.get("/cleardomain.do","",function(){window.location.href=window.location.href})},5)},Collaboration.goOffline=function(){},Collaboration.handleChatNotifyMessage=function(a,b,c){},Collaboration.getPageTitle=function(){return!1},Collaboration.handleWmsDisable=function(a){setTimeout(function(){$.get("/cleardomain.do","",function(){window.location.href=window.location.href})},5)},Collaboration.handleServiceMessage=function(a){},Collaboration.handleComposeMail=function(a,b){return!1},Collaboration.handleLanguageChange=function(a){},WmsContactImpl.handlePresence=function(a,b,c,d,e){setTimeout(function(){updatePresence(a,b,d)},2)},WmsContactImpl.handleAddressBook=function(){},WmsContactImpl.handleInvite=function(a,b,c){},WmsContactImpl.notifyInvite=function(a,b,c){},WmsContactImpl.handleAccept=function(a,b,c,d,e){},WmsContactImpl.notifyAccept=function(a,b,c,d,e){},WmsContactImpl.handleReject=function(a,b,c){},WmsContactImpl.notifyRemove=function(a,b,c){},WmsContactImpl.handleDelete=function(a,b,c){},WmsContactImpl.handleContactUpdated=function(){},WmsContactImpl.handleStatusMessage=function(a,b){},WmsContactImpl.handeAllStatusMessages=function(){},WmsContactImpl.handleHideContactsUI=function(){},WmsContactImpl.handleShowContactsUI=function(){},WmsContactImpl.handleGetContacts=function(){var a=WmsContacts.getZohoContacts();if($("#topicListMainContainer").is(":visible")||$("#allForums_MainContentCont").is(":visible")){setPresenceInTopicList(a);if($("#singleForumHeaderView").is(":visible")){var b=$("#singleForumHeaderView").attr("forumId");setPresence(a,"moderatorsChatList_"+b)}}else if($("#SinglePostContainer").is(":visible")){var c=$("#SinglePostContainer").attr("forumtopicid");setPresenceInTopicList(a,c)}else if($("#myAreaParentContainer").is(":visible"))$("#recentActivityContent").is(":visible")?(setPresenceInMyArea(a,"current_recentActivity_List"),setPresence(a,"followingUserDetails"),setPresence(a,"followersUserDetails")):$("#watchListInnerContent").is(":visible")?setPresenceInMyArea(a,"userChat_watchTopics"):$("#privateMsgInnerContent").is(":visible")&&setPresenceInMyArea(a,"userChat_inbox");else if($("#userProfileMainContainer").is(":visible")){var d=$("#userProfileMainContainer"),e=d.attr("authorId");if(typeof WmsContacts!="undefined"&&ch=="true"){var f=WmsContacts.status(e);f===!1&&(f=9),manageUserChatStatus("userOnlineStatus_"+e,f)}}},WmsContactImpl.handleMPReject=function(a,b,c){},WmsContactImpl.handleMPAccept=function(a,b,c){},WmsContactImpl.handleMPDelete=function(a,b,c){},WmsContactImpl.handleMPAdd=function(a,b,c){},WmsContactImpl.handleMPInvite=function(a,b,c){},WmsContactImpl.handleLogin=function(a,b,c,d){},WmsContactImpl.handleLogout=function(a,b,c,d){},WmsContactImpl.handleGetAccounts=function(a){},WmsContactImpl.handleInvitations=function(a){},WmsliteImpl.serverdown=function(){},WmsliteImpl.serverup=function(){},WmsliteImpl.handleMessage=function(a,b){},WmsliteImpl.handleAccountDisabled=function(a){},WmsliteImpl.handleServiceMessage=function(a){},WmsliteImpl.handleLogout=function(a){setTimeout(function(){$.get("/cleardomain.do","",function(){var a=window.location.href;a.indexOf("#")>-1&&window.location.reload(),window.location.href=a})},5)};